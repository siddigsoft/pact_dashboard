import{r as x,j as e,o as $,aJ as D,i as T,T as k,U as M,bP as U}from"./react-core-B8kFjp2k.js";import{a8 as W,E as B,T as S,i as P,j as f,k as E,C as p,f as N,g as v,h as F,b as h,B as H}from"./index-PwDgWEVM.js";import{T as O,a as V,b as q,c as j,d as G,e as m}from"./table-CZ8ZB6wW.js";import{e as J,s as L,H as z}from"./date-utils-YarVESQS.js";import"./vendor-VlxgVHMv.js";import"./docs-D2Yi4cpO.js";import"./react-dom-BLwj5vIO.js";import"./jspdf-rld7HkB6.js";import"./router-CKy9yO3R.js";import"./query-CJ0Bt4ph.js";import"./supabase-CwPDIVMD.js";import"./xlsx-CBxwqXDA.js";import"./forms-CESK2FDA.js";import"./radix-ui-C2DV4xtt.js";import"./radix-dialogs-CnlmQBMC.js";import"./radix-menus-CPezQVZk.js";function ce(){const{withdrawalRequests:b}=W(),{users:y}=B(),[w,I]=x.useState("month"),R=x.useMemo(()=>{const t=new Date;return{start:L(t),end:J(t)}},[]),l=x.useMemo(()=>w==="all"?b:b.filter(t=>{const s=new Date(t.createdAt);return z(s,R)}),[b,w,R]),r=x.useMemo(()=>{const t=l.reduce((a,c)=>a+c.amount,0),s=l.filter(a=>a.status==="approved"),n=l.filter(a=>a.status==="rejected"),i=l.filter(a=>a.status==="pending"),u=s.reduce((a,c)=>a+c.amount,0),C=n.reduce((a,c)=>a+c.amount,0),o=i.reduce((a,c)=>a+c.amount,0);return{totalRequested:t,totalApproved:u,totalRejected:C,totalPending:o,requestCount:l.length,approvedCount:s.length,rejectedCount:n.length,pendingCount:i.length,approvalRate:l.length>0?s.length/l.length*100:0}},[l]),A=x.useMemo(()=>y.filter(s=>s.role==="dataCollector"||s.role==="datacollector").map(s=>{const n=l.filter(o=>o.userId===s.id),i=n.filter(o=>o.status==="approved"),u=n.reduce((o,a)=>o+a.amount,0),C=i.reduce((o,a)=>o+a.amount,0);return{userId:s.id,name:s.name,email:s.email,requestCount:n.length,approvedCount:i.length,totalRequested:u,totalApproved:C}}).filter(s=>s.requestCount>0).sort((s,n)=>n.totalApproved-s.totalApproved),[y,l]),d=(t,s="SDG")=>new Intl.NumberFormat("en-SD",{style:"currency",currency:s,minimumFractionDigits:2}).format(t),g=({title:t,value:s,icon:n,trend:i,color:u})=>e.jsx(p,{className:`bg-gradient-to-br ${u}`,children:e.jsx(h,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium uppercase tracking-wide text-muted-foreground",children:t}),e.jsx("p",{className:"text-2xl font-bold tabular-nums mt-1",children:s}),i&&e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:i})]}),e.jsx("div",{className:"p-3 rounded-lg bg-background/50",children:e.jsx(n,{className:"w-6 h-6"})})]})})});return e.jsxs("div",{className:"space-y-6 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Wallet Reports & Analytics"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Financial insights and withdrawal trends"})]}),e.jsx(S,{value:w,onValueChange:t=>I(t),children:e.jsxs(P,{children:[e.jsx(f,{value:"month",children:"This Month"}),e.jsx(f,{value:"all",children:"All Time"})]})})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsx(g,{title:"Total Requested",value:d(r.totalRequested),icon:$,trend:`${r.requestCount} requests`,color:"from-blue-500/10 to-blue-500/5"}),e.jsx(g,{title:"Total Approved",value:d(r.totalApproved),icon:D,trend:`${r.approvedCount} approved`,color:"from-green-500/10 to-green-500/5"}),e.jsx(g,{title:"Total Pending",value:d(r.totalPending),icon:T,trend:`${r.pendingCount} pending`,color:"from-yellow-500/10 to-yellow-500/5"}),e.jsx(g,{title:"Approval Rate",value:`${r.approvalRate.toFixed(1)}%`,icon:k,trend:`${r.rejectedCount} rejected`,color:"from-purple-500/10 to-purple-500/5"})]}),e.jsxs(S,{defaultValue:"enumerators",className:"space-y-4",children:[e.jsxs(P,{children:[e.jsxs(f,{value:"enumerators",children:[e.jsx(M,{className:"w-4 h-4 mr-2"}),"Enumerator Performance"]}),e.jsxs(f,{value:"transactions",children:[e.jsx(T,{className:"w-4 h-4 mr-2"}),"Transaction Breakdown"]})]}),e.jsx(E,{value:"enumerators",children:e.jsxs(p,{children:[e.jsxs(N,{children:[e.jsxs(v,{className:"flex items-center gap-2",children:[e.jsx(M,{className:"w-5 h-5 text-primary"}),"Enumerator Withdrawal Summary"]}),e.jsx(F,{children:"Individual enumerator withdrawal statistics and performance"})]}),e.jsx(h,{children:e.jsxs(O,{children:[e.jsx(V,{children:e.jsxs(q,{children:[e.jsx(j,{children:"Enumerator"}),e.jsx(j,{className:"text-right",children:"Requests"}),e.jsx(j,{className:"text-right",children:"Approved"}),e.jsx(j,{className:"text-right",children:"Total Requested"}),e.jsx(j,{className:"text-right",children:"Total Approved"})]})}),e.jsx(G,{children:A.length===0?e.jsx(q,{children:e.jsx(m,{colSpan:5,className:"text-center text-muted-foreground py-8",children:"No enumerator data available"})}):A.map(t=>e.jsxs(q,{className:"hover-elevate",children:[e.jsx(m,{children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:t.name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:t.email})]})}),e.jsx(m,{className:"text-right tabular-nums",children:t.requestCount}),e.jsx(m,{className:"text-right",children:e.jsx(H,{variant:t.approvedCount>0?"default":"secondary",children:t.approvedCount})}),e.jsx(m,{className:"text-right tabular-nums font-medium",children:d(t.totalRequested)}),e.jsx(m,{className:"text-right tabular-nums font-bold text-green-600",children:d(t.totalApproved)})]},t.userId))})]})})]})}),e.jsx(E,{value:"transactions",children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs(p,{children:[e.jsx(N,{className:"pb-2",children:e.jsxs(v,{className:"text-lg flex items-center gap-2",children:[e.jsx(D,{className:"w-5 h-5 text-green-600"}),"Approved"]})}),e.jsx(h,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-baseline justify-between",children:[e.jsx("span",{className:"text-3xl font-bold tabular-nums text-green-600",children:r.approvedCount}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"requests"})]}),e.jsxs("div",{className:"pt-2 border-t",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Amount"}),e.jsx("p",{className:"text-xl font-bold tabular-nums",children:d(r.totalApproved)})]})]})})]}),e.jsxs(p,{children:[e.jsx(N,{className:"pb-2",children:e.jsxs(v,{className:"text-lg flex items-center gap-2",children:[e.jsx(T,{className:"w-5 h-5 text-yellow-600"}),"Pending"]})}),e.jsx(h,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-baseline justify-between",children:[e.jsx("span",{className:"text-3xl font-bold tabular-nums text-yellow-600",children:r.pendingCount}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"requests"})]}),e.jsxs("div",{className:"pt-2 border-t",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Amount"}),e.jsx("p",{className:"text-xl font-bold tabular-nums",children:d(r.totalPending)})]})]})})]}),e.jsxs(p,{children:[e.jsx(N,{className:"pb-2",children:e.jsxs(v,{className:"text-lg flex items-center gap-2",children:[e.jsx(U,{className:"w-5 h-5 text-red-600"}),"Rejected"]})}),e.jsx(h,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-baseline justify-between",children:[e.jsx("span",{className:"text-3xl font-bold tabular-nums text-red-600",children:r.rejectedCount}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"requests"})]}),e.jsxs("div",{className:"pt-2 border-t",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Amount"}),e.jsx("p",{className:"text-xl font-bold tabular-nums",children:d(r.totalRejected)})]})]})})]})]})})]})]})}export{ce as default};
