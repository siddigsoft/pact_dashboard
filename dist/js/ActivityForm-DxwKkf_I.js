import{r as N,j as e,t as f,aV as C,b5 as z,X as L}from"./react-core-B8kFjp2k.js";import{u as M,t as U,o as G,b as H,e as J,d as S,s as y}from"./forms-CESK2FDA.js";import{I as A,a as l,C as K,b as Q,B as j}from"./index-PwDgWEVM.js";import{T as W}from"./textarea-BpQMf5eL.js";import{T as b}from"./toggle-DVFO8bcr.js";import{F as Y,a as d,b as o,e as i,c as h,d as m}from"./form-BT_tmI7p.js";import{S as P,a as w,b as T,c as F,d as c}from"./select-CXX5Q_V1.js";import{C as I}from"./calendar-DEyRSxJX.js";import{P as k,a as E,b as V}from"./popover-BSK_FA51.js";import{o as q}from"./date-utils-YarVESQS.js";const Z=G({name:y().min(3,"Activity name must be at least 3 characters"),description:y().optional(),startDate:S({required_error:"Start date is required"}),endDate:S({required_error:"End date is required"}),status:J(["pending","inProgress","completed","cancelled"]),isActive:H().default(!0)}),me=({projectId:D,onSubmit:B,initialData:t,isEditing:O=!1,onCancel:g,projectType:ee})=>{const[a,u]=N.useState((t==null?void 0:t.subActivities)||[]),[r,p]=N.useState({name:"",status:"pending",isActive:!0}),n=M({resolver:U(Z),defaultValues:{name:(t==null?void 0:t.name)||"",description:(t==null?void 0:t.description)||"",startDate:t!=null&&t.startDate?new Date(t.startDate):new Date,endDate:t!=null&&t.endDate?new Date(t.endDate):new Date,status:(t==null?void 0:t.status)||"pending",isActive:!0}}),R=()=>{if(r.name.trim()==="")return;const s={id:`new-sub-${Date.now()}`,name:r.name,status:r.status,isActive:r.isActive};u([...a,s]),p({name:"",status:"pending",isActive:!0})},X=s=>{u(a.filter(x=>x.id!==s))},_=s=>{const x={id:(t==null?void 0:t.id)||`new-${Date.now()}`,name:s.name,description:s.description,startDate:s.startDate.toISOString().split("T")[0],endDate:s.endDate.toISOString().split("T")[0],status:s.status,isActive:s.isActive,subActivities:a};B(x)},$=s=>{switch(s){case"pending":return e.jsx(j,{variant:"outline",children:"Pending"});case"inProgress":return e.jsx(j,{variant:"secondary",children:"In Progress"});case"completed":return e.jsx(j,{variant:"default",children:"Completed"});case"cancelled":return e.jsx(j,{variant:"destructive",children:"Cancelled"})}};return e.jsx(Y,{...n,children:e.jsxs("form",{onSubmit:n.handleSubmit(_),className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(d,{control:n.control,name:"name",render:({field:s})=>e.jsxs(o,{children:[e.jsx(i,{children:"Activity Name*"}),e.jsx(h,{children:e.jsx(A,{placeholder:"Enter activity name",...s})}),e.jsx(m,{})]})}),e.jsx(d,{control:n.control,name:"isActive",render:({field:s})=>e.jsxs(o,{children:[e.jsx(i,{children:"Activity Status"}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx(b,{pressed:s.value,onPressedChange:s.onChange,className:"data-[state=on]:bg-primary",children:s.value?e.jsxs("div",{className:"flex items-center",children:[e.jsx(f,{className:"h-4 w-4 mr-2 text-green-500"}),"Active"]}):e.jsxs("div",{className:"flex items-center",children:[e.jsx(C,{className:"h-4 w-4 mr-2 text-red-500"}),"Not Active"]})})}),e.jsx(m,{})]})}),e.jsx(d,{control:n.control,name:"status",render:({field:s})=>e.jsxs(o,{children:[e.jsx(i,{children:"Status"}),e.jsxs(P,{onValueChange:s.onChange,value:s.value,children:[e.jsx(h,{children:e.jsx(w,{children:e.jsx(T,{placeholder:"Select status"})})}),e.jsxs(F,{children:[e.jsx(c,{value:"pending",children:"Pending"}),e.jsx(c,{value:"inProgress",children:"In Progress"}),e.jsx(c,{value:"completed",children:"Completed"}),e.jsx(c,{value:"cancelled",children:"Cancelled"})]})]}),e.jsx(m,{})]})}),e.jsx(d,{control:n.control,name:"startDate",render:({field:s})=>e.jsxs(o,{className:"flex flex-col",children:[e.jsx(i,{children:"Start Date"}),e.jsxs(k,{children:[e.jsx(E,{asChild:!0,children:e.jsx(h,{children:e.jsx(l,{variant:"outline",className:"pl-3 text-left font-normal",children:s.value?q(s.value,"PPP"):e.jsx("span",{children:"Pick a date"})})})}),e.jsx(V,{className:"w-auto p-0",align:"start",children:e.jsx(I,{mode:"single",selected:s.value,onSelect:s.onChange,initialFocus:!0})})]}),e.jsx(m,{})]})}),e.jsx(d,{control:n.control,name:"endDate",render:({field:s})=>e.jsxs(o,{className:"flex flex-col",children:[e.jsx(i,{children:"End Date"}),e.jsxs(k,{children:[e.jsx(E,{asChild:!0,children:e.jsx(h,{children:e.jsx(l,{variant:"outline",className:"pl-3 text-left font-normal",children:s.value?q(s.value,"PPP"):e.jsx("span",{children:"Pick a date"})})})}),e.jsx(V,{className:"w-auto p-0",align:"start",children:e.jsx(I,{mode:"single",selected:s.value,onSelect:s.onChange,initialFocus:!0})})]}),e.jsx(m,{})]})})]}),e.jsx(d,{control:n.control,name:"description",render:({field:s})=>e.jsxs(o,{children:[e.jsx(i,{children:"Description"}),e.jsx(h,{children:e.jsx(W,{placeholder:"Enter activity description",className:"min-h-[120px]",...s})}),e.jsx(m,{})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Sub-activities"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Add smaller tasks within this activity"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"flex-1",children:e.jsx(A,{placeholder:"Enter sub-activity name",value:r.name,onChange:s=>p({...r,name:s.target.value})})}),e.jsxs(P,{value:r.status,onValueChange:s=>p({...r,status:s}),children:[e.jsx(w,{className:"w-[180px]",children:e.jsx(T,{placeholder:"Status"})}),e.jsxs(F,{children:[e.jsx(c,{value:"pending",children:"Pending"}),e.jsx(c,{value:"inProgress",children:"In Progress"}),e.jsx(c,{value:"completed",children:"Completed"}),e.jsx(c,{value:"cancelled",children:"Cancelled"})]})]}),e.jsxs(l,{type:"button",variant:"secondary",onClick:R,children:[e.jsx(z,{className:"h-4 w-4 mr-2"}),"Add"]})]}),a.length>0?e.jsx("div",{className:"grid gap-2 mt-2",children:a.map(s=>e.jsx(K,{children:e.jsxs(Q,{className:"p-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx("span",{children:s.name}),$(s.status),e.jsx(b,{pressed:s.isActive,onPressedChange:x=>{u(a.map(v=>v.id===s.id?{...v,isActive:x}:v))},className:"data-[state=on]:bg-primary",children:s.isActive?e.jsxs("div",{className:"flex items-center",children:[e.jsx(f,{className:"h-4 w-4 mr-2 text-green-500"}),"Active"]}):e.jsxs("div",{className:"flex items-center",children:[e.jsx(C,{className:"h-4 w-4 mr-2 text-red-500"}),"Not Active"]})})]}),e.jsx(l,{type:"button",variant:"ghost",size:"icon",onClick:()=>X(s.id),children:e.jsx(L,{className:"h-4 w-4"})})]})},s.id))}):e.jsx("p",{className:"text-sm text-muted-foreground italic py-2",children:"No sub-activities added yet"})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[g&&e.jsx(l,{type:"button",variant:"outline",onClick:g,children:"Cancel"}),e.jsx(l,{type:"submit",className:"px-6",children:O?"Update Activity":"Create Activity"})]})]})})};export{me as A};
