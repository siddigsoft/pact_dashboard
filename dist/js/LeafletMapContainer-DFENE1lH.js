import{j as e,u as h,a3 as m,q as x,aw as u,r as g}from"./react-core-B8kFjp2k.js";import{C as f,M as j,T as w,a as v,P as b,L as l,u as k}from"./maps-BzFQ_kYT.js";import{C as N,b as y,A as C,c as M,d as B,B as o}from"./index-PwDgWEVM.js";import{h as A}from"./sudanStates-CkkbYUnU.js";const L=({hub:r,color:a})=>{var n,i;return!((n=r.coordinates)!=null&&n.latitude)||!((i=r.coordinates)!=null&&i.longitude)?null:e.jsx(f,{center:[r.coordinates.latitude,r.coordinates.longitude],radius:5e4,pathOptions:{fillColor:a,fillOpacity:.2,color:a,weight:2}})};delete l.Icon.Default.prototype._getIconUrl;l.Icon.Default.mergeOptions({iconRetinaUrl:"https://unpkg.com/leaflet@1.7.1/dist/images/marker-icon-2x.png",iconUrl:"https://unpkg.com/leaflet@1.7.1/dist/images/marker-icon.png",shadowUrl:"https://unpkg.com/leaflet@1.7.1/dist/images/marker-shadow.png"});const E={"kassala-hub":"#9b87f5","kosti-hub":"#F97316","forchana-hub":"#D946EF","dongola-hub":"#0EA5E9","country-office":"#8B5CF6"},F=({locations:r,defaultCenter:a,defaultZoom:n})=>{const i=k();return g.useEffect(()=>{if(!r||r.length===0){try{i.setView(a,n)}catch{}return}const d=r.filter(t=>t.latitude&&t.longitude).map(t=>[t.latitude,t.longitude]);if(d.length>0)try{const t=l.latLngBounds(d);i.fitBounds(t,{padding:[50,50]})}catch{}},[i,r,a,n]),null},I=(r,a)=>{const n=r==="user"?a==="online"?"#10b981":a==="busy"?"#f59e0b":"#6b7280":a==="completed"?"#10b981":a==="inProgress"?"#6366f1":a==="assigned"?"#f59e0b":"#ef4444";return l.divIcon({className:"custom-div-icon",html:`
      <div style="
        background-color: ${n};
        width: 16px;
        height: 16px;
        border-radius: ${r==="user"?"50%":"2px"};
        border: 2px solid white;
        box-shadow: 0 0 0 2px ${n}40;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 8px;
        color: white;
        font-weight: bold;
      ">${r==="user"?"üë§":"üè¢"}</div>
    `,iconSize:[16,16],iconAnchor:[8,8]})},O=({locations:r=[],height:a="500px",onLocationClick:n,mapType:i="standard",defaultCenter:d=[20,0],defaultZoom:t=3,showHubs:c=!1})=>{const p=s=>s?new Date(s).toLocaleString():"Never";return e.jsx("div",{style:{height:"100%",width:"100%"},className:"rounded-lg",children:e.jsxs(j,{center:d,zoom:t,style:{height:"100%",width:"100%"},className:"rounded-lg",minZoom:2,maxBounds:[[-90,-180],[90,180]],children:[e.jsx(w,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'¬© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}),c&&A.map(s=>e.jsx(L,{hub:s,color:E[s.id]||"#6b7280"},s.id)),r&&r.map(s=>e.jsx(v,{position:[s.latitude,s.longitude],icon:I(s.type,s.status),eventHandlers:{click:()=>n&&n(s.id)},children:e.jsx(b,{children:e.jsx(N,{className:"w-[300px] border-none shadow-none",children:e.jsxs(y,{className:"p-3",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsxs(C,{className:"h-12 w-12",children:[e.jsx(M,{src:s.avatar}),e.jsx(B,{children:s.name.substring(0,2).toUpperCase()})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-base",children:s.name}),e.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[e.jsx(o,{variant:s.status==="online"?"default":"secondary",children:s.status}),s.workload!==void 0&&e.jsxs(o,{variant:"outline",children:[s.workload," tasks"]})]})]})]}),e.jsxs("div",{className:"mt-3 space-y-2 text-sm text-muted-foreground",children:[s.type==="user"&&s.phone&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{className:"h-4 w-4"}),e.jsx("span",{children:s.phone})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(m,{className:"h-4 w-4"}),e.jsxs("span",{children:["[",s.latitude.toFixed(4),", ",s.longitude.toFixed(4),"]"]})]}),s.type==="user"&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(x,{className:"h-4 w-4"}),e.jsxs("span",{children:["Last active: ",p(s.lastActive)]})]}),s.type==="user"&&s.workload!==void 0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(u,{className:"h-4 w-4"}),e.jsxs("span",{children:["Workload: ",s.workload," tasks"]})]})]})]})})})},s.id)),e.jsx(F,{locations:r,defaultCenter:d,defaultZoom:t})]})})};export{O as L};
