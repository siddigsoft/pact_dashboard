import{r as m,R as k,j as e,bc as R,l as P,ao as x,a3 as $,q as E,bM as W}from"./react-core-B8kFjp2k.js";import{J as z,E as B,T as f,i as H,j,C as p,f as N,g,b as y,k as w,a as v,B as c,S as U}from"./index-PwDgWEVM.js";import{C as A}from"./calendar-DEyRSxJX.js";import{D as q}from"./date-range-picker-sQlSgQMW.js";import{bo as F}from"./vendor-VlxgVHMv.js";import{m as J}from"./animations-BiLmE0Io.js";import{c as K,g as h,K as L,o as u}from"./date-utils-YarVESQS.js";import"./docs-D2Yi4cpO.js";import"./react-dom-BLwj5vIO.js";import"./jspdf-rld7HkB6.js";import"./router-CKy9yO3R.js";import"./query-CJ0Bt4ph.js";import"./supabase-CwPDIVMD.js";import"./xlsx-CBxwqXDA.js";import"./forms-CESK2FDA.js";import"./radix-ui-C2DV4xtt.js";import"./radix-dialogs-CnlmQBMC.js";import"./radix-menus-CPezQVZk.js";import"./popover-BSK_FA51.js";const me=()=>{const{siteVisits:r}=z(),o=F(),{users:C}=B(),[i,D]=m.useState(new Date),[t,b]=m.useState({from:new Date,to:K(new Date,1)}),[l,S]=m.useState("daily"),n=k.useMemo(()=>l==="daily"&&i?r.filter(s=>{const a=new Date(s.dueDate);return h(a,i)}):l==="range"&&(t!=null&&t.from)?r.filter(s=>{const a=new Date(s.dueDate);return t.to?a>=t.from&&a<=t.to:h(a,t.from)}):[],[r,i,t,l]),M=s=>{if(!s)return;const a=(C||[]).find(d=>d.id===s);return(a==null?void 0:a.name)||(a==null?void 0:a.fullName)||(a==null?void 0:a.username)},T=s=>{o(`/site-visits/${s}`)},V=s=>r.some(a=>{const d=new Date(a.dueDate);return h(d,s)});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center space-y-2 sm:space-y-0",children:[e.jsxs("h1",{className:"text-2xl font-bold flex items-center",children:[e.jsx(R,{className:"mr-2 h-6 w-6"}),"Schedule & Planning"]}),e.jsx(f,{value:l,onValueChange:s=>S(s),className:"w-[240px]",children:e.jsxs(H,{className:"w-full",children:[e.jsxs(j,{value:"daily",className:"flex-1",children:[e.jsx(P,{className:"h-4 w-4 mr-1"}),"Daily"]}),e.jsxs(j,{value:"range",className:"flex-1",children:[e.jsx(x,{className:"h-4 w-4 mr-1"}),"Range"]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs(p,{className:"lg:col-span-1",children:[e.jsx(N,{children:e.jsx(g,{className:"text-lg",children:"Calendar"})}),e.jsxs(y,{className:"flex flex-col items-center",children:[e.jsxs(f,{value:l,className:"w-full",children:[e.jsx(w,{value:"daily",className:"mt-0",children:e.jsx("div",{className:"flex justify-center",children:e.jsx(A,{mode:"single",selected:i,onSelect:s=>D(s||new Date),className:"rounded-md w-full",modifiers:{withVisits:s=>V(s),today:s=>L(s)},modifiersStyles:{withVisits:{backgroundColor:"rgba(99, 102, 241, 0.1)",fontWeight:"bold",color:"#4F46E5"},today:{fontWeight:"bold",border:"2px solid currentColor"}}})})}),e.jsx(w,{value:"range",className:"mt-0",children:e.jsx("div",{className:"flex justify-center w-full",children:e.jsx(q,{dateRange:t,onDateRangeChange:b})})})]}),e.jsx("div",{className:"mt-6 w-full",children:e.jsxs(v,{variant:"outline",size:"sm",onClick:()=>o("/site-visits/create"),className:"w-full flex items-center justify-center gap-2",children:[e.jsx(x,{className:"h-4 w-4"}),"Schedule New Site Visit"]})})]})]}),e.jsxs(p,{className:"lg:col-span-2",children:[e.jsxs(N,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(g,{className:"text-lg",children:l==="daily"?`Scheduled for ${u(i,"MMMM d, yyyy")}`:"Scheduled Visits"}),e.jsxs(c,{variant:"outline",className:"ml-auto",children:[n.length," visit",n.length!==1?"s":""]})]}),e.jsx(y,{children:n.length>0?e.jsx(U,{className:"h-[500px] pr-4",children:e.jsx("div",{className:"space-y-3",children:n.map((s,a)=>e.jsxs(J.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:a*.05},className:"border rounded-lg p-4 hover:shadow-md transition-all cursor-pointer",onClick:()=>T(s.id),children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:s.siteName}),e.jsxs("div",{className:"flex items-center text-sm text-muted-foreground mt-1",children:[e.jsx($,{className:"h-4 w-4 mr-1"}),e.jsxs("span",{children:[s.locality,s.state&&`, ${s.state}`]})]})]}),e.jsx(c,{className:"capitalize",variant:s.status==="completed"?"success":s.status==="pending"?"outline":s.status==="inProgress"?"secondary":"outline",children:s.status})]}),e.jsxs("div",{className:"mt-3 flex gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center text-muted-foreground",children:[e.jsx(E,{className:"h-4 w-4 mr-1"}),u(new Date(s.dueDate),"HH:mm")]}),s.priority&&e.jsx(c,{variant:s.priority==="high"?"destructive":s.priority==="medium"?"warning":"outline",className:"capitalize text-xs",children:s.priority}),s.visitType&&e.jsx(c,{variant:"outline",className:"bg-slate-100 text-xs",children:s.visitType})]}),s.assignedTo&&e.jsxs("div",{className:"text-sm mt-2 flex items-center",children:[e.jsx("span",{className:"text-muted-foreground mr-2",children:"Assigned to:"}),e.jsx("span",{className:"font-medium",children:M(s.assignedTo)||"Unknown"})]})]},s.id))})}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-[300px] text-center",children:[e.jsx(W,{className:"h-16 w-16 text-gray-300 mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-1",children:"No visits scheduled"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:l==="daily"?`No site visits scheduled for ${u(i,"MMMM d, yyyy")}`:"No site visits found in the selected date range"}),e.jsxs(v,{variant:"outline",onClick:()=>o("/site-visits/create"),className:"flex items-center gap-2",children:[e.jsx(x,{className:"h-4 w-4"}),"Schedule a Visit"]})]})})]})]})]})};export{me as default};
