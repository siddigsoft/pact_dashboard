import{r as n,j as e,U as m,ah as N,_ as v,ar as b,b7 as w,aQ as z}from"./react-core-B8kFjp2k.js";import{v as C,E as S,a as r,A as f,S as E}from"./index-PwDgWEVM.js";import{T as M}from"./textarea-BpQMf5eL.js";import{L as T}from"./date-utils-YarVESQS.js";const k=()=>{const{activeChat:s,getChatMessages:u,sendMessage:p,setActiveChat:j}=C(),[i,o]=n.useState(""),{currentUser:l}=S(),x=n.useRef(null),a=n.useRef(null),c=s?u(s.id)||[]:[];n.useEffect(()=>{var t;(t=x.current)==null||t.scrollIntoView({behavior:"smooth"})},[c]);const h=()=>{i.trim()&&s&&(p(s.id,i,"text"),o(""),a.current&&(a.current.style.height="auto"))},g=t=>{t.key==="Enter"&&!t.shiftKey&&(t.preventDefault(),h())},y=t=>{o(t.target.value),a.current&&(a.current.style.height="auto",a.current.style.height=`${Math.min(a.current.scrollHeight,120)}px`)};return s?e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"py-3 px-4 flex items-center justify-between border-b bg-white",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(r,{variant:"ghost",size:"icon",className:"md:hidden mr-2",onClick:()=>j(null),children:e.jsx(N,{size:18})}),e.jsxs("div",{className:"flex items-center gap-3",children:[s.type==="private"?e.jsx(f,{className:"h-9 w-9",children:e.jsx("div",{className:"bg-primary/20 w-full h-full rounded-full flex items-center justify-center text-primary font-medium",children:s.name.charAt(0).toUpperCase()})}):e.jsx(f,{className:"h-9 w-9",children:e.jsx("div",{className:"bg-secondary/20 w-full h-full rounded-full flex items-center justify-center",children:e.jsx(m,{size:16,className:"text-secondary"})})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium leading-tight",children:s.name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.type==="group"?`${s.participants.length} participants`:"Online"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(r,{variant:"ghost",size:"icon",children:e.jsx(v,{size:18})}),e.jsx(r,{variant:"ghost",size:"icon",children:e.jsx(b,{size:18})})]})]}),e.jsx(E,{className:"flex-1 p-4",children:e.jsxs("div",{className:"space-y-4 pb-4",children:[c.length>0?c.map(t=>{const d=t.senderId===(l==null?void 0:l.id);return e.jsx("div",{className:`flex ${d?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:`max-w-[75%] rounded-lg p-3 ${d?"bg-primary text-primary-foreground":"bg-gray-100 text-foreground"}`,children:[!d&&e.jsx("p",{className:"text-xs font-medium mb-1",children:t.senderId==="usr1"?"You":s.name}),e.jsx("p",{className:"text-sm break-words",children:t.content}),e.jsx("p",{className:"text-xs mt-1 opacity-70 text-right",children:T(new Date(t.timestamp),{addSuffix:!0,includeSeconds:!0})})]})},t.id)}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx("div",{className:"h-12 w-12 rounded-full bg-primary/10 flex items-center justify-center mb-3",children:e.jsx(m,{size:24,className:"text-primary"})}),e.jsx("p",{className:"font-medium",children:"Start your conversation"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:s.type==="private"?`Send your first message to ${s.name}`:`Send your first message to the ${s.name} group`})]}),e.jsx("div",{ref:x})]})}),e.jsx("div",{className:"p-3 bg-white border-t",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(r,{variant:"outline",size:"icon",className:"h-10 w-10",children:e.jsx(w,{size:18})}),e.jsx("div",{className:"flex-1 flex items-end",children:e.jsx(M,{ref:a,placeholder:"Type a message...",className:"resize-none min-h-[40px] max-h-[120px] py-2",value:i,onChange:y,onKeyDown:g})}),e.jsx(r,{size:"icon",className:"h-10 w-10",onClick:h,disabled:!i.trim(),children:e.jsx(z,{size:18})})]})})]}):e.jsx("div",{className:"h-full flex flex-col items-center justify-center p-6 text-center bg-gray-50",children:e.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-sm max-w-md",children:[e.jsx("div",{className:"h-16 w-16 rounded-full bg-primary/10 flex items-center justify-center mx-auto mb-4",children:e.jsx(m,{size:32,className:"text-primary"})}),e.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Select a conversation"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Choose a chat from the sidebar or start a new conversation to begin messaging"})]})})};export{k as C};
