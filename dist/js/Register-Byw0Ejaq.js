import{j as e,ad as z,a3 as Q,r as d,ae as $,y as L,a9 as D,p as J,a0 as K}from"./react-core-B8kFjp2k.js";import{L as W}from"./router-CKy9yO3R.js";import{e as X,u as Z,q as _,C as ee,f as se,g as ae,h as re,b as le,T as ie,i as te,j as q,k,I as o,r as ne,a as oe}from"./index-PwDgWEVM.js";import{L as t}from"./label-C4lDws8j.js";import{A as de,a as ce,b as me}from"./alert-BXWNuJnD.js";import{R as pe,a as he}from"./radio-group-CC4lGE1V.js";import{S as w,a as C,b as S,c as P,d as F}from"./select-CXX5Q_V1.js";import{h as I,s as V,g as xe}from"./sudanStates-CkkbYUnU.js";import{bo as ue}from"./vendor-VlxgVHMv.js";import"./docs-D2Yi4cpO.js";import"./react-dom-BLwj5vIO.js";import"./jspdf-rld7HkB6.js";import"./query-CJ0Bt4ph.js";import"./supabase-CwPDIVMD.js";import"./xlsx-CBxwqXDA.js";import"./date-utils-YarVESQS.js";import"./forms-CESK2FDA.js";import"./radix-ui-C2DV4xtt.js";import"./radix-dialogs-CnlmQBMC.js";import"./radix-menus-CPezQVZk.js";const H=({role:s,onRoleChange:j,isManagementTab:p})=>{const g=p?[{value:"Admin",title:"System Administrator",description:["Full system access and configuration control","Manage user roles and permissions","Monitor system performance and security","Oversee system updates and maintenance","Provide technical support and troubleshooting"]},{value:"ICT",title:"ICT Team Member",description:["Maintain and optimize technical infrastructure","Implement robust data security measures","Manage system integrations and APIs","Support mobile and web application deployment","Handle technical incident response"]},{value:"Supervisor",title:"Regional Supervisor",description:["Oversee all operations within assigned hub region","Manage and coordinate field teams across multiple states","Ensure compliance with procedures and standards","Review and validate collected data","Generate comprehensive performance reports"]},{value:"Field Operation Manager (FOM)",title:"Field Operations Manager",description:["Strategic planning of field operations","Resource allocation and team optimization","Quality control and performance monitoring","Stakeholder communication and reporting","Process improvement and standardization"]},{value:"FinancialAdmin",title:"Financial Administrator",description:["Manage budgets and financial operations","Process payments and expense reports","Monitor financial compliance","Generate financial analytics and forecasts","Coordinate with external financial partners"]}]:[{value:"DataCollector",title:"Data Collector",description:["Conduct on-site data collection and verification","Document site conditions and gather required information","Use mobile tools for real-time data capture","Submit accurate and timely site visit reports","Follow assigned schedules and location-based tasks"]},{value:"Coordinator",title:"Coordinator",description:["Manage and oversee data collection teams","Review and validate submitted data","Coordinate site visit schedules and assignments","Ensure quality control of collected information","Provide support and guidance to data collectors"]}];return e.jsxs("div",{className:"rounded-lg border bg-card p-4",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-3 flex items-center gap-2",children:[e.jsx(z,{className:"h-5 w-5"}),"Select Your Role"]}),e.jsx("div",{className:"space-y-4",children:e.jsx(pe,{value:s,onValueChange:j,className:"grid grid-cols-1 gap-3",children:g.map(a=>e.jsxs(t,{className:`flex flex-col space-y-2 border p-4 rounded-md cursor-pointer transition-colors ${s===a.value?"bg-primary/5 border-primary":""}`,children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(he,{value:a.value,id:a.value}),e.jsx("span",{className:"font-semibold",children:a.title})]}),e.jsx("div",{className:"text-sm text-muted-foreground pl-6",children:e.jsx("ul",{className:"list-disc space-y-1",children:a.description.map((h,m)=>e.jsx("li",{children:h},m))})})]},a.value))})})]})},O=({selectedHub:s,setSelectedHub:j,selectedState:p,setSelectedState:g,availableStates:a,localities:h,showStateSelection:m=!0})=>{var f;return e.jsxs("div",{className:"rounded-lg border bg-card p-4",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-3 flex items-center gap-2",children:[e.jsx(Q,{className:"h-5 w-5"}),m?"Location Details":"Hub Assignment"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(t,{children:["Hub Office",e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),e.jsxs(w,{value:s,onValueChange:j,children:[e.jsx(C,{className:"w-full",children:e.jsx(S,{placeholder:"Select hub office"})}),e.jsx(P,{children:I.map(l=>e.jsx(F,{value:l.id,children:l.name},l.id))})]})]}),s&&!m&&e.jsxs("div",{className:"mt-4 p-3 bg-muted rounded-md",children:[e.jsx("p",{className:"text-sm font-medium",children:"States under this hub:"}),e.jsx("ul",{className:"mt-2 space-y-1",children:(f=I.find(l=>l.id===s))==null?void 0:f.states.map(l=>{var i;return e.jsxs("li",{className:"text-sm text-muted-foreground",children:["â€¢ ",(i=V.find(x=>x.id===l))==null?void 0:i.name]},l)})})]}),m&&s&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs(t,{children:["State",e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),e.jsxs(w,{value:p,onValueChange:g,children:[e.jsx(C,{children:e.jsx(S,{placeholder:"Select state"})}),e.jsx(P,{children:a.map(l=>{const i=V.find(x=>x.id===l);return i?e.jsx(F,{value:i.id,children:i.name},i.id):null})})]})]}),m&&p&&h.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{children:"Locality"}),e.jsxs(w,{children:[e.jsx(C,{children:e.jsx(S,{placeholder:"Select locality (Optional)"})}),e.jsx(P,{children:h.map(l=>e.jsx(F,{value:l.id,children:l.name},l.id))})]})]})]})]})},qe=()=>{const[s,j]=d.useState({name:"",email:"",phone:"",employeeId:"",password:"",confirmPassword:"",role:"dataCollector"}),[p,g]=d.useState(!1),[a,h]=d.useState({}),{registerUser:m}=X(),f=ue(),{toast:l}=Z(),[i,x]=d.useState(""),[u,v]=d.useState(""),[E,R]=d.useState([]),[M,b]=d.useState([]),{sendNotification:G}=_(),U=["admin","ict","supervisor","fom","financialAdmin"],B=async r=>{if(r.preventDefault(),!Y())return;const c=s.role==="dataCollector"||s.role==="coordinator",y=s.role==="supervisor";if(c&&(!i||!u)){l({title:"Missing Location",description:"Please select your hub and state",variant:"destructive"});return}if(y&&!i){l({title:"Missing Hub",description:"Please select your hub office",variant:"destructive"});return}g(!0);try{await m({...s,hubId:i,stateId:u})&&(G({title:"Registration Successful",message:"Your registration has been submitted successfully",type:"success"}),U.includes(s.role)?f("/registration-success?type=management"):f("/registration-success"))}catch{l({title:"Registration Failed",description:"An error occurred during registration. Please try again.",variant:"destructive"})}finally{g(!1)}},n=r=>{const{name:c,value:y}=r.target;j(N=>({...N,[c]:y})),a[c]&&h(N=>{const A={...N};return delete A[c],A})},T=r=>{j(c=>({...c,role:r}))},Y=()=>{const r={};return s.name.trim()||(r.name="Name is required"),s.email.trim()?/\S+@\S+\.\S+/.test(s.email)||(r.email="Email is invalid"):r.email="Email is required",!s.phone&&(s.role==="dataCollector"||s.role==="coordinator")&&(r.phone="Phone number is required for field team roles"),s.password?s.password.length<6&&(r.password="Password must be at least 6 characters"):r.password="Password is required",s.password!==s.confirmPassword&&(r.confirmPassword="Passwords do not match"),h(r),Object.keys(r).length===0};return d.useEffect(()=>{(s.role==="dataCollector"||s.role==="coordinator")&&(x(""),v(""),R([]),b([]))},[s.role]),d.useEffect(()=>{if(i){const r=I.find(c=>c.id===i);r&&(R(r.states),v(""),b([]))}},[i]),d.useEffect(()=>{if(u){const r=xe(u);b(r)}},[u]),e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100 p-4",children:e.jsxs(ee,{className:"w-full max-w-lg",children:[e.jsxs(se,{className:"space-y-2 text-center",children:[e.jsx("div",{className:"flex justify-center mb-2",children:e.jsx("div",{className:"h-16 w-16 rounded-full bg-primary/10 flex items-center justify-center",children:e.jsx($,{className:"h-8 w-8 text-primary"})})}),e.jsx(ae,{className:"text-2xl font-bold",children:"Create an Account"}),e.jsx(re,{className:"text-base",children:"Register to access PACT Consultancy"})]}),e.jsxs("form",{onSubmit:B,children:[e.jsx(le,{className:"space-y-6",children:e.jsxs(ie,{defaultValue:"field-team",children:[e.jsxs(te,{className:"grid grid-cols-2 mb-4",children:[e.jsxs(q,{value:"field-team",className:"flex items-center gap-2",children:[e.jsx(z,{size:16}),"Field Team"]}),e.jsx(q,{value:"admin-roles",children:"Management Roles"})]}),e.jsx(k,{value:"field-team",children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(H,{role:s.role,onRoleChange:T,isManagementTab:!1}),(s.role==="dataCollector"||s.role==="coordinator")&&e.jsx(O,{selectedHub:i,setSelectedHub:x,selectedState:u,setSelectedState:v,availableStates:E,localities:M}),e.jsxs("div",{className:"rounded-lg border bg-card p-4",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-3 flex items-center gap-2",children:[e.jsx(L,{className:"h-5 w-5"}),"Personal Information"]}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(t,{htmlFor:"name",children:["Full Name",e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),e.jsx(o,{id:"name",name:"name",placeholder:"Enter your full name",value:s.name,onChange:n,className:a.name?"border-red-500":""}),a.name&&e.jsx("p",{className:"text-xs text-red-500",children:a.name})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(t,{htmlFor:"email",children:["Email",e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),e.jsx(o,{id:"email",name:"email",type:"email",placeholder:"Enter your email",value:s.email,onChange:n,className:a.email?"border-red-500":""}),a.email&&e.jsx("p",{className:"text-xs text-red-500",children:a.email})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(t,{htmlFor:"phone",children:["Phone Number",(s.role==="dataCollector"||s.role==="coordinator")&&e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),e.jsx(o,{id:"phone",name:"phone",placeholder:"Enter your phone number",value:s.phone,onChange:n,className:a.phone?"border-red-500":""}),a.phone&&e.jsx("p",{className:"text-xs text-red-500",children:a.phone})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"employeeId",children:"Employee ID (Optional)"}),e.jsx(o,{id:"employeeId",name:"employeeId",placeholder:"Enter your employee ID",value:s.employeeId,onChange:n})]})]})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-3 flex items-center gap-2",children:[e.jsx(D,{className:"h-5 w-5"}),"Security"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(t,{htmlFor:"password",children:["Password",e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),e.jsx(o,{id:"password",name:"password",type:"password",placeholder:"Create a password",value:s.password,onChange:n,className:a.password?"border-red-500":""}),a.password&&e.jsx("p",{className:"text-xs text-red-500",children:a.password})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(t,{htmlFor:"confirmPassword",children:["Confirm Password",e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),e.jsx(o,{id:"confirmPassword",name:"confirmPassword",type:"password",placeholder:"Confirm your password",value:s.confirmPassword,onChange:n,className:a.confirmPassword?"border-red-500":""}),a.confirmPassword&&e.jsx("p",{className:"text-xs text-red-500",children:a.confirmPassword})]})]})]})]})}),e.jsx(k,{value:"admin-roles",children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(H,{role:s.role,onRoleChange:T,isManagementTab:!0}),s.role==="supervisor"&&e.jsx(O,{selectedHub:i,setSelectedHub:x,selectedState:u,setSelectedState:v,availableStates:E,localities:M,showStateSelection:!1}),e.jsxs(de,{variant:"destructive",className:"mb-4",children:[e.jsx(J,{className:"h-4 w-4"}),e.jsx(ce,{children:"Management Team Registration"}),e.jsx(me,{children:"These roles require special approval from existing administrators"})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-3 flex items-center gap-2",children:[e.jsx(L,{className:"h-5 w-5"}),"Personal Information"]}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(t,{htmlFor:"name",children:["Full Name",e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),e.jsx(o,{id:"name",name:"name",placeholder:"Enter your full name",value:s.name,onChange:n,className:a.name?"border-red-500":""}),a.name&&e.jsx("p",{className:"text-xs text-red-500",children:a.name})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(t,{htmlFor:"email",children:["Email",e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),e.jsx(o,{id:"email",name:"email",type:"email",placeholder:"Enter your email",value:s.email,onChange:n,className:a.email?"border-red-500":""}),a.email&&e.jsx("p",{className:"text-xs text-red-500",children:a.email})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(t,{htmlFor:"phone",children:["Phone Number",(s.role==="dataCollector"||s.role==="coordinator")&&e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),e.jsx(o,{id:"phone",name:"phone",placeholder:"Enter your phone number",value:s.phone,onChange:n,className:a.phone?"border-red-500":""}),a.phone&&e.jsx("p",{className:"text-xs text-red-500",children:a.phone})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"employeeId",children:"Employee ID (Optional)"}),e.jsx(o,{id:"employeeId",name:"employeeId",placeholder:"Enter your employee ID",value:s.employeeId,onChange:n})]})]})]})]}),e.jsxs("div",{className:"rounded-lg border bg-card p-4",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-3 flex items-center gap-2",children:[e.jsx(D,{className:"h-5 w-5"}),"Security"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(t,{htmlFor:"password",children:["Password",e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),e.jsx(o,{id:"password",name:"password",type:"password",placeholder:"Create a password",value:s.password,onChange:n,className:a.password?"border-red-500":""}),a.password&&e.jsx("p",{className:"text-xs text-red-500",children:a.password})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(t,{htmlFor:"confirmPassword",children:["Confirm Password",e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),e.jsx(o,{id:"confirmPassword",name:"confirmPassword",type:"password",placeholder:"Confirm your password",value:s.confirmPassword,onChange:n,className:a.confirmPassword?"border-red-500":""}),a.confirmPassword&&e.jsx("p",{className:"text-xs text-red-500",children:a.confirmPassword})]})]})]})]})})]})}),e.jsxs(ne,{className:"flex flex-col",children:[e.jsx(oe,{type:"submit",className:"w-full",disabled:p,children:p?e.jsxs(e.Fragment,{children:[e.jsx(K,{className:"mr-2 h-4 w-4 animate-spin"}),"Registering..."]}):"Register"}),e.jsxs("p",{className:"mt-4 text-center text-sm",children:["Already have an account?"," ",e.jsx(W,{to:"/login",className:"text-primary hover:underline",children:"Sign In"})]})]})]})]})})};export{qe as default};
