import{r as m,j as e,bs as w,bt as H,U as P,b5 as E}from"./react-core-B8kFjp2k.js";import{E as V,C as z,f as q,g as G,h as J,a as o,b as K,A as C,c as b,d as T,D as Q,l as X,m as Y,n as Z,I as _,B as ee,p as se}from"./index-PwDgWEVM.js";import{S as y,a as S,b as A,c as M,d as a}from"./select-CXX5Q_V1.js";import{T as k,a as I,b as x,c as d,d as D,e as n}from"./table-CZ8ZB6wW.js";const ne=({project:R,onTeamChange:j})=>{var N;const{users:U}=V(),[h,O]=m.useState(""),[L,c]=m.useState(!1),[p,W]=m.useState("dataCollector"),[i,u]=m.useState(((N=R.team)==null?void 0:N.teamComposition)||[]),v=s=>Math.floor(Math.random()*100),g=U.filter(s=>{const l=i.some(t=>t.userId===s.id),r=s.name.toLowerCase().includes(h.toLowerCase())||s.email.toLowerCase().includes(h.toLowerCase())||s.role&&s.role.toLowerCase().includes(h.toLowerCase());return!l&&r}),$=s=>{var t;const l={userId:s.id,name:s.name,role:p,joinedAt:new Date().toISOString(),workload:((t=s.performance)==null?void 0:t.currentWorkload)||v(s.id)},r=[...i,l];u(r),j(r),c(!1)},B=s=>{const l=i.filter(r=>r.userId!==s);u(l),j(l)},F=(s,l)=>{const r=i.map(t=>t.userId===s?{...t,role:l}:t);u(r),j(r)},f=s=>s?s<30?"bg-green-500":s<70?"bg-yellow-500":"bg-red-500":"bg-gray-200";return e.jsxs(z,{className:"mt-8",children:[e.jsxs(q,{className:"flex flex-row items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(G,{children:"Team Composition"}),e.jsx(J,{children:"Assign team members and roles for this project"})]}),e.jsxs(o,{onClick:()=>c(!0),children:[e.jsx(w,{className:"h-4 w-4 mr-2"})," Add Team Member"]})]}),e.jsxs(K,{children:[i.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(k,{children:[e.jsx(I,{children:e.jsxs(x,{children:[e.jsx(d,{children:"Team Member"}),e.jsx(d,{children:"Role"}),e.jsx(d,{className:"w-[100px] text-right",children:"Workload"}),e.jsx(d,{className:"w-[100px] text-right",children:"Actions"})]})}),e.jsx(D,{children:i.map(s=>e.jsxs(x,{children:[e.jsx(n,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(C,{className:"h-8 w-8",children:[e.jsx(b,{src:`https://api.dicebear.com/7.x/initials/svg?seed=${s.name}`,alt:s.name}),e.jsx(T,{children:s.name.substring(0,2).toUpperCase()})]}),e.jsx("div",{children:e.jsx("p",{className:"font-medium",children:s.name})})]})}),e.jsx(n,{children:e.jsxs(y,{value:s.role,onValueChange:l=>F(s.userId,l),children:[e.jsx(S,{className:"w-[160px]",children:e.jsx(A,{placeholder:"Select role"})}),e.jsxs(M,{children:[e.jsx(a,{value:"projectManager",children:"Project Manager"}),e.jsx(a,{value:"fieldAssistant",children:"Field Assistant"}),e.jsx(a,{value:"dataCollector",children:"Data Collector"}),e.jsx(a,{value:"supervisor",children:"Supervisor"}),e.jsx(a,{value:"coordinator",children:"Coordinator"}),e.jsx(a,{value:"analyst",children:"Analyst"}),e.jsx(a,{value:"reviewer",children:"Reviewer"}),e.jsx(a,{value:"other",children:"Other"})]})]})}),e.jsx(n,{className:"text-right",children:e.jsxs("div",{className:"flex items-center justify-end",children:[e.jsx("div",{className:"w-full max-w-[100px] h-2 bg-gray-200 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full ${f(s.workload)}`,style:{width:`${s.workload||0}%`}})}),e.jsxs("span",{className:"ml-2 text-xs",children:[s.workload||0,"%"]})]})}),e.jsx(n,{className:"text-right",children:e.jsx(o,{variant:"ghost",size:"sm",onClick:()=>B(s.userId),children:e.jsx(H,{className:"h-4 w-4 text-destructive"})})})]},s.userId))})]})}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 border border-dashed rounded-lg",children:[e.jsx(P,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"No team members assigned yet"}),e.jsxs(o,{className:"mt-4",onClick:()=>c(!0),children:[e.jsx(w,{className:"h-4 w-4 mr-2"})," Add Team Member"]})]}),e.jsx(Q,{open:L,onOpenChange:c,children:e.jsxs(X,{className:"max-w-2xl",children:[e.jsx(Y,{children:e.jsx(Z,{children:"Add Team Member"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx(_,{placeholder:"Search by name, email or role...",value:h,onChange:s=>O(s.target.value)})}),e.jsxs(y,{value:p,onValueChange:s=>W(s),children:[e.jsx(S,{className:"w-[180px]",children:e.jsx(A,{placeholder:"Select role"})}),e.jsxs(M,{children:[e.jsx(a,{value:"projectManager",children:"Project Manager"}),e.jsx(a,{value:"fieldAssistant",children:"Field Assistant"}),e.jsx(a,{value:"dataCollector",children:"Data Collector"}),e.jsx(a,{value:"supervisor",children:"Supervisor"}),e.jsx(a,{value:"coordinator",children:"Coordinator"}),e.jsx(a,{value:"analyst",children:"Analyst"}),e.jsx(a,{value:"reviewer",children:"Reviewer"}),e.jsx(a,{value:"other",children:"Other"})]})]})]}),e.jsx("div",{className:"border rounded-md overflow-hidden max-h-[300px] overflow-y-auto",children:e.jsxs(k,{children:[e.jsx(I,{children:e.jsxs(x,{children:[e.jsx(d,{children:"User"}),e.jsx(d,{children:"Role"}),e.jsx(d,{className:"w-[100px] text-right",children:"Workload"}),e.jsx(d,{className:"w-[100px] text-right",children:"Actions"})]})}),e.jsx(D,{children:g.length>0?g.map(s=>{var t;const l=((t=s.performance)==null?void 0:t.currentWorkload)||v(s.id),r=l>80;return e.jsxs(x,{children:[e.jsx(n,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(C,{className:"h-8 w-8",children:[e.jsx(b,{src:s.avatar||`https://api.dicebear.com/7.x/initials/svg?seed=${s.name}`,alt:s.name}),e.jsx(T,{children:s.name.substring(0,2).toUpperCase()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.email})]})]})}),e.jsx(n,{children:s.role}),e.jsxs(n,{className:"text-right",children:[e.jsxs("div",{className:"flex items-center justify-end",children:[e.jsx("div",{className:"w-full max-w-[100px] h-2 bg-gray-200 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full ${f(l)}`,style:{width:`${l}%`}})}),e.jsxs("span",{className:"ml-2 text-xs",children:[l,"%"]})]}),r&&e.jsx(ee,{variant:"outline",className:"ml-2 text-xs bg-red-50 text-red-700 border-red-200",children:"Overloaded"})]}),e.jsx(n,{className:"text-right",children:e.jsx(o,{size:"sm",onClick:()=>$(s),children:e.jsx(E,{className:"h-4 w-4"})})})]},s.id)}):e.jsx(x,{children:e.jsx(n,{colSpan:4,className:"text-center py-4",children:"No users found matching your search criteria"})})})]})})]}),e.jsx(se,{children:e.jsx(o,{variant:"outline",onClick:()=>c(!1),children:"Cancel"})})]})})]})]})};export{ne as T};
