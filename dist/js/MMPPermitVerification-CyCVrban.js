import{j as e,a3 as qe,i as at,l as ve,I as Ge,aV as ae,ag as ie,r as w,p as it,a7 as me,aW as nt,aX as rt,R as ce,$ as We,aY as Le,a2 as je,aG as ct,C as lt}from"./react-core-B8kFjp2k.js";import{B as Y,a as B,C as W,b as J,a3 as dt,D as ge,l as Ne,m as ye,n as pe,p as we,u as le,e as $e,U as Xe,T as ot,i as ft,j as Be,k as Re,I as ht,s as L,H as Se,f as he,g as xe,h as ue}from"./index-PwDgWEVM.js";import{P as Ae}from"./progress-vMwTbqUI.js";import{T as Ee}from"./textarea-BpQMf5eL.js";import{C as xt}from"./calendar-DEyRSxJX.js";import{P as ut,a as mt,b as jt}from"./popover-BSK_FA51.js";import{o as be}from"./date-utils-YarVESQS.js";import{L as F}from"./label-C4lDws8j.js";import{S as Ye,a as Je,b as Qe,c as Ze,d as Ue}from"./select-CXX5Q_V1.js";import{s as ee,a as vt}from"./sudanStates-CkkbYUnU.js";import{R as gt,a as Nt}from"./radio-group-CC4lGE1V.js";import{P as yt}from"./PermitPreviewDialog-B2XKKnFF.js";import{C as pt}from"./checkbox-9q2dlFjr.js";import{bo as wt}from"./vendor-VlxgVHMv.js";const St=({site:t})=>e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-2",children:"Location Details"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("p",{className:"flex items-center gap-2",children:[e.jsx(qe,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"font-medium",children:"Hub Office:"})," ",t.hubOffice||"N/A"]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"State:"})," ",t.state||"N/A"]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Locality:"})," ",t.locality||"N/A"]})]})]}),bt=({site:t})=>e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-2",children:"Cooperating Partner Details"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"CP Name:"})," ",t.cpName||"N/A"]}),e.jsxs("p",{className:"flex items-center gap-2",children:[e.jsx(at,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"font-medium",children:"Main Activity:"})," ",t.mainActivity||"N/A"]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Activity at Site:"})," ",t.siteActivity||"N/A"]})]})]}),Pt=({site:t})=>e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-2",children:"Visit Information"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Visit Type:"})," ",t.visitType||"N/A"]}),e.jsxs("p",{className:"flex items-center gap-2",children:[e.jsx(ve,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"font-medium",children:"Visit Date:"})," ",t.visitDate?new Date(t.visitDate).toLocaleDateString():"N/A"]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Status:"})," ",t.status]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Visited By:"})," ",t.visitedBy||"N/A"]})]})]}),Ct=({status:t})=>{switch(t){case"verified":return e.jsxs(Y,{variant:"success",className:"flex items-center gap-2",children:[e.jsx(ie,{className:"h-4 w-4"}),"Verified"]});case"rejected":return e.jsxs(Y,{variant:"destructive",className:"flex items-center gap-2",children:[e.jsx(ae,{className:"h-4 w-4"}),"Rejected"]});default:return e.jsxs(Y,{variant:"outline",className:"flex items-center gap-2",children:[e.jsx(Ge,{className:"h-4 w-4"}),"Pending"]})}},Mt=({currentStatus:t,onVerifyClick:C})=>e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsxs(B,{variant:"outline",size:"sm",onClick:()=>C("verified"),disabled:t==="verified",className:"border-green-300 text-green-700 hover:bg-green-50",children:[e.jsx(ie,{className:"h-4 w-4 mr-1"}),"Verify"]}),e.jsxs(B,{variant:"outline",size:"sm",onClick:()=>C("rejected"),disabled:t==="rejected",className:"border-red-300 text-red-700 hover:bg-red-50",children:[e.jsx(ae,{className:"h-4 w-4 mr-1"}),"Reject"]})]}),Dt=({site:t,onVerify:C,verificationStatus:h={}})=>{var T,I;const[R,j]=w.useState(!1),[M,D]=w.useState(),[a,r]=w.useState(""),z=((T=h[t.id])==null?void 0:T.status)||null,G=u=>{D(u),j(!0)},p=()=>{M&&(C(t.id,M,a),j(!1),r(""))};return e.jsx(W,{className:"mb-4",children:e.jsxs(J,{className:"pt-6",children:[e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium",children:t.siteName}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Site Code: ",t.siteCode]})]}),e.jsx(Ct,{status:z})]}),e.jsx(dt,{}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx(St,{site:t}),e.jsx(bt,{site:t})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(Pt,{site:t}),t.comments&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-2",children:"Comments"}),e.jsx("p",{className:"text-sm text-muted-foreground bg-muted p-3 rounded-md",children:t.comments})]}),((I=h[t.id])==null?void 0:I.notes)&&e.jsxs("div",{className:"bg-muted p-3 rounded-md",children:[e.jsx("h4",{className:"text-sm font-medium mb-1",children:"Verification Notes"}),e.jsx("p",{className:"text-sm",children:h[t.id].notes})]})]})]}),e.jsx(Mt,{currentStatus:z,onVerifyClick:G})]}),e.jsx(ge,{open:R,onOpenChange:j,children:e.jsxs(Ne,{children:[e.jsx(ye,{children:e.jsx(pe,{children:M==="verified"?"Verify Site":"Reject Site"})}),e.jsxs("div",{className:"py-4",children:[e.jsxs("p",{children:["Are you sure you want to ",M==="verified"?"verify":"reject"," this site?"]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{htmlFor:"verification-notes",className:"text-sm font-medium mb-2 block",children:"Verification Notes"}),e.jsx(Ee,{id:"verification-notes",placeholder:"Add any notes about the verification...",value:a,onChange:u=>r(u.target.value),className:"mt-1"})]})]}),e.jsxs(we,{children:[e.jsx(B,{variant:"outline",onClick:()=>j(!1),children:"Cancel"}),e.jsxs(B,{onClick:p,variant:M==="verified"?"default":"destructive",children:["Confirm ",M==="verified"?"Verification":"Rejection"]})]})]})})]})})},Yt=({mmpFile:t,onVerificationComplete:C})=>{const[h,R]=w.useState({}),[j,M]=w.useState(0),{toast:D}=le(),{currentUser:a}=$e(),{mmpFiles:r,addMMPFile:z,updateMMPFile:G}=Xe();w.useEffect(()=>{var S;const u=(S=t==null?void 0:t.cpVerification)==null?void 0:S.siteVerification;if(u&&typeof u=="object"){const H=Object.entries(u).reduce((E,[b,N])=>(E[b]={status:N.verified?"verified":"rejected",notes:N.notes},E),{});R(H)}},[t==null?void 0:t.cpVerification]),w.useEffect(()=>{if(t!=null&&t.siteEntries&&t.siteEntries.length>0){const u=t.siteEntries.length,S=Object.values(h).filter(E=>E.status==="verified"||E.status==="rejected").length,H=Math.round(S/u*100);if(M(H),S===u){const E={verificationStatus:"complete",verifiedAt:new Date().toISOString(),verifiedBy:"Current User",completionPercentage:100,siteVerification:Object.entries(h).reduce((b,[N,P])=>({...b,[N]:{verified:P.status==="verified",verifiedAt:new Date().toISOString(),verifiedBy:"Current User",notes:P.notes}}),{})};C==null||C(E)}}},[h,t,C]);const p=async(u,S,H)=>{var N;const E=Object.values(h).every(P=>!P.status)&&!((N=h[u])!=null&&N.status);let b=null;if(E&&S==="verified"){const P=r.find(_=>_.status==="approved"&&_.mmpId===t.id&&_.type==="verified-template");if(P)b=P;else{const _={...t,id:`verified-${t.id}-${Date.now()}`,name:`${t.name} - Verified`,status:"approved",mmpId:t.id,type:"verified-template",uploadedBy:(a==null?void 0:a.username)||(a==null?void 0:a.fullName)||(a==null?void 0:a.email)||"System",uploadedAt:new Date().toISOString(),approvedBy:(a==null?void 0:a.username)||(a==null?void 0:a.fullName)||(a==null?void 0:a.email)||"System",approvedAt:new Date().toISOString(),siteEntries:[],cpVerification:void 0,workflow:{currentStage:"verified",lastUpdated:new Date().toISOString(),assignedTo:(a==null?void 0:a.username)||(a==null?void 0:a.fullName)||(a==null?void 0:a.email)||"System"}};z(_),b=_,D({title:"Verified MMP Template Created",description:`A new verified MMP template has been created for ${t.name}`})}}else b=r.find(P=>P.status==="approved"&&P.mmpId===t.id&&P.type==="verified-template")||null;R(P=>{var Z,oe;const _={...P,[u]:{status:S,notes:H}},X=((Z=t==null?void 0:t.siteEntries)==null?void 0:Z.length)||(t==null?void 0:t.entries)||0,Q=Object.values(_).filter(q=>q.status==="verified"||q.status==="rejected").length,ne=X>0?Math.round(Q/X*100):0,te={verificationStatus:X>0&&Q===X?"complete":"in-progress",verifiedAt:new Date().toISOString(),verifiedBy:(a==null?void 0:a.username)||(a==null?void 0:a.fullName)||(a==null?void 0:a.email)||"System",completionPercentage:ne,siteVerification:Object.entries(_).reduce((q,[U,re])=>({...q,[U]:{verified:re.status==="verified",verifiedAt:new Date().toISOString(),verifiedBy:(a==null?void 0:a.username)||(a==null?void 0:a.fullName)||(a==null?void 0:a.email)||"System",notes:re.notes}}),{})};if(b&&S==="verified"){const q=(oe=t.siteEntries)==null?void 0:oe.find(U=>U.id===u);if(q){const U={...b,siteEntries:[...b.siteEntries||[],{...q,status:"verified",verifiedBy:(a==null?void 0:a.username)||(a==null?void 0:a.fullName)||(a==null?void 0:a.email)||"System",verifiedAt:new Date().toISOString()}],entries:(b.entries||0)+1,processedEntries:(b.processedEntries||0)+1};G(U)}}return C==null||C(te),_}),D({title:`Site ${S==="verified"?"Verified":"Rejected"}`,description:`Site has been ${S==="verified"?"verified":"rejected"} successfully.`})};if(!t)return e.jsx("div",{children:"No MMP file data available"});const T=t.siteEntries||[],I=T.length||t.entries||0;return I===0?e.jsx(W,{children:e.jsx(J,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col items-center justify-center text-center p-6",children:[e.jsx(it,{className:"h-12 w-12 text-muted-foreground mb-3"}),e.jsx("h3",{className:"text-lg font-medium",children:"No Sites Available"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"This MMP file does not have any sites to verify."})]})})}):(Object.values(h).filter(u=>u.status==="verified"||u.status==="rejected").length,e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-sm font-medium",children:"Verification Progress"}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("span",{className:"text-sm",children:[j,"%"]})})]}),e.jsx(Ae,{value:j,className:"h-2"})]}),e.jsxs(ot,{defaultValue:"sites",className:"w-full",children:[e.jsxs(ft,{children:[e.jsxs(Be,{value:"sites",children:["Sites (",I,")"]}),e.jsx(Be,{value:"distribution",children:"Distribution Details"})]}),e.jsx(Re,{value:"sites",className:"mt-6",children:e.jsx("div",{className:"space-y-4",children:T.map(u=>e.jsx(Dt,{site:u,onVerify:p,verificationStatus:h},u.id))})}),e.jsx(Re,{value:"distribution",className:"mt-6",children:e.jsx(W,{children:e.jsxs(J,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Distribution Information"}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium",children:["Total Sites: ",I]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Number of sites included in this MMP"})]}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium",children:["Verified Sites: ",Object.values(h).filter(u=>u.status==="verified").length]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Sites that have been verified"})]}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium",children:["Rejected Sites: ",Object.values(h).filter(u=>u.status==="rejected").length]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Sites that have been rejected"})]})]})]})})})]})]}))},$t=({onUploadSuccess:t,bucket:C="uploads",onFileSelected:h,pathPrefix:R})=>{const[j,M]=w.useState(null),[D,a]=w.useState(!1),{toast:r}=le(),z=p=>{if(p.target.files&&p.target.files[0]){const T=p.target.files[0];M(T),h&&h(T)}},G=async()=>{if(!j){r({title:"Error",description:"Please select a file to upload",variant:"destructive"});return}a(!0);try{const p=j.name.split(".").pop(),T=`${Date.now()}_${Math.random().toString(36).substring(2,9)}.${p}`,I=R?R.replace(/^\/+|\/+$/g,"").replace(/^\/+|\/+$/g,""):"",u=I?`${I}/${T}`:T,{data:S,error:H}=await L.storage.from(C).upload(u,j);if(H)throw new Error(H.message||"Unable to upload file.");const E=L.storage.from(C).getPublicUrl(u).data.publicUrl;r({title:"Upload Successful",description:`File ${j.name} uploaded successfully`}),t&&E&&t(E,j.name),M(null);const b=document.getElementById("file-input");b&&(b.value="")}catch(p){r({title:"Upload Failed",description:p.message||"An error occurred during upload",variant:"destructive"})}finally{a(!1)}};return e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ht,{id:"file-input",type:"file",onChange:z,className:"flex-grow",disabled:D}),e.jsx(B,{onClick:G,disabled:!j||D,className:"flex items-center gap-2",children:D?"Uploading...":e.jsxs(e.Fragment,{children:[e.jsx(me,{className:"h-4 w-4"}),"Upload"]})})]})};function ze({date:t,onSelect:C,className:h}){return e.jsx("div",{className:Se("grid gap-2",h),children:e.jsxs(ut,{children:[e.jsx(mt,{asChild:!0,children:e.jsxs(B,{id:"date",variant:"outline",className:Se("w-full justify-start text-left font-normal",!t&&"text-muted-foreground"),children:[e.jsx(ve,{className:"mr-2 h-4 w-4"}),t?be(t,"PPP"):e.jsx("span",{children:"Pick a date"})]})}),e.jsx(jt,{className:"w-auto p-0",align:"start",children:e.jsx(xt,{mode:"single",selected:t,onSelect:C,initialFocus:!0,className:"pointer-events-auto"})})]})})}const At=[{id:"federal",name:"Federal Permit",description:"National level authorization",icon:nt},{id:"state",name:"State Permit",description:"State level authorization",icon:rt},{id:"local",name:"Local Permit",description:"Local municipality authorization",icon:qe}],Et=({onUploadSuccess:t,bucket:C="mmp-files",pathPrefix:h})=>{const[R,j]=w.useState(!1),[M,D]=w.useState(),[a,r]=w.useState(),[z,G]=w.useState(""),[p,T]=w.useState("federal"),[I,u]=w.useState(""),[S,H]=w.useState(""),{toast:E}=le(),b=(N,P)=>{const _=new Date,X=be(_,"yyyyMMdd-HHmmss"),Q=p==="federal"?"FED":p==="state"?"STATE":"LOCAL",ne=p==="state"&&I?`-${I}`:"",de=p==="local"&&S?`-${S}`:"",te=`${Q}${ne}${de}-${X}`,Z={id:te,fileName:P,fileUrl:N,uploadedAt:_.toISOString(),validated:!1,issueDate:M==null?void 0:M.toISOString(),expiryDate:a==null?void 0:a.toISOString(),comments:z.trim()||void 0,permitType:p,...p==="state"&&{state:I.trim()},...p==="local"&&{locality:S.trim()}};t(Z),D(void 0),r(void 0),G(""),u(""),H(""),E({title:"File Uploaded",description:`Successfully uploaded ${P} with ID: ${te}`})};return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(F,{children:"Permit Type"}),e.jsx(gt,{value:p,onValueChange:N=>T(N),className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:At.map(N=>{const P=N.icon;return e.jsx(F,{className:Se("cursor-pointer","transition-all hover:scale-105"),htmlFor:N.id,children:e.jsxs(W,{className:Se("relative p-4 h-full","hover:border-primary",p===N.id&&"border-primary bg-primary/5"),children:[e.jsx(Nt,{value:N.id,id:N.id,className:"sr-only"}),e.jsxs("div",{className:"flex flex-col items-center text-center space-y-2 md:space-y-4",children:[e.jsx(P,{className:"h-8 w-8 md:h-12 md:w-12"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:N.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:N.description})]})]})]})},N.id)})})]}),p==="state"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(F,{children:"State"}),e.jsxs(Ye,{value:I,onValueChange:u,children:[e.jsx(Je,{children:e.jsx(Qe,{placeholder:"Select a state"})}),e.jsx(Ze,{children:ee.map(N=>e.jsx(Ue,{value:N.id,children:N.name},N.id))})]})]}),p==="local"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(F,{children:"Locality/Municipality"}),e.jsx("input",{type:"text",value:S,onChange:N=>H(N.target.value),placeholder:"Enter locality or municipality name",className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(F,{children:"Issue Date"}),e.jsx(ze,{date:M,onSelect:D})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(F,{children:"Expiry Date"}),e.jsx(ze,{date:a,onSelect:r})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(F,{children:"Comments"}),e.jsx(Ee,{placeholder:"Add any comments about this permit...",value:z,onChange:N=>G(N.target.value)})]}),e.jsx($t,{bucket:C,pathPrefix:[h,p,p==="state"&&I?I:void 0,p==="local"&&S?S:void 0].filter(Boolean).join("/"),onUploadSuccess:(N,P)=>b(N,P)})]})})},He=({permit:t,onVerify:C,onDelete:h})=>{const[R,j]=ce.useState(!1),[M,D]=ce.useState(!1),[a,r]=ce.useState(),[z,G]=ce.useState(""),[p,T]=ce.useState(!1),{toast:I}=le(),u=b=>{r(b),j(!0)},S=()=>{a&&(C(t.id,a,z),j(!1),G(""),I({title:`Permit ${a==="verified"?"Verified":"Rejected"}`,description:`The permit has been ${a==="verified"?"verified":"rejected"} successfully.`}))},H=()=>{switch(t.status){case"verified":return e.jsxs(Y,{variant:"success",className:"flex items-center gap-2 px-3 py-1",children:[e.jsx(ie,{className:"h-4 w-4"}),"Verified"]});case"rejected":return e.jsxs(Y,{variant:"destructive",className:"flex items-center gap-2 px-3 py-1",children:[e.jsx(ae,{className:"h-4 w-4"}),"Rejected"]});default:return e.jsxs(Y,{variant:"outline",className:"flex items-center gap-2 px-3 py-1",children:[e.jsx(je,{className:"h-4 w-4"}),"Pending"]})}},E=()=>{if(t.fileUrl)return t.fileUrl.startsWith("http://")||t.fileUrl.startsWith("https://")?t.fileUrl:`${window.location.origin}${t.fileUrl.startsWith("/")?"":"/"}${t.fileUrl}`};return e.jsx(W,{className:"transition-all duration-200 hover:shadow-md",children:e.jsxs(J,{className:"p-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("h3",{className:"text-lg font-semibold tracking-tight",children:t.fileName}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(Y,{variant:"outline",className:"capitalize",children:t.permitType}),t.state&&e.jsx(Y,{variant:"outline",className:"capitalize",children:vt(t.state)})]})]}),H()]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 pt-2",children:[t.issueDate&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(ve,{className:"h-4 w-4"}),e.jsxs("span",{children:["Issued: ",be(new Date(t.issueDate),"MMMM d, yyyy")]})]}),t.expiryDate&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(ve,{className:"h-4 w-4"}),e.jsxs("span",{children:["Expires: ",be(new Date(t.expiryDate),"MMMM d, yyyy")]})]})]}),t.comments&&e.jsxs("div",{className:"flex items-start gap-2 text-sm text-muted-foreground pt-2",children:[e.jsx(Ge,{className:"h-4 w-4 mt-1"}),e.jsx("p",{children:t.comments})]}),t.status&&e.jsxs("div",{className:`mt-2 text-sm rounded-md p-3 ${t.status==="rejected"?"bg-destructive/10 text-destructive":"bg-green-50 text-green-700"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t.status==="rejected"?e.jsx(ae,{className:"h-4 w-4"}):e.jsx(ie,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium capitalize",children:t.status})]}),t.verificationNotes?e.jsx("p",{className:"pl-6",children:t.verificationNotes}):t.status==="rejected"&&e.jsx("p",{className:"pl-6 italic",children:"No reason provided"})]}),!1,e.jsxs("div",{className:"flex items-center justify-between pt-4",children:[e.jsxs(B,{variant:"outline",size:"sm",onClick:()=>D(!0),className:"flex items-center gap-2",children:[e.jsx(We,{className:"h-4 w-4"}),"Preview Document"]}),e.jsxs("div",{className:"flex gap-2",children:[!t.status&&e.jsxs(e.Fragment,{children:[e.jsxs(B,{variant:"outline",size:"sm",onClick:()=>u("verified"),className:"flex items-center gap-2",children:[e.jsx(ie,{className:"h-4 w-4"}),"Verify"]}),e.jsxs(B,{variant:"outline",size:"sm",onClick:()=>u("rejected"),className:"flex items-center gap-2 border-destructive/50 hover:bg-destructive/10",children:[e.jsx(ae,{className:"h-4 w-4 text-destructive"}),"Reject"]})]}),e.jsxs(B,{variant:"outline",size:"sm",onClick:()=>T(!0),className:"flex items-center gap-2 border-destructive/50 hover:bg-destructive/10",children:[e.jsx(Le,{className:"h-4 w-4 text-destructive"}),"Delete"]})]})]}),!t.status&&e.jsxs("div",{className:"pt-2",children:[e.jsx(Ae,{value:0,className:"h-1"}),e.jsx("p",{className:"text-xs text-muted-foreground text-center pt-1",children:"Pending verification"})]})]}),e.jsx(ge,{open:R,onOpenChange:j,children:e.jsxs(Ne,{children:[e.jsx(ye,{children:e.jsx(pe,{children:a==="verified"?"Verify Permit":"Reject Permit"})}),e.jsxs("div",{className:"py-4",children:[e.jsx("label",{className:"text-sm font-medium",children:"Verification Notes"}),e.jsx(Ee,{placeholder:"Add any notes about this verification...",value:z,onChange:b=>G(b.target.value),className:"mt-2"})]}),e.jsxs(we,{children:[e.jsx(B,{variant:"outline",onClick:()=>j(!1),children:"Cancel"}),e.jsx(B,{onClick:S,variant:a==="verified"?"default":"destructive",className:"flex items-center gap-2",children:a==="verified"?e.jsxs(e.Fragment,{children:[e.jsx(ie,{className:"h-4 w-4"}),"Verify Permit"]}):e.jsxs(e.Fragment,{children:[e.jsx(ae,{className:"h-4 w-4"}),"Reject Permit"]})})]})]})}),e.jsx(yt,{fileUrl:E(),fileName:t.fileName,open:M,onOpenChange:D}),e.jsx(ge,{open:p,onOpenChange:T,children:e.jsxs(Ne,{children:[e.jsx(ye,{children:e.jsx(pe,{children:"Delete Permit"})}),e.jsxs("div",{className:"py-2 text-sm text-muted-foreground",children:['Are you sure you want to delete "',t.fileName,'"? This will remove the file from storage and from this MMP. This action cannot be undone.']}),e.jsxs(we,{children:[e.jsx(B,{variant:"outline",onClick:()=>T(!1),children:"Cancel"}),e.jsxs(B,{variant:"destructive",className:"flex items-center gap-2",onClick:()=>{h(t.id),T(!1)},children:[e.jsx(Le,{className:"h-4 w-4"}),"Delete Permit"]})]})]})})]})})},Jt=({mmpFile:t,onVerificationComplete:C})=>{var Oe;const[h,R]=w.useState([]),[j,M]=w.useState([]),{toast:D}=le(),{updateMMP:a}=Xe(),{currentUser:r}=$e(),[z,G]=w.useState(!1),[p,T]=w.useState(!1),[I,u]=w.useState(!1),[S,H]=w.useState({}),[E,b]=w.useState({}),[N,P]=w.useState({}),[_,X]=w.useState({}),[Q,ne]=w.useState({}),{users:de}=$e(),te=wt();w.useEffect(()=>{let s=!1;const n=i=>{if(!i)return[];if(Array.isArray(i))return i;if(typeof i=="object"){if("documents"in i&&Array.isArray(i.documents))return i.documents;const v=(i.statePermits||[]).flatMap(l=>(l.documents||[]).map(d=>({...d,permitType:"state",state:(d==null?void 0:d.state)||(l==null?void 0:l.stateName)}))),m=(i.localPermits||[]).flatMap(l=>(l.documents||[]).map(d=>({...d,permitType:"local",locality:(d==null?void 0:d.locality)||(l==null?void 0:l.localityName)})));return[...v,...m]}return[]},c=async()=>{const i="mmp-files",v=(t==null?void 0:t.id)||(t==null?void 0:t.mmpId);if(!v)return[];const m=`permits/${v}`;try{const l=async A=>{const{data:$,error:y}=await L.storage.from(i).list(A,{limit:100,offset:0,sortBy:{column:"name",order:"asc"}});return y?[]:$||[]},d=(A,$,y,k)=>($||[]).filter(g=>g&&g.name&&g.metadata&&typeof g.metadata.size=="number").map(g=>{const K=`${A}/${g.name}`.replace(/\/+/g,"/"),Ce=L.storage.from(i).getPublicUrl(K).data.publicUrl;return{id:K,fileName:g.name,fileUrl:Ce,uploadedAt:g.created_at||new Date().toISOString(),validated:!1,permitType:y,...k!=null&&k.state?{state:k.state}:{},...k!=null&&k.locality?{locality:k.locality}:{}}}),V=await l(m),x=V==null?void 0:V.some(A=>!A.metadata&&["federal","state","local"].includes(A.name));let o=[];if(x){const $=(await l(`${m}/federal`)||[]).filter(O=>!!O.metadata);o=o.concat(d(`${m}/federal`,$,"federal"));const y=await l(`${m}/state`),k=(y||[]).filter(O=>!O.metadata);for(const O of k){const Me=(await l(`${m}/state/${O.name}`)||[]).filter(De=>!!De.metadata);o=o.concat(d(`${m}/state/${O.name}`,Me,"state",{state:O.name}))}const g=(y||[]).filter(O=>!!O.metadata);g!=null&&g.length&&(o=o.concat(d(`${m}/state`,g,"state")));const K=await l(`${m}/local`),Ce=(K||[]).filter(O=>!O.metadata);for(const O of Ce){const Me=(await l(`${m}/local/${O.name}`)||[]).filter(De=>!!De.metadata);o=o.concat(d(`${m}/local/${O.name}`,Me,"local",{locality:O.name}))}const fe=(K||[]).filter(O=>!!O.metadata);fe!=null&&fe.length&&(o=o.concat(d(`${m}/local`,fe,"local")))}else{const $=(await l(m)||[]).filter(y=>!!y.metadata);o=o.concat(d(m,$,"federal"))}return o}catch{return[]}};return(async()=>{const i=await c(),v=t==null?void 0:t.permits,m=n(v),l=(V,x)=>{const o=new Map,A=y=>(y.id||y.fileName||"").toString();V.forEach(y=>o.set(A(y),y));const $=[];return V.forEach(y=>{const k=A(y),g=x.find(K=>A(K)===k)||void 0;$.push({...y,status:(g==null?void 0:g.status)??y.status,verificationNotes:(g==null?void 0:g.verificationNotes)??y.verificationNotes,verifiedAt:(g==null?void 0:g.verifiedAt)??y.verifiedAt,verifiedBy:(g==null?void 0:g.verifiedBy)??y.verifiedBy,state:y.state??(g==null?void 0:g.state),locality:y.locality??(g==null?void 0:g.locality)})}),x.forEach(y=>{const k=A(y);o.has(k)||$.push(y)}),$};let d=[];i.length>0?d=l(i,m):d=m,s||(R(d.filter(V=>V.permitType==="federal"||V.permitType==="state")),M(d.filter(V=>V.permitType==="local")))})(),()=>{s=!0}},[t==null?void 0:t.id,t==null?void 0:t.mmpId,t==null?void 0:t.permits]);const Z=async s=>{try{const n=j.find(c=>c.id===s)||h.find(c=>c.id===s);if(!n){D({title:"Permit not found",description:"Could not locate the selected permit.",variant:"destructive"});return}try{const c="mmp-files",f=typeof n.id=="string"&&n.id.includes("/")?n.id:"";if(f){const{error:i}=await L.storage.from(c).remove([f])}}catch{}if(n.permitType==="local"){const c=j.filter(f=>f.id!==s);M(c),q(h,c)}else{const c=h.filter(f=>f.id!==s);R(c),q(c,j)}D({title:"Permit deleted",description:`${n.fileName} was removed.`})}catch{D({title:"Delete failed",description:"Could not delete the permit. Please try again.",variant:"destructive"})}},oe=async(s,n)=>{try{const c=(t==null?void 0:t.id)||(t==null?void 0:t.mmpId);if(!c)return;const{data:f}=await L.from("profiles").select("id, role").in("role",["admin","ict"]),i=(f||[]).map(v=>({user_id:v.id,title:n==="verified"?"Permit accepted":"Permit rejected",message:`${(t==null?void 0:t.name)||"MMP"} • ${s.fileName} ${n}. ${s.state?`State: ${s.state}. `:""}${s.locality?`Locality: ${s.locality}. `:""}${s.verificationNotes?`Reason: ${s.verificationNotes}`:""}`.trim(),type:n==="verified"?"success":"warning",link:`/mmp/${c}/verification`,related_entity_id:c,related_entity_type:"mmpFile"}));i.length&&await L.from("notifications").insert(i)}catch{}},q=(s,n=[])=>{const c=new Date().toISOString(),f=[...s,...n],i={federal:s.some(v=>v.permitType==="federal"),state:s.some(v=>v.permitType==="state"),local:n.some(v=>v.permitType==="local"),lastVerified:f.some(v=>v.status)?c:void 0,verifiedBy:(r==null?void 0:r.username)||(r==null?void 0:r.fullName)||(r==null?void 0:r.email)||void 0,documents:f};t!=null&&t.id&&a(t.id,{permits:i}),C?(C(i),(async()=>{if(!(t!=null&&t.id))return;let v=0,m=500;for(;v<3;){try{const{error:l}=await L.from("mmp_files").update({permits:i,updated_at:new Date().toISOString()}).eq("id",t.id);if(!l)return}catch{}await new Promise(l=>setTimeout(l,m)),m*=2,v++}D({title:"Sync delayed",description:"Could not sync permit changes to server. They remain locally and will retry shortly.",variant:"destructive"})})()):t!=null&&t.id&&a(t.id,{permits:i})},U=s=>{if(s.permitType==="local"){const n=[...j,s];M(n),q(h,n)}else{const n=[...h,s];R(n),q(n,j)}D({title:"Permit Uploaded",description:`${s.fileName} has been uploaded successfully.`}),(async()=>{try{const n=(t==null?void 0:t.id)||(t==null?void 0:t.mmpId);if(!n)return;const{data:c}=await L.from("profiles").select("id, role, hub_id").in("role",["fom","supervisor"]),f=(c||[]).map(o=>({user_id:o.id,title:"Permit uploaded",message:`${(t==null?void 0:t.name)||"MMP"} has a new permit uploaded`,type:"info",link:`/mmp/${n}`,related_entity_id:n,related_entity_type:"mmpFile"}));f.length&&await L.from("notifications").insert(f);let i=Array.isArray(t==null?void 0:t.siteEntries)&&t.siteEntries.length>0?t.siteEntries:[];if(!i.length&&(t!=null&&t.id)){const{data:o}=await L.from("mmp_site_entries").select("state, locality").eq("mmp_file_id",t.id);i=o||[]}if(!i.length)return;const v=new Map;for(const o of ee)v.set(o.name.toLowerCase(),o.id);const m=new Map;for(const o of ee){const A=new Map;o.localities.forEach($=>A.set($.name.toLowerCase(),$.id)),m.set(o.id,A)}const l=new Set;if(i.forEach(o=>{const A=String(o.state||"").trim().toLowerCase(),$=v.get(A);if(!$)return;const y=String(o.locality||"").trim().toLowerCase(),k=m.get($),g=y&&k&&k.get(y)||"";l.add(`${$}|${g}`)}),l.size===0)return;const d=Array.from(new Set(Array.from(l).map(o=>o.split("|")[0]))),{data:V}=await L.from("profiles").select("id, state_id, locality_id, role").eq("role","coordinator").in("state_id",d),x=(V||[]).filter(o=>{const A=`${o.state_id}|${o.locality_id||""}`,$=`${o.state_id}|`;return l.has(A)||l.has($)}).map(o=>({user_id:o.id,title:"Sites shared for CP review",message:`${(t==null?void 0:t.name)||"MMP"} sites have been shared for your review`,type:"info",link:`/mmp/${n}`,related_entity_id:n,related_entity_type:"mmpFile"}));x.length&&await L.from("notifications").insert(x)}catch{}})()},re=(s,n,c)=>{let f;const i=j.findIndex(l=>l.id===s);let v=j,m=h;i!==-1?(v=j.map(l=>{if(l.id===s){const d={...l,status:n,verificationNotes:c,verifiedAt:new Date().toISOString(),verifiedBy:(r==null?void 0:r.username)||(r==null?void 0:r.fullName)||(r==null?void 0:r.email)||"System"};return f=d,d}return l}),M(v),q(h,v)):(m=h.map(l=>{if(l.id===s){const d={...l,status:n,verificationNotes:c,verifiedAt:new Date().toISOString(),verifiedBy:(r==null?void 0:r.username)||(r==null?void 0:r.fullName)||(r==null?void 0:r.email)||"System"};return f=d,d}return l}),R(m),q(m,j)),(async()=>{try{f!=null&&f.id?await L.from("mmp_site_entries").update({status:"Approved"}).eq("id",f.id):f!=null&&f.siteCode&&await L.from("mmp_site_entries").update({status:"Approved"}).eq("site_code",f.siteCode).eq("mmp_file_id",(t==null?void 0:t.id)||(t==null?void 0:t.mmpId))}catch{}})(),f&&(async()=>await oe(f,n))(),t!=null&&t.id&&a(t.id,{status:"approved",workflow:{...t.workflow||{},currentStage:"permitsVerified"}})},Ke=async s=>{var n,c;P(f=>({...f,[s]:!0}));try{const f=(t==null?void 0:t.id)||(t==null?void 0:t.mmpId),i=S[s],v=Array.from(E[s]||[]);if(!i||v.length===0){D({title:"Select sites and coordinator",description:"Please select at least one site and a coordinator.",variant:"destructive"}),P(d=>({...d,[s]:!1}));return}const l=(((n=se[s])==null?void 0:n.filter(d=>v.includes(d.id)))||[]).map(async d=>{const V=d.additional_data||{},{data:x,error:o}=await L.from("mmp_site_entries").update({status:"Dispatched",dispatched_by:(r==null?void 0:r.id)||null,dispatched_at:new Date().toISOString(),additional_data:{...V,assigned_to:i,assigned_by:(r==null?void 0:r.id)||null,assigned_at:new Date().toISOString(),notes:`Forwarded from MMP ${(t==null?void 0:t.name)||(t==null?void 0:t.mmpId)} for CP verification`}}).eq("id",d.id).select().single();if(o)throw o;return x});await Promise.all(l),await L.from("notifications").insert([{user_id:i,title:"Sites forwarded for CP verification",message:`${(t==null?void 0:t.name)||"MMP"}: ${v.length} site(s) have been forwarded for your CP review`,type:"info",link:"/coordinator/sites",related_entity_id:f,related_entity_type:"mmpFile"}]),D({title:"Batch Forwarded",description:`Sites were forwarded to ${((c=Pe.find(d=>d.id===i))==null?void 0:c.fullName)||"Coordinator"}.`,variant:"default"}),P(d=>({...d,[s]:!1})),X(d=>({...d,[s]:!0})),b(d=>({...d,[s]:new Set}))}catch{D({title:"Forwarding failed",description:"Could not forward to coordinator. Please try again.",variant:"destructive"}),P(i=>({...i,[s]:!1}))}},Ie=(()=>{const s=[...h,...j];if(s.length===0)return 0;const n=s.filter(c=>c.status==="verified"||c.status==="rejected").length;return Math.round(n/s.length*100)})(),Te=((Oe=t==null?void 0:t.siteEntries)==null?void 0:Oe.length)||(t==null?void 0:t.entries)||0,Ve=[...h,...j],Fe=Ve.length>0&&Ve.every(s=>s.status==="verified");let et=Array.isArray(t==null?void 0:t.siteEntries)&&t.siteEntries.length>0?t.siteEntries:[];const _e=new Map;for(const s of ee)_e.set(s.name.toLowerCase(),s.id);const ke=new Map;for(const s of ee){const n=new Map;s.localities.forEach(c=>n.set(c.name.toLowerCase(),c.id)),ke.set(s.id,n)}const se={};et.forEach(s=>{const n=String(s.state||"").trim().toLowerCase(),c=_e.get(n);if(!c)return;const f=String(s.locality||"").trim().toLowerCase(),i=ke.get(c),v=f&&i&&i.get(f)||"",m=`${c}|${v}`;se[m]||(se[m]=[]),se[m].push(s)});const Pe=de.filter(s=>s.role==="coordinator");function tt(s,n){return Pe.find(c=>c.stateId===s&&(c.localityId===n||!n))}return e.jsxs("div",{className:"space-y-8",children:[e.jsxs(W,{className:"border-dashed",children:[e.jsxs(he,{children:[e.jsxs(xe,{className:"flex items-center gap-2",children:[e.jsx(me,{className:"h-5 w-5"}),"Upload New Permit"]}),e.jsxs(ue,{children:["Add a new permit document for verification",Te>0&&e.jsxs("span",{className:"ml-1 text-xs font-medium text-blue-600",children:["• MMP contains ",Te," sites"]})]})]}),e.jsx(J,{children:e.jsx(Et,{onUploadSuccess:U,bucket:"mmp-files",pathPrefix:`permits/${(t==null?void 0:t.id)||(t==null?void 0:t.mmpId)||"unknown"}`})})]}),e.jsxs(W,{children:[e.jsxs(he,{children:[e.jsxs(xe,{className:"flex items-center gap-2",children:[e.jsx(je,{className:"h-5 w-5"}),"Federal & State Permits"]}),e.jsx(ue,{children:"Track and manage federal and state permit verifications"})]}),e.jsx(J,{children:e.jsx("div",{className:"space-y-4",children:h.length>0?h.map(s=>e.jsx(He,{permit:s,onVerify:re,onDelete:Z},s.id)):e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(me,{className:"h-8 w-8 mx-auto mb-2 opacity-20"}),e.jsx("p",{className:"text-sm font-medium mb-1",children:"No federal/state permits uploaded yet"}),e.jsx("p",{className:"text-xs",children:"Upload federal or state permits to begin verification"})]})})})]}),e.jsxs(W,{children:[e.jsxs(he,{children:[e.jsxs(xe,{className:"flex items-center gap-2",children:[e.jsx(je,{className:"h-5 w-5"}),"Local Permits"]}),e.jsx(ue,{children:"Track and manage local permit verifications"})]}),e.jsx(J,{children:e.jsx("div",{className:"space-y-4",children:j.length>0?j.map(s=>e.jsx(He,{permit:s,onVerify:re,onDelete:Z},s.id)):e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(me,{className:"h-8 w-8 mx-auto mb-2 opacity-20"}),e.jsx("p",{className:"text-sm font-medium mb-1",children:"No local permits uploaded yet"}),e.jsx("p",{className:"text-xs",children:"Upload local permits to begin verification"})]})})})]}),e.jsxs(W,{children:[e.jsxs(he,{children:[e.jsxs(xe,{className:"flex items-center gap-2",children:[e.jsx(je,{className:"h-5 w-5"}),"Overall Verification Progress"]}),e.jsx(ue,{children:"Combined progress for all permit types"})]}),e.jsxs(J,{children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Overall Progress"}),e.jsxs("span",{className:"text-sm font-medium",children:[Ie,"%"]})]}),e.jsx(Ae,{value:Ie,className:"h-2"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-medium text-blue-600",children:h.filter(s=>s.permitType==="federal").length}),e.jsx("div",{className:"text-muted-foreground",children:"Federal"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-medium text-green-600",children:h.filter(s=>s.permitType==="state").length}),e.jsx("div",{className:"text-muted-foreground",children:"State"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-medium text-purple-600",children:j.length}),e.jsx("div",{className:"text-muted-foreground",children:"Local"})]})]}),e.jsx("div",{className:"mt-6 flex justify-end",children:Fe&&!p?e.jsxs(B,{onClick:()=>te(`/mmp/${t.id}`),disabled:z,children:[e.jsx(We,{className:"h-4 w-4 mr-2"}),"Review MMP"]}):null})]})]}),e.jsx(ge,{open:I,onOpenChange:u,children:e.jsxs(Ne,{className:"max-w-2xl max-h-[90vh] flex flex-col",children:[e.jsx(ye,{children:e.jsx(pe,{children:"Review & Assign Coordinators"})}),e.jsx("div",{className:"space-y-6 overflow-y-auto flex-1 pr-2",style:{maxHeight:"60vh"},children:Object.entries(se).length===0?e.jsx("div",{className:"text-center text-muted-foreground",children:"No site groups found."}):Object.entries(se).map(([s,n])=>{var m,l,d,V;const[c,f]=s.split("|"),i=tt(c,f),v=S[s]||(i==null?void 0:i.id)||"";return E[s]||b(x=>({...x,[s]:new Set(n.map(o=>o.id))})),e.jsxs("div",{className:"border rounded p-3 bg-white",children:[e.jsxs("div",{className:"flex items-center mb-2 font-medium cursor-pointer select-none",onClick:()=>ne(x=>({...x,[s]:!x[s]})),children:[Q[s]?e.jsx(ct,{className:"w-4 h-4 mr-1"}):e.jsx(lt,{className:"w-4 h-4 mr-1"}),n.length," site(s) in ",e.jsx("span",{className:"text-blue-700 ml-1",children:((m=ee.find(x=>x.id===c))==null?void 0:m.name)||c}),f&&e.jsxs("span",{children:[" / ",e.jsx("span",{className:"text-green-700",children:((d=(l=ee.find(x=>x.id===c))==null?void 0:l.localities.find(x=>x.id===f))==null?void 0:d.name)||f})]})]}),e.jsxs("div",{className:"mb-2 text-sm text-muted-foreground",children:["Recommended: ",i?`${i.fullName||i.name||i.email}`:"None"]}),e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsxs(Ye,{value:v,onValueChange:x=>H(o=>({...o,[s]:x})),children:[e.jsx(Je,{className:"max-w-md",children:e.jsx(Qe,{placeholder:"Select coordinator..."})}),e.jsx(Ze,{children:Pe.map(x=>e.jsxs(Ue,{value:x.id,children:[x.fullName||x.name||x.email,(i==null?void 0:i.id)===x.id?" (Recommended)":""]},x.id))})]}),e.jsx(B,{size:"sm",onClick:()=>Ke(s),disabled:N[s]||_[s]||!S[s]||!(((V=E[s])==null?void 0:V.size)>0),variant:_[s]?"secondary":"default",className:"ml-2",children:_[s]?"Forwarded":N[s]?"Forwarding...":"Forward Selected"})]}),Q[s]&&e.jsxs("div",{className:"mt-3 mb-2",children:[e.jsx("div",{className:"font-medium text-xs mb-1",children:"Select sites to forward:"}),e.jsx("div",{className:"max-h-40 overflow-y-auto border rounded p-2 bg-gray-50",children:e.jsx("div",{className:"space-y-2",children:n.map(x=>{var o;return e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer hover:bg-white p-1 rounded",children:[e.jsx(pt,{checked:((o=E[s])==null?void 0:o.has(x.id))||!1,onCheckedChange:A=>{b($=>{const y=new Set($[s]||[]);return A?y.add(x.id):y.delete(x.id),{...$,[s]:y}})}}),e.jsx("span",{className:"text-sm",children:x.siteName||x.name||x.id})]},x.id)})})})]})]},s)})}),e.jsx(we,{children:e.jsx(B,{variant:"outline",onClick:()=>u(!1),disabled:z,children:"Close"})})]})})]})};export{Jt as M,Yt as a};
