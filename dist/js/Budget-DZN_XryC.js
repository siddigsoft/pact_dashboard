import{r as h,j as e,b5 as ve,o as te,Y as P,t as ge,a4 as q,b9 as he,T as be,I as je,al as me,Z as ye,W as we,ba as xe}from"./react-core-B8kFjp2k.js";import{_ as fe,D as ie,$ as Ce,l as oe,m as ce,n as de,I as L,C as f,f as T,g as F,B as C,b as N,e as _e,u as Se,a as G,L as Be,M as De,N as Te,O as re,T as Fe,i as Pe,j as V,k as U}from"./index-PwDgWEVM.js";import{G as K}from"./gradient-stat-card-CWH4umO5.js";import{T as Me,a as ke,b as le,c as H,d as Ae,e as z}from"./table-CZ8ZB6wW.js";import{P as pe}from"./progress-vMwTbqUI.js";import{L as D}from"./label-C4lDws8j.js";import{S as Re,a as $e,b as ze,c as Oe,d as X}from"./select-CXX5Q_V1.js";import{T as Ee}from"./textarea-BpQMf5eL.js";import{o as W}from"./date-utils-YarVESQS.js";import{E as Ie,a as ee}from"./jspdf-rld7HkB6.js";import{u as y,a as Ye}from"./xlsx-CBxwqXDA.js";import"./vendor-VlxgVHMv.js";import"./docs-D2Yi4cpO.js";import"./react-dom-BLwj5vIO.js";import"./router-CKy9yO3R.js";import"./query-CJ0Bt4ph.js";import"./supabase-CwPDIVMD.js";import"./forms-CESK2FDA.js";import"./radix-ui-C2DV4xtt.js";import"./radix-dialogs-CnlmQBMC.js";import"./radix-menus-CPezQVZk.js";function ue({projectId:t,projectName:g,onSuccess:r}){const{createProjectBudget:n}=fe(),[i,s]=h.useState(!1),[u,l]=h.useState(!1),[x,b]=h.useState(""),[m,v]=h.useState("annual"),[j,_]=h.useState(new Date().getFullYear().toString()),[J,Q]=h.useState(""),[M,S]=h.useState(""),[O,E]=h.useState(""),[k,A]=h.useState(""),I=async()=>{if(!(!x||parseFloat(x)<=0)){l(!0);try{const d=Math.round(parseFloat(x)*100),$={transportation_and_visit_fees:M?Math.round(parseFloat(M)*100):0,permit_fee:O?Math.round(parseFloat(O)*100):0,internet_and_communication_fees:k?Math.round(parseFloat(k)*100):0},ae=m==="annual"?`${j}-01-01`:m==="monthly"?new Date().toISOString().split("T")[0]:void 0,Z=m==="annual"?`${j}-12-31`:m==="monthly"?new Date(new Date().setMonth(new Date().getMonth()+1)).toISOString().split("T")[0]:void 0,a=await n({projectId:t,totalBudgetCents:d,budgetPeriod:m,periodStartDate:ae,periodEndDate:Z,categoryAllocations:$,fiscalYear:parseInt(j),budgetNotes:J});a&&(s(!1),se(),r==null||r(a))}finally{l(!1)}}},se=()=>{b(""),v("annual"),_(new Date().getFullYear().toString()),Q(""),S(""),E(""),A("")},R=[M,O,k].reduce((d,$)=>d+(parseFloat($)||0),0);return e.jsxs(ie,{open:i,onOpenChange:s,children:[e.jsx(Ce,{asChild:!0,children:e.jsxs("button",{type:"button",className:"px-4 py-2 rounded-md bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white border border-blue-400/50 shadow-[0_0_15px_rgba(59,130,246,0.3)] focus:outline-none focus:ring-2 focus:ring-blue-400/70 focus:ring-offset-2 focus:ring-offset-slate-950 transition inline-flex items-center","data-testid":"button-create-project-budget",children:[e.jsx(ve,{className:"w-4 h-4 mr-2"}),"Create Budget"]})}),e.jsxs(oe,{className:"max-w-2xl max-h-[90vh] overflow-y-auto bg-gradient-to-br from-slate-900 via-blue-950 to-purple-950 border-blue-500/30 shadow-[0_0_50px_rgba(59,130,246,0.3)]",children:[e.jsx(ce,{children:e.jsxs(de,{className:"text-cyan-100",children:["Create Project Budget: ",g]})}),e.jsxs("div",{className:"grid gap-4 cyber-dialog-form",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(D,{htmlFor:"total-budget",children:"Total Budget (SDG)"}),e.jsx(L,{id:"total-budget",type:"number",min:"0",step:"0.01",value:x,onChange:d=>b(d.target.value),placeholder:"500000.00","data-testid":"input-total-budget"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(D,{htmlFor:"budget-period",children:"Budget Period"}),e.jsxs(Re,{value:m,onValueChange:d=>v(d),children:[e.jsx($e,{id:"budget-period","data-testid":"select-budget-period",children:e.jsx(ze,{})}),e.jsxs(Oe,{children:[e.jsx(X,{value:"monthly",children:"Monthly"}),e.jsx(X,{value:"quarterly",children:"Quarterly"}),e.jsx(X,{value:"annual",children:"Annual"}),e.jsx(X,{value:"project_lifetime",children:"Project Lifetime"})]})]})]})]}),(m==="annual"||m==="quarterly")&&e.jsxs("div",{className:"grid gap-2",children:[e.jsx(D,{htmlFor:"fiscal-year",children:"Fiscal Year"}),e.jsx(L,{id:"fiscal-year",type:"number",min:"2020",max:"2050",value:j,onChange:d=>_(d.target.value),"data-testid":"input-fiscal-year"})]}),e.jsxs("div",{className:"border-t border-cyan-500/20 pt-4",children:[e.jsx("h4",{className:"font-medium mb-3 text-cyan-100",children:"Category Allocations (Optional)"}),e.jsxs("div",{className:"grid gap-3",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(D,{htmlFor:"cat-transport-visit",children:"Transportation and Visit Fees (SDG)"}),e.jsx(L,{id:"cat-transport-visit",type:"number",min:"0",step:"0.01",value:M,onChange:d=>S(d.target.value),placeholder:"0.00","data-testid":"input-category-transport-visit"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(D,{htmlFor:"cat-permit-fee",children:"Permit Fee (SDG)"}),e.jsx(L,{id:"cat-permit-fee",type:"number",min:"0",step:"0.01",value:O,onChange:d=>E(d.target.value),placeholder:"0.00","data-testid":"input-category-permit-fee"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(D,{htmlFor:"cat-internet-comm",children:"Internet & Communication Fees (SDG)"}),e.jsx(L,{id:"cat-internet-comm",type:"number",min:"0",step:"0.01",value:k,onChange:d=>A(d.target.value),placeholder:"0.00","data-testid":"input-category-internet-comm"})]})]}),R>0&&e.jsxs("div",{className:"mt-3 p-3 bg-gradient-to-r from-cyan-900/20 to-blue-900/20 backdrop-blur-sm border border-cyan-500/30 rounded-md shadow-[0_0_15px_rgba(6,182,212,0.2)]",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium text-cyan-200",children:"Total Allocated:"}),e.jsxs("span",{className:"text-sm font-bold text-cyan-100",children:["SDG ",R.toLocaleString("en-SD",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),x&&R>parseFloat(x)&&e.jsxs("p",{className:"text-sm text-red-300 mt-1",children:["Category total exceeds budget by SDG ",(R-parseFloat(x)).toFixed(2)]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(D,{htmlFor:"notes",children:"Budget Notes"}),e.jsx(Ee,{id:"notes",value:J,onChange:d=>Q(d.target.value),placeholder:"Additional notes about this budget...",rows:3,"data-testid":"textarea-budget-notes"})]})]}),e.jsxs("div",{className:"flex gap-3 justify-end pt-4 border-t border-cyan-500/20",children:[e.jsx("button",{type:"button",onClick:()=>s(!1),disabled:u,className:"px-4 py-2 rounded-md bg-transparent border border-cyan-500/30 text-cyan-200 hover:bg-cyan-900/20 shadow-[0_0_12px_rgba(6,182,212,0.25)] focus:outline-none focus:ring-2 focus:ring-cyan-400/70 focus:ring-offset-2 focus:ring-offset-slate-950 transition disabled:opacity-50 disabled:cursor-not-allowed","data-testid":"button-cancel",children:"Cancel"}),e.jsx("button",{type:"button",onClick:I,disabled:!x||parseFloat(x)<=0||u,className:"px-4 py-2 rounded-md bg-gradient-to-r from-cyan-600 to-blue-600 hover:from-cyan-700 hover:to-blue-700 text-white border border-cyan-400/50 shadow-[0_0_18px_rgba(6,182,212,0.35)] focus:outline-none focus:ring-2 focus:ring-cyan-400/70 focus:ring-offset-2 focus:ring-offset-slate-950 transition disabled:opacity-60 disabled:cursor-not-allowed","data-testid":"button-submit",children:u?"Creating...":"Create Budget"})]})]})]})}const Ne={draft:"gray",submitted:"blue",approved:"green",active:"green",completed:"gray",exceeded:"red",closed:"gray"},p=t=>new Intl.NumberFormat("en-SD",{style:"currency",currency:"SDG",minimumFractionDigits:2}).format(t/100);function Le({budget:t,projectName:g,onClick:r}){const[n,i]=h.useState(!1),s=t.totalBudgetCents>0?t.spentBudgetCents/t.totalBudgetCents*100:0,u=Ne[t.status]||"default",l=t.spentBudgetCents>t.totalBudgetCents,x=s>=80&&s<100;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-500/20 via-purple-500/20 to-cyan-500/20 rounded-2xl blur-xl opacity-75 group-hover:opacity-100 transition-opacity"}),e.jsxs(f,{className:"relative bg-gradient-to-br from-slate-900/90 via-blue-900/80 to-purple-900/90 backdrop-blur-xl border border-blue-500/30 hover-elevate active-elevate-2 cursor-pointer transition-all shadow-[0_0_30px_rgba(59,130,246,0.2)]",onClick:()=>i(!0),"data-testid":`budget-card-${t.id}`,children:[e.jsx(T,{className:"pb-3",children:e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx(F,{className:"text-base line-clamp-1 text-cyan-100",children:g||`Budget ${t.budgetPeriod}`}),e.jsxs("p",{className:"text-sm text-cyan-300/60 mt-1",children:["FY ",t.fiscalYear," • ",t.budgetPeriod]})]}),e.jsx(C,{variant:u,className:"bg-gradient-to-r from-blue-600/90 to-purple-600/90 text-white border-blue-400/50 shadow-[0_0_10px_rgba(59,130,246,0.5)]",children:t.status})]})}),e.jsxs(N,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-baseline justify-between",children:[e.jsx("span",{className:"text-2xl font-bold bg-gradient-to-r from-cyan-300 to-blue-300 bg-clip-text text-transparent",children:p(t.remainingBudgetCents)}),e.jsxs("span",{className:"text-sm text-cyan-300/50",children:["of ",p(t.totalBudgetCents)]})]}),e.jsx("div",{className:"relative h-2 bg-slate-800/50 rounded-full overflow-hidden border border-blue-500/20",children:e.jsx("div",{className:`absolute inset-y-0 left-0 rounded-full ${l?"bg-gradient-to-r from-red-500 to-pink-500":x?"bg-gradient-to-r from-yellow-500 to-orange-500":"bg-gradient-to-r from-cyan-500 to-blue-500"} shadow-[0_0_10px_currentColor]`,style:{width:`${Math.min(s,100)}%`}})}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-cyan-300/70",children:[e.jsxs("span",{children:[s.toFixed(1),"% utilized"]}),e.jsxs("span",{children:["Spent: ",p(t.spentBudgetCents)]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 pt-2 border-t border-blue-500/20",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(te,{className:"w-4 h-4 text-cyan-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-cyan-300/50",children:"Allocated"}),e.jsx("p",{className:"text-sm font-semibold text-cyan-200",children:p(t.allocatedBudgetCents)})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[l?e.jsx(P,{className:"w-4 h-4 text-red-400"}):e.jsx(ge,{className:"w-4 h-4 text-green-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-cyan-300/50",children:"Status"}),e.jsx("p",{className:`text-sm font-semibold ${l?"text-red-300":"text-green-300"}`,children:l?"Over":"On Track"})]})]})]})]})]})]}),e.jsx(ie,{open:n,onOpenChange:i,children:e.jsxs(oe,{className:"max-w-2xl max-h-[90vh] overflow-y-auto bg-gradient-to-br from-slate-900 via-blue-950 to-purple-950 border-blue-500/30 shadow-[0_0_50px_rgba(59,130,246,0.3)]",children:[e.jsx(ce,{children:e.jsxs(de,{className:"flex items-center gap-2 text-cyan-100",children:[e.jsx(q,{className:"w-5 h-5 text-cyan-400"}),g||"Project Budget"," Details"]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(C,{variant:u,className:"text-sm",children:t.status}),l&&e.jsxs(C,{variant:"destructive",className:"gap-1",children:[e.jsx(P,{className:"w-3 h-3"}),"Over Budget"]}),x&&!l&&e.jsxs(C,{variant:"outline",className:"gap-1 border-yellow-500 text-yellow-700",children:[e.jsx(P,{className:"w-3 h-3"}),"Near Limit"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-4 bg-gradient-to-br from-blue-900/30 to-cyan-900/30 backdrop-blur-sm border border-blue-500/30 rounded-lg shadow-[0_0_15px_rgba(59,130,246,0.2)]",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(te,{className:"w-4 h-4 text-cyan-400"}),e.jsx("span",{className:"text-sm font-medium text-cyan-200",children:"Total Budget"})]}),e.jsx("p",{className:"text-2xl font-bold text-cyan-100",children:p(t.totalBudgetCents)})]}),e.jsxs("div",{className:"p-4 bg-gradient-to-br from-purple-900/30 to-blue-900/30 backdrop-blur-sm border border-purple-500/30 rounded-lg shadow-[0_0_15px_rgba(168,85,247,0.2)]",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(he,{className:"w-4 h-4 text-purple-400"}),e.jsx("span",{className:"text-sm font-medium text-purple-200",children:"Total Spent"})]}),e.jsx("p",{className:"text-2xl font-bold text-purple-100",children:p(t.spentBudgetCents)}),e.jsxs("p",{className:"text-xs text-purple-300/70 mt-1",children:[s.toFixed(1),"% of total"]})]}),e.jsxs("div",{className:"p-4 bg-gradient-to-br from-green-900/30 to-cyan-900/30 backdrop-blur-sm border border-green-500/30 rounded-lg shadow-[0_0_15px_rgba(34,197,94,0.2)]",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(be,{className:"w-4 h-4 text-green-400"}),e.jsx("span",{className:"text-sm font-medium text-green-200",children:"Remaining"})]}),e.jsx("p",{className:"text-2xl font-bold text-green-100",children:p(t.remainingBudgetCents)})]}),e.jsxs("div",{className:"p-4 bg-gradient-to-br from-cyan-900/30 to-blue-900/30 backdrop-blur-sm border border-cyan-500/30 rounded-lg shadow-[0_0_15px_rgba(6,182,212,0.2)]",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(je,{className:"w-4 h-4 text-cyan-400"}),e.jsx("span",{className:"text-sm font-medium text-cyan-200",children:"Allocated"})]}),e.jsx("p",{className:"text-2xl font-bold text-cyan-100",children:p(t.allocatedBudgetCents)})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-cyan-200",children:"Budget Utilization"}),e.jsxs("span",{className:"text-sm text-cyan-300/70",children:[s.toFixed(1),"%"]})]}),e.jsx("div",{className:"relative h-3 bg-slate-800/50 rounded-full overflow-hidden border border-blue-500/20",children:e.jsx("div",{className:"absolute inset-y-0 left-0 rounded-full bg-gradient-to-r from-cyan-500 to-blue-500 shadow-[0_0_10px_rgba(6,182,212,0.5)]",style:{width:`${Math.min(s,100)}%`}})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 p-4 bg-gradient-to-r from-blue-900/20 to-purple-900/20 backdrop-blur-sm border border-blue-500/30 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-cyan-300/50 mb-1",children:"Budget Period"}),e.jsx("p",{className:"font-semibold text-cyan-200 capitalize",children:t.budgetPeriod})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-cyan-300/50 mb-1",children:"Fiscal Year"}),e.jsx("p",{className:"font-semibold text-cyan-200",children:t.fiscalYear})]}),t.periodStartDate&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-cyan-300/50 mb-1",children:"Start Date"}),e.jsx("p",{className:"font-semibold text-cyan-200",children:W(new Date(t.periodStartDate),"MMM dd, yyyy")})]}),t.periodEndDate&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-cyan-300/50 mb-1",children:"End Date"}),e.jsx("p",{className:"font-semibold text-cyan-200",children:W(new Date(t.periodEndDate),"MMM dd, yyyy")})]})]}),t.categoryAllocations&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-3 text-cyan-100",children:"Category Breakdown"}),e.jsx("div",{className:"space-y-2",children:Object.entries(t.categoryAllocations).map(([b,m])=>{const v=typeof m=="number"?m:0;if(v===0)return null;const j=b==="transportation_and_visit_fees"?"Transportation and Visit Fees":b==="permit_fee"?"Permit Fee":b==="internet_and_communication_fees"?"Internet & Communication Fees":b.replace(/_/g," ");return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-cyan-200",children:j}),e.jsx("span",{className:"font-semibold text-cyan-100",children:p(v)})]},b)})})]}),t.budgetNotes&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2 text-cyan-100",children:"Notes"}),e.jsx("p",{className:"text-sm text-cyan-300/70",children:t.budgetNotes})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-cyan-300/50 pt-4 border-t border-blue-500/20",children:[e.jsxs("span",{children:["Created: ",W(new Date(t.createdAt),"MMM dd, yyyy")]}),e.jsxs("span",{children:["Updated: ",W(new Date(t.updatedAt),"MMM dd, yyyy")]})]})]})]})})]})}function Ge({budget:t,mmpName:g,onClick:r}){const[n,i]=h.useState(!1),s=t.allocatedBudgetCents>0?t.spentBudgetCents/t.allocatedBudgetCents*100:0,u=Ne[t.status]||"default",l=t.spentBudgetCents>t.allocatedBudgetCents,x=s>=80&&s<100,b=t.completedSites>0?t.spentBudgetCents/t.completedSites:t.averageCostPerSiteCents||0;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-purple-500/20 via-cyan-500/20 to-blue-500/20 rounded-2xl blur-xl opacity-75 group-hover:opacity-100 transition-opacity"}),e.jsxs(f,{className:"relative bg-gradient-to-br from-slate-900/90 via-purple-900/80 to-blue-900/90 backdrop-blur-xl border border-purple-500/30 hover-elevate active-elevate-2 cursor-pointer transition-all shadow-[0_0_30px_rgba(168,85,247,0.2)]",onClick:()=>i(!0),"data-testid":`mmp-budget-card-${t.id}`,children:[e.jsx(T,{className:"pb-3",children:e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx(F,{className:"text-base line-clamp-1 text-purple-100",children:g||"MMP Budget"}),e.jsxs("p",{className:"text-sm text-purple-300/60 mt-1",children:[t.totalSites," sites • ",t.completedSites," completed"]})]}),e.jsx(C,{variant:u,className:"bg-gradient-to-r from-purple-600/90 to-blue-600/90 text-white border-purple-400/50 shadow-[0_0_10px_rgba(168,85,247,0.5)]",children:t.status})]})}),e.jsxs(N,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-baseline justify-between",children:[e.jsx("span",{className:"text-2xl font-bold bg-gradient-to-r from-purple-300 to-cyan-300 bg-clip-text text-transparent",children:p(t.remainingBudgetCents)}),e.jsxs("span",{className:"text-sm text-purple-300/50",children:["of ",p(t.allocatedBudgetCents)]})]}),e.jsx("div",{className:"relative h-2 bg-slate-800/50 rounded-full overflow-hidden border border-purple-500/20",children:e.jsx("div",{className:`absolute inset-y-0 left-0 rounded-full ${l?"bg-gradient-to-r from-red-500 to-pink-500":x?"bg-gradient-to-r from-yellow-500 to-orange-500":"bg-gradient-to-r from-purple-500 to-cyan-500"} shadow-[0_0_10px_currentColor]`,style:{width:`${Math.min(s,100)}%`}})}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-purple-300/70",children:[e.jsxs("span",{children:[s.toFixed(1),"% utilized"]}),e.jsxs("span",{children:["Avg/site: ",p(b)]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 pt-2 border-t border-purple-500/20",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(q,{className:"w-4 h-4 text-purple-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-purple-300/50",children:"Progress"}),e.jsxs("p",{className:"text-sm font-semibold text-purple-200",children:[t.totalSites>0?Math.round(t.completedSites/t.totalSites*100):0,"%"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[l?e.jsx(P,{className:"w-4 h-4 text-red-400"}):e.jsx(ge,{className:"w-4 h-4 text-green-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-purple-300/50",children:"Status"}),e.jsx("p",{className:`text-sm font-semibold ${l?"text-red-300":"text-green-300"}`,children:l?"Over":"On Track"})]})]})]})]})]})]}),e.jsx(ie,{open:n,onOpenChange:i,children:e.jsxs(oe,{className:"max-w-2xl max-h-[90vh] overflow-y-auto bg-gradient-to-br from-slate-900 via-purple-950 to-blue-950 border-purple-500/30 shadow-[0_0_50px_rgba(168,85,247,0.3)]",children:[e.jsx(ce,{children:e.jsxs(de,{className:"flex items-center gap-2 text-purple-100",children:[e.jsx(je,{className:"w-5 h-5 text-purple-400"}),g||"MMP Budget"," Details"]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(C,{variant:u,children:t.status}),l&&e.jsxs(C,{variant:"destructive",className:"gap-1",children:[e.jsx(P,{className:"w-3 h-3"}),"Over Budget"]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"p-4 bg-gradient-to-br from-purple-900/30 to-cyan-900/30 backdrop-blur-sm border border-purple-500/30 rounded-lg shadow-[0_0_15px_rgba(168,85,247,0.2)]",children:[e.jsx("p",{className:"text-sm text-purple-300/70",children:"Allocated"}),e.jsx("p",{className:"text-xl font-bold text-purple-100",children:p(t.allocatedBudgetCents)})]}),e.jsxs("div",{className:"p-4 bg-gradient-to-br from-cyan-900/30 to-blue-900/30 backdrop-blur-sm border border-cyan-500/30 rounded-lg shadow-[0_0_15px_rgba(6,182,212,0.2)]",children:[e.jsx("p",{className:"text-sm text-cyan-300/70",children:"Spent"}),e.jsx("p",{className:"text-xl font-bold text-cyan-100",children:p(t.spentBudgetCents)})]}),e.jsxs("div",{className:"p-4 bg-gradient-to-br from-green-900/30 to-purple-900/30 backdrop-blur-sm border border-green-500/30 rounded-lg shadow-[0_0_15px_rgba(34,197,94,0.2)]",children:[e.jsx("p",{className:"text-sm text-green-300/70",children:"Remaining"}),e.jsx("p",{className:"text-xl font-bold text-green-100",children:p(t.remainingBudgetCents)})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-purple-200",children:"Utilization"}),e.jsxs("span",{className:"text-sm text-purple-300/70",children:[s.toFixed(1),"%"]})]}),e.jsx("div",{className:"relative h-3 bg-slate-800/50 rounded-full overflow-hidden border border-purple-500/20",children:e.jsx("div",{className:"absolute inset-y-0 left-0 rounded-full bg-gradient-to-r from-purple-500 to-cyan-500 shadow-[0_0_10px_rgba(168,85,247,0.5)]",style:{width:`${Math.min(s,100)}%`}})})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 p-4 bg-gradient-to-r from-purple-900/20 to-cyan-900/20 backdrop-blur-sm border border-purple-500/30 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-purple-300/50 mb-1",children:"Total Sites"}),e.jsx("p",{className:"text-xl font-bold text-purple-100",children:t.totalSites})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-purple-300/50 mb-1",children:"Completed"}),e.jsx("p",{className:"text-xl font-bold text-purple-100",children:t.completedSites})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-purple-300/50 mb-1",children:"Avg Cost/Site"}),e.jsx("p",{className:"text-lg font-bold text-purple-100",children:p(b)})]})]}),t.categoryBreakdown&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-3 text-purple-100",children:"Category Breakdown"}),e.jsx("div",{className:"space-y-2",children:Object.entries(t.categoryBreakdown).map(([m,v])=>{const j=typeof v=="number"?v:0;if(j===0)return null;const _=m==="transportation_and_visit_fees"?"Transportation and Visit Fees":m==="permit_fee"?"Permit Fee":m==="internet_and_communication_fees"?"Internet & Communication Fees":m.replace(/_/g," ");return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-purple-200",children:_}),e.jsx("span",{className:"font-semibold text-purple-100",children:p(j)})]},m)})})]})]})]})})]})}const o=t=>new Intl.NumberFormat("en-SD",{style:"currency",currency:"SDG",minimumFractionDigits:2,maximumFractionDigits:2}).format(t/100),ne=t=>new Date(t).toLocaleDateString("en-SD",{year:"numeric",month:"short",day:"numeric"});function Ve(t,g="budget_report.pdf"){const r=new Ie;let n=20;if(r.setFontSize(18),r.setFont("helvetica","bold"),r.text("PACT Budget Report",14,n),n+=10,r.setFontSize(10),r.setFont("helvetica","normal"),r.text(`Generated: ${new Date().toLocaleDateString("en-SD")}`,14,n),t.stats){n+=15,r.setFontSize(14),r.setFont("helvetica","bold"),r.text("Budget Summary",14,n),n+=8,r.setFontSize(10),r.setFont("helvetica","normal");const i=[["Total Budget",o(t.stats.totalBudget*100)],["Total Spent",o(t.stats.totalSpent*100)],["Total Remaining",o(t.stats.totalRemaining*100)],["Utilization Rate",`${t.stats.utilizationRate.toFixed(1)}%`]];ee(r,{startY:n,head:[["Metric","Value"]],body:i,theme:"grid",headStyles:{fillColor:[41,128,185]}}),n=r.lastAutoTable.finalY+15}if(t.projectBudgets.length>0){r.setFontSize(14),r.setFont("helvetica","bold"),r.text("Project Budgets",14,n),n+=8;const i=t.projectBudgets.map(s=>[`FY ${s.fiscalYear}`,s.budgetPeriod.replace("_"," "),o(s.totalBudgetCents),o(s.spentBudgetCents),o(s.remainingBudgetCents),s.status]);ee(r,{startY:n,head:[["Fiscal Year","Period","Total","Spent","Remaining","Status"]],body:i,theme:"striped",headStyles:{fillColor:[52,73,94]}}),n=r.lastAutoTable.finalY+15}if(t.mmpBudgets.length>0){n>250&&(r.addPage(),n=20),r.setFontSize(14),r.setFont("helvetica","bold"),r.text("MMP Budgets",14,n),n+=8;const i=t.mmpBudgets.map(s=>[s.mmpFileId.slice(0,8),`${s.completedSites}/${s.totalSites}`,o(s.allocatedBudgetCents),o(s.spentBudgetCents),o(s.remainingBudgetCents),s.status]);ee(r,{startY:n,head:[["MMP ID","Sites","Allocated","Spent","Remaining","Status"]],body:i,theme:"striped",headStyles:{fillColor:[52,73,94]}})}if(t.transactions.length>0){r.addPage(),n=20,r.setFontSize(14),r.setFont("helvetica","bold"),r.text("Recent Transactions",14,n),n+=8;const i=t.transactions.slice(0,50).map(s=>{var u;return[ne(s.createdAt),s.transactionType.replace("_"," "),((u=s.category)==null?void 0:u.replace("_"," "))||"-",o(s.amountCents),(s.description||"").substring(0,40)]});ee(r,{startY:n,head:[["Date","Type","Category","Amount","Description"]],body:i,theme:"striped",headStyles:{fillColor:[52,73,94]},columnStyles:{4:{cellWidth:60}}})}r.save(g)}function Ue(t,g="budget_report.xlsx"){const r=y.book_new();if(t.stats){const n=[["PACT Budget Report"],[`Generated: ${new Date().toLocaleDateString("en-SD")}`],[""],["Metric","Value"],["Total Budget",o(t.stats.totalBudget*100)],["Total Spent",o(t.stats.totalSpent*100)],["Total Remaining",o(t.stats.totalRemaining*100)],["Utilization Rate",`${t.stats.utilizationRate.toFixed(1)}%`]],i=y.aoa_to_sheet(n);y.book_append_sheet(r,i,"Summary")}if(t.projectBudgets.length>0){const n=[["Fiscal Year","Period","Total Budget","Allocated","Spent","Remaining","Status","Created"],...t.projectBudgets.map(s=>[s.fiscalYear,s.budgetPeriod,o(s.totalBudgetCents),o(s.allocatedBudgetCents),o(s.spentBudgetCents),o(s.remainingBudgetCents),s.status,ne(s.createdAt)])],i=y.aoa_to_sheet(n);y.book_append_sheet(r,i,"Project Budgets")}if(t.mmpBudgets.length>0){const n=[["MMP ID","Total Sites","Completed Sites","Allocated","Spent","Remaining","Avg per Site","Status","Source"],...t.mmpBudgets.map(s=>[s.mmpFileId.slice(0,8),s.totalSites,s.completedSites,o(s.allocatedBudgetCents),o(s.spentBudgetCents),o(s.remainingBudgetCents),o(s.averageCostPerSiteCents),s.status,s.sourceType])],i=y.aoa_to_sheet(n);y.book_append_sheet(r,i,"MMP Budgets")}if(t.transactions.length>0){const n=[["Date","Type","Category","Amount","Currency","Description","Before","After"],...t.transactions.slice(0,1e3).map(s=>[ne(s.createdAt),s.transactionType,s.category||"",o(s.amountCents),s.currency,s.description||"",o(s.balanceBeforeCents),o(s.balanceAfterCents)])],i=y.aoa_to_sheet(n);y.book_append_sheet(r,i,"Transactions")}Ye(r,g)}function He(t,g="budget_report.csv"){const r=[["PACT Budget Report"],[`Generated: ${new Date().toLocaleDateString("en-SD")}`],[""]];t.stats&&(r.push(["Summary"]),r.push(["Total Budget",o(t.stats.totalBudget*100)]),r.push(["Total Spent",o(t.stats.totalSpent*100)]),r.push(["Total Remaining",o(t.stats.totalRemaining*100)]),r.push(["Utilization Rate",`${t.stats.utilizationRate.toFixed(1)}%`]),r.push([""])),t.projectBudgets.length>0&&(r.push(["Project Budgets"]),r.push(["Fiscal Year","Period","Total","Spent","Remaining","Status"]),t.projectBudgets.forEach(l=>{r.push([l.fiscalYear.toString(),l.budgetPeriod,o(l.totalBudgetCents),o(l.spentBudgetCents),o(l.remainingBudgetCents),l.status])}),r.push([""])),t.mmpBudgets.length>0&&(r.push(["MMP Budgets"]),r.push(["MMP ID","Sites","Allocated","Spent","Remaining","Status"]),t.mmpBudgets.forEach(l=>{r.push([l.mmpFileId.slice(0,8),`${l.completedSites}/${l.totalSites}`,o(l.allocatedBudgetCents),o(l.spentBudgetCents),o(l.remainingBudgetCents),l.status])}),r.push([""]));const n=r.map(l=>l.map(x=>`"${x}"`).join(",")).join(`
`),i=new Blob([n],{type:"text/csv;charset=utf-8;"}),s=document.createElement("a"),u=URL.createObjectURL(i);s.setAttribute("href",u),s.setAttribute("download",g),s.style.visibility="hidden",document.body.appendChild(s),s.click(),document.body.removeChild(s)}const w=t=>new Intl.NumberFormat("en-SD",{style:"currency",currency:"SDG",minimumFractionDigits:2,maximumFractionDigits:2}).format(t/100),gt=()=>{var Z;const{currentUser:t,hasGranularPermission:g}=_e(),{toast:r}=Se(),{projectBudgets:n,mmpBudgets:i,budgetTransactions:s,budgetAlerts:u,stats:l,loading:x,refreshProjectBudgets:b,refreshMMPBudgets:m,refreshBudgetTransactions:v,refreshBudgetAlerts:j,acknowledgeAlert:_,dismissAlert:J}=fe(),[Q,M]=h.useState("overview"),[S,O]=h.useState("all"),E=g("finances","update")||(t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="fom",k=async()=>{await Promise.all([b(),m(),v(),j()])},A=a=>{const c={projectBudgets:n,mmpBudgets:i,transactions:s,stats:l},Y=`budget_report_${new Date().toISOString().split("T")[0]}`;try{switch(a){case"pdf":Ve(c,`${Y}.pdf`),r({title:"Export Successful",description:"Budget report exported to PDF"});break;case"excel":Ue(c,`${Y}.xlsx`),r({title:"Export Successful",description:"Budget report exported to Excel"});break;case"csv":He(c,`${Y}.csv`),r({title:"Export Successful",description:"Budget report exported to CSV"});break}}catch{r({title:"Export Failed",description:"Failed to export budget report",variant:"destructive"})}},I=u.filter(a=>a.status==="active"),se=I.filter(a=>a.severity==="critical"),R=I.filter(a=>a.severity==="warning"),d=S==="all"?n:n.filter(a=>a.status===S),$=S==="all"?i:i.filter(a=>a.status===S),ae=h.useMemo(()=>{const a={};return i.forEach(c=>{Object.entries(c.categoryBreakdown).forEach(([B,Y])=>{a[B]||(a[B]={allocated:0,spent:0,count:0}),a[B].allocated+=Y,a[B].count++})}),s.filter(c=>c.transactionType==="spend"&&c.category).forEach(c=>{c.category&&a[c.category]&&(a[c.category].spent+=c.amountCents)}),a},[i,s]);return x?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(me,{className:"w-5 h-5 animate-spin text-blue-400"}),e.jsx("p",{className:"text-blue-300/70",children:"Synchronizing budget data..."})]})}):e.jsxs("div",{className:"min-h-screen bg-background p-4 md:p-8 space-y-6","data-testid":"page-budget",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg bg-gradient-to-br from-green-500 to-emerald-700 flex items-center justify-center",children:e.jsx(te,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Budget Management"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Advanced Financial Control Center"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(G,{variant:"outline",size:"sm",onClick:k,"data-testid":"button-refresh",children:[e.jsx(me,{className:"w-4 h-4 mr-2"}),"Refresh"]}),e.jsxs(Be,{children:[e.jsx(De,{asChild:!0,children:e.jsxs(G,{variant:"outline",size:"sm","data-testid":"button-export",children:[e.jsx(ye,{className:"w-4 h-4 mr-2"}),"Export"]})}),e.jsxs(Te,{children:[e.jsx(re,{onClick:()=>A("pdf"),"data-testid":"menu-export-pdf",children:"Export as PDF"}),e.jsx(re,{onClick:()=>A("excel"),"data-testid":"menu-export-excel",children:"Export as Excel"}),e.jsx(re,{onClick:()=>A("csv"),"data-testid":"menu-export-csv",children:"Export as CSV"})]})]})]})]}),I.length>0&&e.jsxs("div",{className:"grid gap-3",children:[se.map(a=>e.jsx(f,{className:"bg-gradient-to-r from-red-900/50 to-orange-900/50 border-red-500/40 backdrop-blur-xl shadow-[0_0_20px_rgba(239,68,68,0.3)]",children:e.jsxs(N,{className:"flex items-start gap-3 p-4",children:[e.jsx(P,{className:"w-5 h-5 text-red-400 mt-0.5 animate-pulse"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-red-200",children:a.title}),e.jsx("p",{className:"text-sm text-red-300/70",children:a.message})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(G,{size:"sm",variant:"outline",onClick:()=>_(a.id),className:"border-red-500/30 text-red-300",children:"Acknowledge"}),e.jsx(G,{size:"sm",variant:"ghost",onClick:()=>J(a.id),className:"text-red-300",children:"Dismiss"})]})]})},a.id)),R.slice(0,3).map(a=>e.jsx(f,{className:"bg-gradient-to-r from-yellow-900/50 to-orange-900/50 border-yellow-500/40 backdrop-blur-xl shadow-[0_0_20px_rgba(234,179,8,0.2)]",children:e.jsxs(N,{className:"flex items-start gap-3 p-4",children:[e.jsx(P,{className:"w-5 h-5 text-yellow-400 mt-0.5 animate-pulse"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-yellow-200",children:a.title}),e.jsx("p",{className:"text-sm text-yellow-300/70",children:a.message})]}),e.jsx(G,{size:"sm",variant:"ghost",onClick:()=>_(a.id),className:"text-yellow-300",children:"Dismiss"})]})},a.id))]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx(K,{title:"Total Budget",value:w(l!=null&&l.totalBudget?l.totalBudget*100:0),subtitle:`Across ${n.length} projects`,icon:we,color:"blue","data-testid":"card-stat-total-budget"}),e.jsx(K,{title:"Total Spent",value:w(l!=null&&l.totalSpent?l.totalSpent*100:0),subtitle:`${(Z=l==null?void 0:l.utilizationRate)==null?void 0:Z.toFixed(1)}% utilization`,icon:he,color:"purple","data-testid":"card-stat-total-spent"}),e.jsx(K,{title:"Remaining Budget",value:w(l!=null&&l.totalRemaining?l.totalRemaining*100:0),subtitle:"Available for allocation",icon:be,color:"green","data-testid":"card-stat-remaining-budget"}),e.jsx(K,{title:"Active MMPs",value:i.filter(a=>a.status==="active").length,subtitle:`${i.length} total MMP budgets`,icon:q,color:"cyan","data-testid":"card-stat-active-mmps"})]}),e.jsxs(Fe,{value:Q,onValueChange:M,children:[e.jsxs(Pe,{className:"grid w-full grid-cols-5 bg-gradient-to-r from-slate-900/80 to-blue-900/80 border border-blue-500/30 backdrop-blur-xl p-1",children:[e.jsx(V,{value:"overview","data-testid":"tab-overview",className:"data-[state=active]:bg-gradient-to-r data-[state=active]:from-blue-600 data-[state=active]:to-purple-600 data-[state=active]:text-white data-[state=active]:shadow-[0_0_15px_rgba(59,130,246,0.5)] text-blue-300",children:"OVERVIEW"}),e.jsx(V,{value:"projects","data-testid":"tab-projects",className:"data-[state=active]:bg-gradient-to-r data-[state=active]:from-blue-600 data-[state=active]:to-purple-600 data-[state=active]:text-white data-[state=active]:shadow-[0_0_15px_rgba(59,130,246,0.5)] text-blue-300",children:"PROJECTS"}),e.jsx(V,{value:"mmps","data-testid":"tab-mmps",className:"data-[state=active]:bg-gradient-to-r data-[state=active]:from-blue-600 data-[state=active]:to-purple-600 data-[state=active]:text-white data-[state=active]:shadow-[0_0_15px_rgba(59,130,246,0.5)] text-blue-300",children:"MMP BUDGETS"}),e.jsx(V,{value:"transactions","data-testid":"tab-transactions",className:"data-[state=active]:bg-gradient-to-r data-[state=active]:from-blue-600 data-[state=active]:to-purple-600 data-[state=active]:text-white data-[state=active]:shadow-[0_0_15px_rgba(59,130,246,0.5)] text-blue-300",children:"TRANSACTIONS"}),e.jsx(V,{value:"analytics","data-testid":"tab-analytics",className:"data-[state=active]:bg-gradient-to-r data-[state=active]:from-blue-600 data-[state=active]:to-purple-600 data-[state=active]:text-white data-[state=active]:shadow-[0_0_15px_rgba(59,130,246,0.5)] text-blue-300",children:"ANALYTICS"})]}),e.jsxs(U,{value:"overview",className:"space-y-4",children:[e.jsxs(f,{className:"bg-gradient-to-br from-slate-900/80 to-blue-900/80 border-blue-500/30 backdrop-blur-xl shadow-[0_0_20px_rgba(59,130,246,0.2)]",children:[e.jsx(T,{children:e.jsx(F,{className:"text-xl font-bold text-blue-300",children:"Budget Overview"})}),e.jsx(N,{className:"space-y-4",children:n.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(xe,{className:"w-12 h-12 mx-auto text-blue-400 mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2 text-blue-200",children:"No budgets yet"}),e.jsx("p",{className:"text-blue-300/70 mb-4",children:"Create your first project budget to start tracking expenditures"}),E&&e.jsx(ue,{projectId:"placeholder",projectName:"Select Project"})]}):e.jsx(e.Fragment,{children:n.slice(0,5).map(a=>{const c=a.totalBudgetCents>0?a.spentBudgetCents/a.totalBudgetCents*100:0;return e.jsxs("div",{className:"space-y-2 p-4 rounded-lg bg-gradient-to-r from-slate-800/50 to-blue-800/50 border border-blue-500/20",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-blue-200",children:["Project Budget - FY ",a.fiscalYear]}),e.jsx("p",{className:"text-sm text-blue-300/70",children:a.budgetPeriod.replace("_"," ").toUpperCase()})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-semibold bg-gradient-to-r from-green-400 to-emerald-400 bg-clip-text text-transparent",children:w(a.remainingBudgetCents)}),e.jsxs("p",{className:"text-sm text-blue-300/70",children:["of ",w(a.totalBudgetCents)," remaining"]})]})]}),e.jsx(pe,{value:c,className:"h-2 bg-slate-700/50 [&>div]:bg-gradient-to-r [&>div]:from-blue-500 [&>div]:to-purple-500"}),e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("span",{className:"text-blue-300/70",children:[c.toFixed(1),"% utilized"]}),e.jsx(C,{variant:a.status==="active"?"default":"secondary",className:a.status==="active"?"bg-gradient-to-r from-green-500 to-emerald-600 border-0":"bg-slate-700 text-slate-300",children:a.status})]})]},a.id)})})})]}),e.jsxs(f,{className:"bg-gradient-to-br from-slate-900/80 to-purple-900/80 border-purple-500/30 backdrop-blur-xl shadow-[0_0_20px_rgba(168,85,247,0.2)]",children:[e.jsx(T,{children:e.jsx(F,{className:"text-xl font-bold text-purple-300",children:"Spending by Category"})}),e.jsx(N,{children:e.jsx("div",{className:"space-y-3",children:Object.entries(ae).map(([a,c])=>{const B=c.allocated>0?c.spent/c.allocated*100:0;return e.jsxs("div",{className:"space-y-2 p-3 rounded-lg bg-gradient-to-r from-slate-800/50 to-purple-800/50 border border-purple-500/20",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium capitalize text-purple-200",children:a.replace("_"," ")}),e.jsxs("span",{className:"text-sm text-purple-300/70",children:[w(c.spent)," / ",w(c.allocated)]})]}),e.jsx(pe,{value:B,className:"h-1.5 bg-slate-700/50 [&>div]:bg-gradient-to-r [&>div]:from-purple-500 [&>div]:to-pink-500"})]},a)})})})]})]}),e.jsxs(U,{value:"projects",className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold bg-gradient-to-r from-blue-400 to-cyan-400 bg-clip-text text-transparent",children:"Project Budgets"}),e.jsx("p",{className:"text-blue-300/70",children:"Manage and track project budget allocations"})]}),E&&e.jsx(ue,{projectId:"placeholder",projectName:"Select Project"})]}),d.length===0?e.jsx(f,{className:"bg-gradient-to-br from-slate-900/80 to-blue-900/80 border-blue-500/30 backdrop-blur-xl shadow-[0_0_20px_rgba(59,130,246,0.2)]",children:e.jsxs(N,{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(te,{className:"w-12 h-12 text-blue-400 mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2 text-blue-200",children:"No project budgets found"}),e.jsx("p",{className:"text-blue-300/70 text-center max-w-md",children:"Create your first project budget to start tracking and managing expenditures"})]})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:d.map(a=>e.jsx(Le,{budget:a,projectName:`Project ${a.fiscalYear}`},a.id))})]}),e.jsxs(U,{value:"mmps",className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between flex-wrap gap-4",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold bg-gradient-to-r from-purple-400 to-pink-400 bg-clip-text text-transparent",children:"MMP Budgets"}),e.jsx("p",{className:"text-purple-300/70",children:"Track budget allocations for Monthly Monitoring Plans"})]})}),$.length===0?e.jsx(f,{className:"bg-gradient-to-br from-slate-900/80 to-purple-900/80 border-purple-500/30 backdrop-blur-xl shadow-[0_0_20px_rgba(168,85,247,0.2)]",children:e.jsxs(N,{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(q,{className:"w-12 h-12 text-purple-400 mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2 text-purple-200",children:"No MMP budgets found"}),e.jsx("p",{className:"text-purple-300/70 text-center max-w-md",children:"Allocate budgets to MMPs to track site visit costs and manage field operations"})]})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:$.map(a=>e.jsx(Ge,{budget:a,mmpName:`MMP-${a.mmpFileId.slice(0,8)}`},a.id))})]}),e.jsx(U,{value:"transactions",className:"space-y-4",children:e.jsxs(f,{className:"bg-gradient-to-br from-slate-900/80 to-cyan-900/80 border-cyan-500/30 backdrop-blur-xl shadow-[0_0_20px_rgba(34,211,238,0.2)]",children:[e.jsx(T,{children:e.jsx(F,{className:"text-xl font-bold text-cyan-300",children:"Budget Transactions"})}),e.jsx(N,{children:e.jsxs(Me,{children:[e.jsx(ke,{children:e.jsxs(le,{className:"border-cyan-500/20 hover:bg-cyan-500/5",children:[e.jsx(H,{className:"text-cyan-300",children:"Date"}),e.jsx(H,{className:"text-cyan-300",children:"Type"}),e.jsx(H,{className:"text-cyan-300",children:"Category"}),e.jsx(H,{className:"text-cyan-300",children:"Description"}),e.jsx(H,{className:"text-right text-cyan-300",children:"Amount"})]})}),e.jsx(Ae,{children:s.length===0?e.jsx(le,{className:"border-cyan-500/20",children:e.jsx(z,{colSpan:5,className:"text-center text-cyan-300/70 py-12",children:"No transactions yet"})}):s.slice(0,50).map(a=>{var c;return e.jsxs(le,{"data-testid":`row-transaction-${a.id}`,className:"border-cyan-500/20 hover:bg-cyan-500/5",children:[e.jsx(z,{className:"text-cyan-100",children:W(new Date(a.createdAt),"MMM d, yyyy")}),e.jsx(z,{className:"capitalize text-cyan-100",children:a.transactionType.replace("_"," ")}),e.jsx(z,{className:"capitalize text-cyan-100",children:((c=a.category)==null?void 0:c.replace("_"," "))||"-"}),e.jsx(z,{className:"max-w-xs truncate text-cyan-100",children:a.description||"-"}),e.jsx(z,{className:"text-right",children:e.jsxs("span",{className:a.transactionType==="spend"?"text-red-400 font-semibold":"text-green-400 font-semibold",children:[a.transactionType==="spend"?"-":"+",w(a.amountCents)]})})]},a.id)})})]})})]})}),e.jsx(U,{value:"analytics",className:"space-y-4",children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs(f,{className:"bg-gradient-to-br from-slate-900/80 to-blue-900/80 border-blue-500/30 backdrop-blur-xl shadow-[0_0_20px_rgba(59,130,246,0.2)]",children:[e.jsx(T,{children:e.jsx(F,{className:"text-xl font-bold text-blue-300",children:"Budget Utilization"})}),e.jsx(N,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(xe,{className:"w-16 h-16 mx-auto text-blue-400 mb-4"}),e.jsx("p",{className:"text-blue-300/70",children:"Chart visualization coming soon"})]})})]}),e.jsxs(f,{className:"bg-gradient-to-br from-slate-900/80 to-purple-900/80 border-purple-500/30 backdrop-blur-xl shadow-[0_0_20px_rgba(168,85,247,0.2)]",children:[e.jsx(T,{children:e.jsx(F,{className:"text-xl font-bold text-purple-300",children:"Spending Trends"})}),e.jsx(N,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(q,{className:"w-16 h-16 mx-auto text-purple-400 mb-4"}),e.jsx("p",{className:"text-purple-300/70",children:"Trend analysis coming soon"})]})})]})]})})]})]})};export{gt as default};
