import{r as C,j as e,N as F,Y as H,R as Fe,ag as se,a3 as te,aX as re,_ as ke,U as ie,o as Ae,q as Ve,b5 as Me}from"./react-core-B8kFjp2k.js";import{E as De,Z as Te,U as Pe,J as Le,C as V,f as T,g as P,h as L,b as M,a as u,B as ae,S as Ee,I as j,a3 as G}from"./index-PwDgWEVM.js";import{T as q}from"./textarea-BpQMf5eL.js";import{u as Re,t as Ue,o as Ie,s as d,e as z}from"./forms-CESK2FDA.js";import{R as le,a as $}from"./radio-group-CC4lGE1V.js";import{L as Y}from"./label-C4lDws8j.js";import{F as Be,a,b as l,e as n,c,f as He,d as o}from"./form-BT_tmI7p.js";import{bo as Ge,by as ne}from"./vendor-VlxgVHMv.js";import{A as ce,b as oe}from"./alert-BXWNuJnD.js";import{S as b,a as v,b as f,c as y,d as h}from"./select-CXX5Q_V1.js";import{h as de,s as _,g as qe,c as ze}from"./sudanStates-CkkbYUnU.js";import"./docs-D2Yi4cpO.js";import"./react-dom-BLwj5vIO.js";import"./jspdf-rld7HkB6.js";import"./router-CKy9yO3R.js";import"./query-CJ0Bt4ph.js";import"./supabase-CwPDIVMD.js";import"./xlsx-CBxwqXDA.js";import"./date-utils-YarVESQS.js";import"./radix-ui-C2DV4xtt.js";import"./radix-dialogs-CnlmQBMC.js";import"./radix-menus-CPezQVZk.js";const $e=Ie({siteSource:z(["existing","new"]),siteName:d().min(3,"Site name must be at least 3 characters").optional(),description:d().max(500,"Description must be less than 500 characters").optional(),location:d().optional(),priority:z(["high","medium","low"]),selectedMmpSite:d().optional(),hub:d().optional(),state:d().optional(),locality:d().optional(),mainActivity:d().min(3,"Main activity must be at least 3 characters").optional(),projectName:d().min(3,"Project name must be at least 3 characters").optional(),complexity:z(["low","medium","high"]),estimatedDuration:d().optional(),coordinatorName:d().optional(),supervisorName:d().optional(),risks:d().max(1e3,"Risks description must be less than 1000 characters").optional(),resources:d().max(1e3,"Resources description must be less than 1000 characters").optional(),feeCurrency:d().min(1,"Currency is required"),distanceFee:d().refine(i=>!isNaN(Number(i))&&Number(i)>=0,"Must be a valid positive number"),complexityFee:d().refine(i=>!isNaN(Number(i))&&Number(i)>=0,"Must be a valid positive number"),urgencyFee:d().refine(i=>!isNaN(Number(i))&&Number(i)>=0,"Must be a valid positive number")}).refine(i=>i.siteSource==="existing"?!!i.selectedMmpSite:i.siteSource==="new"?!!(i.siteName&&i.state&&i.hub&&i.mainActivity&&i.projectName):!0,{message:"Please complete all required fields for the selected site source"}),js=()=>{const i=Ge(),{currentUser:Ye,users:J}=De(),{checkPermission:me,hasAnyRole:xe}=Te(),{mmpFiles:he}=Pe(),{createSiteVisit:O}=Le(),[E,X]=C.useState([]),[ue,Z]=C.useState([]),[w,D]=C.useState(1),[K,Q]=C.useState(!1),je=J.filter(s=>s.role==="coordinator"),pe=J.filter(s=>s.role==="supervisor"),t=Re({resolver:Ue($e),defaultValues:{siteSource:"existing",priority:"high",state:"",complexity:"medium",feeCurrency:"SDG",distanceFee:"0",complexityFee:"0",urgencyFee:"0"}}),S=t.watch("state"),N=t.watch("hub"),ge=t.watch("distanceFee"),Ne=t.watch("complexityFee"),be=t.watch("urgencyFee"),ve=t.watch("feeCurrency");C.useEffect(()=>{if(N){const s=de.find(r=>r.id===N);if(s){const r=_.filter(x=>s.states.includes(x.id));Z(r),t.setValue("state",""),t.setValue("locality","")}}else Z(_)},[N,t]),C.useEffect(()=>{if(S){if(X(qe(S)),t.setValue("locality",""),!N){const s=ze(S);s&&t.setValue("hub",s)}}else X([])},[S,N,t]);const k=he.filter(s=>s.status==="approved").flatMap(s=>s.siteEntries||[]).map(s=>({id:s.id,name:s.siteName,code:s.siteCode}));if(!(me("site_visits","create")||xe(["admin"])))return e.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:e.jsxs(V,{className:"w-full max-w-md",children:[e.jsxs(T,{children:[e.jsx(P,{className:"text-destructive",children:"Access Denied"}),e.jsx(L,{children:"You don't have permission to access this page."})]}),e.jsx(M,{children:e.jsx(u,{variant:"outline",onClick:()=>i("/site-visits"),className:"w-full",children:"Return to Site Visits"})})]})});const W=async s=>{var r,x;Q(!0);try{let m;const A=p=>{const g=typeof p=="string"?parseFloat(p):Number(p||0);return isNaN(g)?0:g},R=A(s.distanceFee),U=A(s.complexityFee),I=A(s.urgencyFee),ee=R+U+I;if(s.siteSource==="existing"){const p=k.find(g=>g.id===s.selectedMmpSite);p&&(m=await O({siteName:p.name,siteCode:p.code,priority:s.priority,visitType:"urgent",status:"pending",fees:{total:ee,currency:s.feeCurrency||"SDG",distanceFee:R,complexityFee:U,urgencyFee:I}}))}else{const p=_.find(B=>B.id===s.state),g=E.find(B=>B.id===s.locality);m=await O({siteName:s.siteName,priority:s.priority,state:s.state,locality:(g==null?void 0:g.name)||"",hub:s.hub,mainActivity:s.mainActivity,projectName:s.projectName,complexity:s.complexity,visitType:"urgent",status:"pending",estimatedDuration:s.estimatedDuration,description:((r=s.description)==null?void 0:r.toString())||"",risks:((x=s.risks)==null?void 0:x.toString())||"",resources:s.resources?[s.resources]:[],fees:{total:ee,currency:s.feeCurrency||"SDG",distanceFee:R,complexityFee:U,urgencyFee:I},team:{coordinator:s.coordinatorName,supervisor:s.supervisorName}})}if(m)ne.success("Urgent site visit created successfully!",{description:"The site visit has been submitted for approval.",duration:4e3}),setTimeout(()=>{i("/site-visits")},1500);else throw new Error("Failed to create site visit")}catch(m){ne.error("Failed to create site visit",{description:m instanceof Error?m.message:"An unexpected error occurred. Please try again.",duration:5e3})}finally{Q(!1)}},fe=s=>{const r=t.watch("siteSource");switch(s){case 2:return r==="existing"?!!t.watch("selectedMmpSite"):!!(t.watch("siteName")&&t.watch("state")&&t.watch("hub"));case 3:return!0;default:return!1}},ye=()=>e.jsx("div",{className:"mb-8",children:e.jsx("div",{className:"flex items-center justify-between p-6 bg-blue-50 rounded-xl border",children:[1,2,3].map((s,r)=>{const x=w===s,m=w>s,A=["Site Selection","Details & Team","Fees & Submit"];return e.jsxs(Fe.Fragment,{children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:`flex items-center justify-center w-10 h-10 rounded-full font-semibold transition-all duration-200 ${m?"bg-green-500 text-white":x?"bg-primary text-primary-foreground shadow-lg":"bg-muted text-muted-foreground"}`,children:m?e.jsx(se,{className:"h-5 w-5"}):s}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:`font-medium transition-colors ${x?"text-primary":m?"text-green-600":"text-muted-foreground"}`,children:A[r]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Step ",s," of 3"]})]})]}),r<2&&e.jsx("div",{className:`flex-1 h-0.5 mx-4 transition-colors ${w>s+1?"bg-green-500":"bg-border"}`})]},s)})})}),we=()=>e.jsxs(V,{className:"shadow-lg border-0 bg-white",children:[e.jsxs(T,{className:"pb-6",children:[e.jsxs(P,{className:"flex items-center text-xl",children:[e.jsx(te,{className:"h-6 w-6 mr-3 text-blue-600"}),"Site Selection"]}),e.jsx(L,{className:"text-base",children:"Choose whether to create a visit for an existing approved site or add a new urgent site"})]}),e.jsxs(M,{className:"space-y-8",children:[e.jsx(a,{control:t.control,name:"siteSource",render:({field:s})=>e.jsx(l,{children:e.jsxs(le,{onValueChange:s.onChange,defaultValue:s.value,value:s.value,className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"relative group",children:[e.jsx($,{value:"existing",id:"existing",className:"peer sr-only"}),e.jsxs(Y,{htmlFor:"existing",className:"flex flex-col space-y-4 rounded-xl border-2 border-muted bg-card p-6 hover:bg-accent/50 hover:border-primary/50 peer-data-[state=checked]:border-primary peer-data-[state=checked]:bg-primary/5 cursor-pointer transition-all duration-200 group-hover:shadow-md",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(re,{className:"h-5 w-5 text-blue-600"}),e.jsx("span",{className:"font-semibold",children:"Existing Approved Site"})]}),e.jsxs(ae,{variant:"secondary",className:"text-xs",children:[k.length," available"]})]}),e.jsx("p",{className:"text-sm text-muted-foreground leading-relaxed",children:"Select from sites already approved in MMP files. This option ensures compliance with existing project plans."})]})]}),e.jsxs("div",{className:"relative group",children:[e.jsx($,{value:"new",id:"new",className:"peer sr-only"}),e.jsxs(Y,{htmlFor:"new",className:"flex flex-col space-y-4 rounded-xl border-2 border-muted bg-card p-6 hover:bg-accent/50 hover:border-primary/50 peer-data-[state=checked]:border-primary peer-data-[state=checked]:bg-primary/5 cursor-pointer transition-all duration-200 group-hover:shadow-md",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(H,{className:"h-5 w-5 text-amber-500"}),e.jsx("span",{className:"font-semibold",children:"New Urgent Site"})]}),e.jsx(ae,{variant:"destructive",className:"text-xs animate-pulse",children:"URGENT"})]}),e.jsx("p",{className:"text-sm text-muted-foreground leading-relaxed",children:"Create a new site for urgent, unscheduled visits that require immediate attention."})]})]})]})})}),t.watch("siteSource")==="existing"&&e.jsxs("div",{className:"space-y-6 animate-in slide-in-from-top-2 duration-300",children:[e.jsxs(ce,{children:[e.jsx(ke,{className:"h-4 w-4"}),e.jsxs(oe,{children:["Select from ",k.length," approved sites. Only sites with approved MMP status are available for urgent visits."]})]}),k.length>0?e.jsx(Ee,{className:"h-80 border rounded-lg bg-white dark:bg-gray-900",children:e.jsx("div",{className:"p-4 space-y-3",children:e.jsx(le,{value:t.watch("selectedMmpSite"),onValueChange:s=>t.setValue("selectedMmpSite",s),className:"space-y-3",children:k.map(s=>e.jsxs("div",{className:"group",children:[e.jsx($,{value:s.id,id:s.id,className:"peer sr-only"}),e.jsxs(Y,{htmlFor:s.id,className:"flex items-center space-x-4 p-4 border rounded-lg hover:bg-accent/50 peer-data-[state=checked]:bg-primary/5 peer-data-[state=checked]:border-primary cursor-pointer transition-all duration-200 group-hover:shadow-sm",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-foreground",children:s.name}),e.jsxs("div",{className:"text-sm text-muted-foreground mt-1",children:["Site Code: ",e.jsx("span",{className:"font-mono bg-muted px-2 py-0.5 rounded text-xs",children:s.code})]})]}),e.jsx(se,{className:"h-4 w-4 text-green-500 opacity-0 peer-data-[state=checked]:opacity-100 transition-opacity"})]})]},s.id))})})}):e.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[e.jsx(re,{className:"h-16 w-16 mx-auto mb-4 opacity-30"}),e.jsx("h3",{className:"font-medium text-lg mb-2",children:"No Approved Sites Available"}),e.jsx("p",{className:"text-sm mb-4",children:"There are currently no approved sites in your MMP files."}),e.jsx(u,{variant:"outline",onClick:()=>t.setValue("siteSource","new"),className:"mt-2",children:"Create New Urgent Site Instead"})]})]}),t.watch("siteSource")==="new"&&e.jsxs("div",{className:"space-y-8 animate-in slide-in-from-top-2 duration-300",children:[e.jsxs(ce,{className:"border-amber-200 bg-amber-50 dark:border-amber-800 dark:bg-amber-950/10",children:[e.jsx(H,{className:"h-4 w-4 text-amber-600"}),e.jsx(oe,{className:"text-amber-800 dark:text-amber-200",children:"Creating a new urgent site. Please ensure all required information is accurate as this will be submitted for immediate approval."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(a,{control:t.control,name:"siteName",render:({field:s})=>e.jsxs(l,{children:[e.jsxs(n,{className:"flex items-center text-sm font-medium",children:["Site Name ",e.jsx("span",{className:"text-destructive ml-1",children:"*"})]}),e.jsx(c,{children:e.jsx(j,{...s,placeholder:"Enter descriptive site name",className:"h-11"})}),e.jsx(He,{children:"Provide a clear, descriptive name for the site"}),e.jsx(o,{})]})}),e.jsx(a,{control:t.control,name:"priority",render:({field:s})=>e.jsxs(l,{children:[e.jsx(n,{children:"Priority Level"}),e.jsx(c,{children:e.jsxs(b,{value:s.value,onValueChange:s.onChange,children:[e.jsx(v,{className:"h-11",children:e.jsx(f,{placeholder:"Select priority"})}),e.jsxs(y,{children:[e.jsx(h,{value:"high",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full"}),e.jsx("span",{children:"High Priority"})]})}),e.jsx(h,{value:"medium",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-yellow-500 rounded-full"}),e.jsx("span",{children:"Medium Priority"})]})}),e.jsx(h,{value:"low",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.jsx("span",{children:"Low Priority"})]})})]})]})}),e.jsx(o,{})]})})]}),e.jsx(G,{className:"my-6"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("h4",{className:"font-semibold flex items-center text-lg",children:[e.jsx(te,{className:"h-5 w-5 mr-2 text-blue-600"}),"Location Details"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(a,{control:t.control,name:"hub",render:({field:s})=>e.jsxs(l,{children:[e.jsx(n,{children:"Hub *"}),e.jsx(c,{children:e.jsxs(b,{value:s.value,onValueChange:s.onChange,children:[e.jsx(v,{className:"w-full h-11",children:e.jsx(f,{placeholder:"Select Hub"})}),e.jsx(y,{children:de.map(r=>e.jsx(h,{value:r.id,children:r.name},r.id))})]})}),e.jsx(o,{})]})}),e.jsx(a,{control:t.control,name:"state",render:({field:s})=>e.jsxs(l,{children:[e.jsx(n,{children:"State *"}),e.jsx(c,{children:e.jsxs(b,{value:s.value,onValueChange:s.onChange,disabled:!N,children:[e.jsx(v,{className:"w-full h-11",children:e.jsx(f,{placeholder:N?"Select State":"Select Hub First"})}),e.jsx(y,{children:ue.map(r=>e.jsx(h,{value:r.id,children:r.name},r.id))})]})}),e.jsx(o,{})]})}),e.jsx(a,{control:t.control,name:"locality",render:({field:s})=>e.jsxs(l,{children:[e.jsx(n,{children:"Locality"}),e.jsx(c,{children:e.jsxs(b,{value:s.value,onValueChange:s.onChange,disabled:!S||E.length===0,children:[e.jsx(v,{className:"w-full h-11",children:e.jsx(f,{placeholder:S?"Select Locality":"Select State First"})}),e.jsx(y,{children:E.map(r=>e.jsx(h,{value:r.id,children:r.name},r.id))})]})}),e.jsx(o,{})]})}),e.jsx(a,{control:t.control,name:"location",render:({field:s})=>e.jsxs(l,{children:[e.jsx(n,{children:"Location"}),e.jsx(c,{children:e.jsx(j,{...s,placeholder:"City or region",className:"h-11"})}),e.jsx(o,{})]})})]})]}),e.jsx(G,{className:"my-6"}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("h4",{className:"font-semibold text-lg",children:"Project Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(a,{control:t.control,name:"projectName",render:({field:s})=>e.jsxs(l,{children:[e.jsx(n,{children:"Project Name *"}),e.jsx(c,{children:e.jsx(j,{...s,placeholder:"Enter project name",className:"h-11"})}),e.jsx(o,{})]})}),e.jsx(a,{control:t.control,name:"mainActivity",render:({field:s})=>e.jsxs(l,{children:[e.jsx(n,{children:"Main Activity *"}),e.jsx(c,{children:e.jsx(j,{...s,placeholder:"Enter main activity",className:"h-11"})}),e.jsx(o,{})]})}),e.jsx(a,{control:t.control,name:"complexity",render:({field:s})=>e.jsxs(l,{children:[e.jsx(n,{children:"Complexity Level"}),e.jsx(c,{children:e.jsxs(b,{value:s.value,onValueChange:s.onChange,children:[e.jsx(v,{className:"w-full h-11",children:e.jsx(f,{placeholder:"Select complexity"})}),e.jsxs(y,{children:[e.jsx(h,{value:"low",children:"Low"}),e.jsx(h,{value:"medium",children:"Medium"}),e.jsx(h,{value:"high",children:"High"})]})]})}),e.jsx(o,{})]})}),e.jsx(a,{control:t.control,name:"estimatedDuration",render:({field:s})=>e.jsxs(l,{children:[e.jsx(n,{children:"Estimated Duration"}),e.jsx(c,{children:e.jsx(j,{...s,placeholder:"e.g., 2 days",className:"h-11"})}),e.jsx(o,{})]})})]})]})]}),e.jsxs("div",{className:"flex justify-between pt-6 border-t",children:[e.jsxs(u,{variant:"outline",onClick:()=>i("/site-visits/create"),children:[e.jsx(F,{className:"h-4 w-4 mr-2"}),"Cancel"]}),e.jsxs(u,{onClick:()=>D(2),disabled:!fe(2),className:"min-w-[140px]",children:["Continue",e.jsx(F,{className:"h-4 w-4 ml-2 rotate-180"})]})]})]})]}),Se=()=>e.jsxs(V,{className:"shadow-lg border-0 bg-white",children:[e.jsxs(T,{className:"pb-6",children:[e.jsxs(P,{className:"flex items-center text-xl",children:[e.jsx(ie,{className:"h-6 w-6 mr-3 text-blue-600"}),"Visit Details & Team Assignment"]}),e.jsx(L,{className:"text-base",children:"Provide additional details and assign team members for this urgent visit"})]}),e.jsxs(M,{className:"space-y-8",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("h4",{className:"font-semibold flex items-center text-lg",children:[e.jsx(ie,{className:"h-5 w-5 mr-2 text-blue-600"}),"Team Assignment"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(a,{control:t.control,name:"coordinatorName",render:({field:s})=>e.jsxs(l,{children:[e.jsx(n,{children:"Coordinator"}),e.jsx(c,{children:e.jsxs(b,{value:s.value,onValueChange:s.onChange,children:[e.jsx(v,{className:"w-full",children:e.jsx(f,{placeholder:"Select Coordinator"})}),e.jsx(y,{children:je.map(r=>e.jsx(h,{value:r.id,children:r.name},r.id))})]})}),e.jsx(o,{})]})}),e.jsx(a,{control:t.control,name:"supervisorName",render:({field:s})=>e.jsxs(l,{children:[e.jsx(n,{children:"Supervisor"}),e.jsx(c,{children:e.jsxs(b,{value:s.value,onValueChange:s.onChange,children:[e.jsx(v,{className:"w-full",children:e.jsx(f,{placeholder:"Select Supervisor"})}),e.jsx(y,{children:pe.map(r=>e.jsx(h,{value:r.id,children:r.name},r.id))})]})}),e.jsx(o,{})]})})]})]}),e.jsx(G,{}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("h4",{className:"font-semibold text-lg",children:"Additional Information"}),e.jsx(a,{control:t.control,name:"description",render:({field:s})=>e.jsxs(l,{children:[e.jsx(n,{children:"Description"}),e.jsx(c,{children:e.jsx(q,{...s,placeholder:"Provide details about the urgent site visit",className:"resize-none"})}),e.jsx(o,{})]})}),e.jsx(a,{control:t.control,name:"risks",render:({field:s})=>e.jsxs(l,{children:[e.jsx(n,{children:"Risks"}),e.jsx(c,{children:e.jsx(q,{...s,placeholder:"List any potential risks",className:"resize-none"})}),e.jsx(o,{})]})}),e.jsx(a,{control:t.control,name:"resources",render:({field:s})=>e.jsxs(l,{children:[e.jsx(n,{children:"Required Resources"}),e.jsx(c,{children:e.jsx(q,{...s,placeholder:"List required resources",className:"resize-none"})}),e.jsx(o,{})]})})]}),e.jsxs("div",{className:"flex justify-between pt-6 border-t",children:[e.jsxs(u,{variant:"outline",onClick:()=>D(1),children:[e.jsx(F,{className:"h-4 w-4 mr-2"}),"Back"]}),e.jsxs(u,{onClick:()=>D(3),className:"min-w-[140px]",children:["Continue",e.jsx(F,{className:"h-4 w-4 ml-2 rotate-180"})]})]})]})]}),Ce=()=>e.jsxs(V,{className:"shadow-lg border-0 bg-white",children:[e.jsxs(T,{className:"pb-6",children:[e.jsxs(P,{className:"flex items-center text-xl",children:[e.jsx(Ae,{className:"h-6 w-6 mr-3 text-blue-600"}),"Fee Calculation & Submit"]}),e.jsx(L,{className:"text-base",children:"Set fees for this urgent site visit and submit for approval"})]}),e.jsxs(M,{className:"space-y-8",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx(a,{control:t.control,name:"feeCurrency",render:({field:s})=>e.jsxs(l,{children:[e.jsx(n,{children:"Currency"}),e.jsx(c,{children:e.jsx(j,{...s,placeholder:"e.g., SDG",className:"h-11"})}),e.jsx(o,{})]})}),e.jsx(a,{control:t.control,name:"distanceFee",render:({field:s})=>e.jsxs(l,{children:[e.jsx(n,{children:"Distance Fee"}),e.jsx(c,{children:e.jsx(j,{...s,type:"number",placeholder:"0",className:"h-11"})}),e.jsx(o,{})]})}),e.jsx(a,{control:t.control,name:"complexityFee",render:({field:s})=>e.jsxs(l,{children:[e.jsx(n,{children:"Complexity Fee"}),e.jsx(c,{children:e.jsx(j,{...s,type:"number",placeholder:"0",className:"h-11"})}),e.jsx(o,{})]})}),e.jsx(a,{control:t.control,name:"urgencyFee",render:({field:s})=>e.jsxs(l,{children:[e.jsx(n,{children:"Urgency Fee"}),e.jsx(c,{children:e.jsx(j,{...s,type:"number",placeholder:"0",className:"h-11"})}),e.jsx(o,{})]})})]}),e.jsx(V,{className:"bg-blue-50 border-blue-200",children:e.jsx(M,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg",children:"Total Cost"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"All fees included"})]}),e.jsx("div",{className:"text-right",children:e.jsx("div",{className:"text-2xl font-bold text-primary",children:(()=>{const s=x=>{const m=typeof x=="string"?parseFloat(x):Number(x||0);return isNaN(m)?0:m};return`${(s(ge)+s(Ne)+s(be)).toLocaleString()} ${ve||"SDG"}`})()})})]})})})]}),e.jsxs("div",{className:"flex justify-between pt-6 border-t",children:[e.jsxs(u,{variant:"outline",onClick:()=>D(2),children:[e.jsx(F,{className:"h-4 w-4 mr-2"}),"Back"]}),e.jsx(u,{type:"submit",variant:"default",onClick:t.handleSubmit(W),disabled:K,className:"min-w-[160px] bg-blue-600 hover:bg-blue-700 text-white",children:K?e.jsxs(e.Fragment,{children:[e.jsx(Ve,{className:"h-4 w-4 mr-2 animate-spin"}),"Creating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Me,{className:"h-4 w-4 mr-2"}),"Create Urgent Visit"]})})]})]})]});return e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"container mx-auto max-w-5xl py-8 px-4",children:[e.jsxs("div",{className:"flex items-center gap-6 mb-8",children:[e.jsxs(u,{variant:"ghost",size:"lg",onClick:()=>i("/site-visits/create"),className:"hover:bg-white dark:hover:bg-gray-800",children:[e.jsx(F,{className:"h-5 w-5 mr-2"}),"Back"]}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold flex items-center text-blue-600",children:[e.jsx(H,{className:"h-8 w-8 mr-3 text-amber-500"}),"Create Urgent Site Visit"]}),e.jsx("p",{className:"text-muted-foreground text-lg mt-2",children:"Create an urgent site visit by selecting an existing site or adding a new one"})]})]}),e.jsx(Be,{...t,children:e.jsxs("form",{onSubmit:t.handleSubmit(W),className:"space-y-8",children:[ye(),w===1&&we(),w===2&&Se(),w===3&&Ce()]})})]})})};export{js as default};
