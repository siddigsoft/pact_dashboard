import{r as g,j as e,v as V,bo as H,l as R,bp as O,E,a1 as G,I as w,p as $,ag as b,bq as q,F as C,b5 as z,t as J,a4 as K,q as W}from"./react-core-B8kFjp2k.js";import{C as y,f as S,b as k,r as P,I as Z,g as _,h as Q,a as N,B as t,F as U,e as X}from"./index-PwDgWEVM.js";import{G as h}from"./gradient-stat-card-CWH4umO5.js";import{S as T,a as A,b as L,c as F,d as a}from"./select-CXX5Q_V1.js";import{bo as I}from"./vendor-VlxgVHMv.js";import{J as Y,G as ee,o as se}from"./date-utils-YarVESQS.js";import"./docs-D2Yi4cpO.js";import"./react-dom-BLwj5vIO.js";import"./jspdf-rld7HkB6.js";import"./router-CKy9yO3R.js";import"./query-CJ0Bt4ph.js";import"./supabase-CwPDIVMD.js";import"./xlsx-CBxwqXDA.js";import"./forms-CESK2FDA.js";import"./radix-ui-C2DV4xtt.js";import"./radix-dialogs-CnlmQBMC.js";import"./radix-menus-CPezQVZk.js";const ae=({projects:m,onViewProject:c,loading:j=!1})=>{const p=I(),[r,f]=g.useState(""),[l,n]=g.useState("all"),[o,v]=g.useState("all"),u=s=>{if(!s)return"N/A";try{const d=Y(s);return ee(d)?se(d,"MMM d, yyyy"):"Invalid date"}catch{return"Invalid date"}},x=m.filter(s=>{const d=r===""||s.name.toLowerCase().includes(r.toLowerCase())||s.projectCode.toLowerCase().includes(r.toLowerCase())||s.description&&s.description.toLowerCase().includes(r.toLowerCase()),M=l==="all"||s.projectType===l,D=o==="all"||s.status===o;return d&&M&&D}),i=s=>{switch(s){case"draft":return e.jsxs(t,{variant:"outline",className:"flex items-center gap-1",children:[e.jsx(w,{className:"h-3 w-3"})," Draft"]});case"active":return e.jsxs(t,{variant:"default",className:"bg-green-600 flex items-center gap-1",children:[e.jsx(b,{className:"h-3 w-3"})," Active"]});case"onHold":return e.jsxs(t,{variant:"secondary",className:"flex items-center gap-1",children:[e.jsx(q,{className:"h-3 w-3"})," On Hold"]});case"completed":return e.jsxs(t,{variant:"default",className:"bg-blue-600 flex items-center gap-1",children:[e.jsx(b,{className:"h-3 w-3"})," Completed"]});case"cancelled":return e.jsxs(t,{variant:"destructive",className:"flex items-center gap-1",children:[e.jsx($,{className:"h-3 w-3"})," Cancelled"]});default:return e.jsx(t,{variant:"outline",children:s})}},B=s=>{switch(s){case"infrastructure":return e.jsx(t,{variant:"outline",className:"bg-blue-100 text-blue-800 border-blue-200",children:s});case"survey":return e.jsx(t,{variant:"outline",className:"bg-green-100 text-green-800 border-green-200",children:s});case"compliance":return e.jsx(t,{variant:"outline",className:"bg-amber-100 text-amber-800 border-amber-200",children:s});case"monitoring":return e.jsx(t,{variant:"outline",className:"bg-indigo-100 text-indigo-800 border-indigo-200",children:s});case"training":return e.jsx(t,{variant:"outline",className:"bg-purple-100 text-purple-800 border-purple-200",children:s});default:return e.jsx(t,{variant:"outline",className:"bg-gray-100 text-gray-800 border-gray-200",children:s})}};return j?e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("div",{className:"w-full md:w-64 h-10 bg-muted animate-pulse rounded-md"}),e.jsxs("div",{className:"hidden md:flex gap-2",children:[e.jsx("div",{className:"w-32 h-10 bg-muted animate-pulse rounded-md"}),e.jsx("div",{className:"w-32 h-10 bg-muted animate-pulse rounded-md"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[1,2,3,4,5,6].map(s=>e.jsxs(y,{className:"overflow-hidden",children:[e.jsxs(S,{className:"pb-2",children:[e.jsx("div",{className:"w-3/4 h-6 bg-muted animate-pulse rounded-md"}),e.jsx("div",{className:"w-1/2 h-4 bg-muted animate-pulse rounded-md mt-2"})]}),e.jsx(k,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"w-full h-4 bg-muted animate-pulse rounded-md"}),e.jsx("div",{className:"w-full h-4 bg-muted animate-pulse rounded-md"}),e.jsx("div",{className:"w-3/4 h-4 bg-muted animate-pulse rounded-md"})]})}),e.jsx(P,{children:e.jsx("div",{className:"w-full h-10 bg-muted animate-pulse rounded-md"})})]},s))})]}):e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-6 items-start md:items-center justify-between",children:[e.jsxs("div",{className:"relative w-full md:w-96",children:[e.jsx(V,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(Z,{placeholder:"Search projects...",value:r,onChange:s=>f(s.target.value),className:"pl-10 w-full"})]}),e.jsxs("div",{className:"flex flex-wrap gap-3 w-full md:w-auto",children:[e.jsxs(T,{value:l,onValueChange:n,children:[e.jsx(A,{className:"w-full md:w-[180px]",children:e.jsx(L,{placeholder:"Project Type"})}),e.jsxs(F,{children:[e.jsx(a,{value:"all",children:"All Types"}),e.jsx(a,{value:"infrastructure",children:"Infrastructure"}),e.jsx(a,{value:"survey",children:"Survey"}),e.jsx(a,{value:"compliance",children:"Compliance"}),e.jsx(a,{value:"monitoring",children:"Monitoring"}),e.jsx(a,{value:"training",children:"Training"}),e.jsx(a,{value:"other",children:"Other"})]})]}),e.jsxs(T,{value:o,onValueChange:v,children:[e.jsx(A,{className:"w-full md:w-[180px]",children:e.jsx(L,{placeholder:"Status"})}),e.jsxs(F,{children:[e.jsx(a,{value:"all",children:"All Statuses"}),e.jsx(a,{value:"draft",children:"Draft"}),e.jsx(a,{value:"active",children:"Active"}),e.jsx(a,{value:"onHold",children:"On Hold"}),e.jsx(a,{value:"completed",children:"Completed"}),e.jsx(a,{value:"cancelled",children:"Cancelled"})]})]})]})]}),x.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:x.map(s=>{var d;return e.jsxs(y,{className:"overflow-hidden hover:shadow-md transition-shadow duration-200 flex flex-col",children:[e.jsxs(S,{className:"pb-2 bg-muted/30 relative",children:[e.jsx(_,{className:"text-lg font-medium",children:s.name}),e.jsxs(Q,{className:"flex items-center gap-1 text-xs",children:[e.jsx(H,{className:"h-3 w-3"})," ",s.projectCode]}),e.jsx("div",{className:"absolute top-4 right-4",children:i(s.status)})]}),e.jsx(k,{className:"py-4 flex-grow",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsxs("div",{className:"flex flex-wrap items-center space-x-2 text-sm",children:[e.jsx(R,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("span",{className:"text-muted-foreground",children:[u(s.startDate)," - ",u(s.endDate)]})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[e.jsx(O,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("span",{className:"text-muted-foreground",children:["Type: ",B(s.projectType)]})]}),((d=s.location)==null?void 0:d.region)&&e.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[e.jsxs("svg",{className:"h-4 w-4 text-muted-foreground",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"}),e.jsx("circle",{cx:"12",cy:"10",r:"3"})]}),e.jsxs("span",{className:"text-muted-foreground",children:[s.location.region,s.location.state&&`, ${s.location.state}`]})]}),s.budget&&e.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[e.jsx(E,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("span",{className:"text-muted-foreground",children:["Budget: ",s.budget.total.toLocaleString()," ",s.budget.currency]})]})]}),s.description&&e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2",children:s.description})]})}),e.jsx(P,{className:"pt-2 pb-4 border-t border-border/50 bg-muted/10",children:e.jsxs(N,{className:"w-full flex items-center justify-center",variant:"default",onClick:()=>c(s.id),children:["View Details ",e.jsx(G,{className:"ml-2 h-4 w-4"})]})})]},s.id)})}):e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"mx-auto h-16 w-16 rounded-full bg-muted flex items-center justify-center mb-4",children:e.jsx(w,{className:"h-8 w-8 text-muted-foreground"})}),e.jsx("h3",{className:"text-lg font-medium",children:"No projects found"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:r||l!=="all"||o!=="all"?"Try adjusting your search filters":"Create a new project to get started"}),e.jsx(N,{className:"mt-4",onClick:()=>p("/projects/create"),children:"Create Project"})]})]})},Ne=()=>{const m=I(),{projects:c,loading:j}=U(),{roles:p}=X(),r=(p||[]).map(n=>String(n).toLowerCase());r.includes("admin")||r.includes("fieldopmanager");const f=n=>{m(`/projects/${n}`)},l=g.useMemo(()=>{const n=c.length,o=c.filter(i=>i.workflowStatus==="completed").length,v=c.filter(i=>i.workflowStatus==="active"||i.workflowStatus==="in_progress").length,u=c.filter(i=>i.workflowStatus==="pending").length,x=n>0?Math.round(o/n*100):0;return{total:n,completed:o,active:v,pending:u,completionRate:x}},[c]);return e.jsxs("div",{className:"min-h-screen bg-background p-4 md:p-8 space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg bg-gradient-to-br from-blue-500 to-blue-700 flex items-center justify-center",children:e.jsx(C,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Projects"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Manage project planning and activity management"})]})]}),e.jsxs(N,{onClick:()=>m("/projects/create"),"data-testid":"button-create-project",children:[e.jsx(z,{className:"h-4 w-4 mr-2"}),"Create Project"]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx(h,{title:"Total Projects",value:l.total,subtitle:"All projects",icon:C,color:"blue","data-testid":"card-stat-total-projects"}),e.jsx(h,{title:"Completed",value:l.completed,subtitle:`${l.completionRate}% completion`,icon:J,color:"green","data-testid":"card-stat-completed-projects"}),e.jsx(h,{title:"Active Projects",value:l.active,subtitle:"Currently in progress",icon:K,color:"cyan","data-testid":"card-stat-active-projects"}),e.jsx(h,{title:"Pending",value:l.pending,subtitle:"Awaiting start",icon:W,color:"orange","data-testid":"card-stat-pending-projects"})]}),e.jsx("div",{className:"bg-card rounded-lg border p-6",children:e.jsx(ae,{projects:c,onViewProject:f,loading:j})})]})};export{Ne as default};
