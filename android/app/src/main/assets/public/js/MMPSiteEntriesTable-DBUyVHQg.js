import{r as g,j as e,v as Ae,b as Fe,X as Me,aH as we,$ as Z,N as Te,C as Be}from"./react-core-B8kFjp2k.js";import{T as ke,a as Oe,b as H,c as d,d as Ve,e as l}from"./table-CZ8ZB6wW.js";import{C as Le,f as Pe,g as Ie,h as We,I as f,b as Ee,B as ee,a as D,D as He,l as $e,m as Ye,n as ze}from"./index-PwDgWEVM.js";import{C as te}from"./checkbox-9q2dlFjr.js";const Je=({siteEntries:C,onViewSiteDetail:$,editable:Y=!1,onUpdateSites:V})=>{const[L,ie]=g.useState(""),[w,ae]=g.useState(""),[b,P]=g.useState(1),[A]=g.useState(50),[se,z]=g.useState(!1),[k,ne]=g.useState(null),[oe,I]=g.useState(null),[n,h]=g.useState(null),[U,Q]=g.useState(null);g.useEffect(()=>{const i=setTimeout(()=>{ae(L),P(1)},300);return()=>clearTimeout(i)},[L]);const T=i=>{var K,X;const a=i!=null&&i.visit_data?typeof i.visit_data=="string"?(()=>{try{return JSON.parse(i.visit_data)}catch{return}})():i.visit_data:void 0,t=(i==null?void 0:i.additionalData)||{},s=i.hubOffice||i.hub_office||(a==null?void 0:a.hubOffice)||t["Hub Office"]||t["Hub Office:"]||"—",v=i.state||i.state_name||(a==null?void 0:a.state)||t.State||t["State:"]||"—",x=i.locality||i.locality_name||(a==null?void 0:a.locality)||t.Locality||t["Locality:"]||"—",j=i.siteName||i.site_name||(a==null?void 0:a.siteName)||t["Site Name"]||t["Site Name:"]||"—",m=i.cpName||i.cp_name||(a==null?void 0:a.cpName)||t["CP Name"]||t["CP name"]||t["CP Name:"]||"—",o=i.siteActivity||i.activity_at_site||i.activity||(a==null?void 0:a.siteActivity)||t["Activity at the site"]||t["Activity at Site"]||t["Activity at the site:"]||"—",c=i.monitoringBy||i.monitoring_by||(a==null?void 0:a.monitoringBy)||t["monitoring by"]||t["monitoring by:"]||t["Monitoring By"]||"—",r=i.surveyTool||i.survey_tool||(a==null?void 0:a.surveyTool)||t["Survey under Master tool"]||t["Survey under Master tool:"]||t["Survey Tool"]||"—",u=i.useMarketDiversion||i.use_market_diversion||(a==null?void 0:a.useMarketDiversion)||t["Use Market Diversion Monitoring"]==="Yes"||t["Use Market Diversion Monitoring"]==="true"||t["Use Market Diversion Monitoring"]==="1"||!1,y=i.useWarehouseMonitoring||i.use_warehouse_monitoring||(a==null?void 0:a.useWarehouseMonitoring)||t["Use Warehouse Monitoring"]==="Yes"||t["Use Warehouse Monitoring"]==="true"||t["Use Warehouse Monitoring"]==="1"||!1,p=i.main_activity||i.mainActivity||(a==null?void 0:a.mainActivity)||"—",B=i.visitType||(a==null?void 0:a.visitType)||"—",ue=i.mmpName||i.mmp_name||(a==null?void 0:a.mmpName)||t["MMP Name"]||t.mmp_name||(i.mmpFiles?i.mmpFiles.name:void 0)||"—",E=i.due_date||i.visitDate||"";let q="—";if(E){const G=new Date(E);q=isNaN(G.getTime())?String(E):G.toISOString().split("T")[0]}const he=i.comments||i.notes||"—",J=i.fees||(a==null?void 0:a.fees)||{},fe=i.enumerator_fee??t["Enumerator Fee"]??t.enumerator_fee??((K=i.additional_data)!=null&&K.enumerator_fee?Number(i.additional_data.enumerator_fee):void 0),ve=i.transport_fee??t["Transport Fee"]??t.transport_fee??((X=i.additional_data)!=null&&X.transport_fee?Number(i.additional_data.transport_fee):void 0);let N=fe,_=ve;const S=i.cost??i.price??(a==null?void 0:a.cost)??(a==null?void 0:a.price)??J.total??J.amount??t.Cost??t.Price??t.Amount;S&&(!N||!_)&&(Number(S)===30?(N=N??20,_=_??10):S&&!N&&!_&&(N=N??(S?Number(S)-10:void 0),_=_??10));const xe=N&&_?Number(N)+Number(_):S?Number(S):void 0,pe=i.verified_by||t["Verified By"]||t["Verified By:"]||void 0,ge=i.verified_at||(t["Verified At"]?new Date(t["Verified At"]).toISOString():void 0)||(t.verified_at?new Date(t.verified_at).toISOString():void 0)||void 0,ye=i.verification_notes||t["Verification Notes"]||t["Verification Notes:"]||void 0,Ne=i.status||t.Status||t["Status:"]||"Pending",_e=i.dispatched_at||(t.dispatched_at?new Date(t.dispatched_at).toISOString():void 0)||(t["Dispatched At"]?new Date(t["Dispatched At"]).toISOString():void 0)||void 0,je=i.dispatched_by||t.dispatched_by||t["Dispatched By"]||void 0,be=i.accepted_at||(t.accepted_at?new Date(t.accepted_at).toISOString():void 0)||(t["Accepted At"]?new Date(t["Accepted At"]).toISOString():void 0)||void 0,Se=i.accepted_by||t.accepted_by||t["Accepted By"]||void 0,De=i.created_at||void 0,Ce=i.updated_at||i.last_modified||void 0;return{hubOffice:s,state:v,locality:x,mmpName:ue,siteName:j,cpName:m,siteActivity:o,monitoringBy:c,surveyTool:r,useMarketDiversion:u,useWarehouseMonitoring:y,mainActivity:p,visitType:B,visitDate:q,comments:he,enumeratorFee:N,transportFee:_,cost:xe,verifiedBy:pe,verifiedAt:ge,verificationNotes:ye,status:Ne,dispatchedAt:_e,dispatchedBy:je,acceptedAt:be,acceptedBy:Se,createdAt:De,updatedAt:Ce}},R=i=>{if($){$(i);return}ne(i),z(!0)},F=g.useMemo(()=>{if(w.trim()==="")return C;const i=w.toLowerCase();return C.filter(a=>{const t=T(a);return[t.hubOffice,t.state,t.locality,t.mmpName,t.siteName,t.cpName,t.siteActivity,t.monitoringBy,t.surveyTool,t.visitDate,t.comments].filter(Boolean).some(s=>String(s).toLowerCase().includes(i))})},[C,w]),W=g.useMemo(()=>{const i=(b-1)*A,a=i+A;return F.slice(i,a)},[F,b,A]),O=Math.ceil(F.length/A),M=i=>{if(typeof i=="boolean")return i;const a=String(i||"").toLowerCase();return a==="yes"||a==="true"||a==="1"},re=i=>{const a=T(i);I(i.id??i._key??i.siteCode??Math.random()),h({...a})},ce=()=>{I(null),h(null)},le=i=>{const a={...i},t=a.additional_data||a.additionalData||{},s={"Site Code":"site_code",site_code:"site_code",siteCode:"site_code","Hub Office":"hub_office","Hub Office:":"hub_office",hub_office:"hub_office",hubOffice:"hub_office",State:"state","State:":"state",state:"state",state_name:"state",Locality:"locality","Locality:":"locality",locality:"locality",locality_name:"locality","Site Name":"site_name","Site Name:":"site_name",site_name:"site_name",siteName:"site_name","CP Name":"cp_name","CP name":"cp_name","CP Name:":"cp_name",cp_name:"cp_name",cpName:"cp_name","Visit Type":"visit_type",visit_type:"visit_type",visitType:"visit_type","Visit Date":"visit_date",visit_date:"visit_date",visitDate:"visit_date","Main Activity":"main_activity",main_activity:"main_activity",mainActivity:"main_activity","Activity at Site":"activity_at_site","Activity at the site":"activity_at_site","Activity at the site:":"activity_at_site",activity_at_site:"activity_at_site",siteActivity:"activity_at_site","Monitoring By":"monitoring_by","monitoring by":"monitoring_by","monitoring by:":"monitoring_by",monitoring_by:"monitoring_by",monitoringBy:"monitoring_by","Survey Tool":"survey_tool","Survey under Master tool":"survey_tool","Survey under Master tool:":"survey_tool",survey_tool:"survey_tool",surveyTool:"survey_tool","Use Market Diversion Monitoring":"use_market_diversion",use_market_diversion:"use_market_diversion",useMarketDiversion:"use_market_diversion","Use Warehouse Monitoring":"use_warehouse_monitoring",use_warehouse_monitoring:"use_warehouse_monitoring",useWarehouseMonitoring:"use_warehouse_monitoring",Comments:"comments",comments:"comments",Cost:"cost",Price:"cost",Amount:"cost",cost:"cost",price:"cost","Enumerator Fee":"enumerator_fee",enumerator_fee:"enumerator_fee","Transport Fee":"transport_fee",transport_fee:"transport_fee","Verification Notes":"verification_notes","Verification Notes:":"verification_notes",verification_notes:"verification_notes","Verified By":"verified_by","Verified By:":"verified_by",verified_by:"verified_by","Verified At":"verified_at",verified_at:"verified_at","Dispatched By":"dispatched_by",dispatched_by:"dispatched_by","Dispatched At":"dispatched_at",dispatched_at:"dispatched_at","Accepted By":"accepted_by",accepted_by:"accepted_by","Accepted At":"accepted_at",accepted_at:"accepted_at",Status:"status","Status:":"status",status:"status"},v=m=>{if(typeof m=="boolean")return m;if(m==null||m==="")return null;const o=String(m).toLowerCase().trim();return o==="yes"||o==="true"||o==="1"||o==="y"},x=m=>{if(m==null||m==="")return null;if(typeof m=="number")return m;const o=String(m).replace(/[^0-9.\-]/g,"");if(!o)return null;const c=parseFloat(o);return isNaN(c)?null:c},j=m=>{if(!m)return null;try{const o=new Date(m);return isNaN(o.getTime())?null:o.toISOString()}catch{return null}};for(const[m,o]of Object.entries(s)){const c=a[o],r=t[m];if((c==null||c==="")&&r!==null&&r!==void 0&&r!=="")if(o==="use_market_diversion"||o==="use_warehouse_monitoring"){const u=v(r);u!==null&&(a[o]=u)}else if(o==="cost"||o==="enumerator_fee"||o==="transport_fee"){const u=x(r);u!==null&&(a[o]=u)}else if(o==="verified_at"||o==="dispatched_at"){const u=j(r);u!==null&&(a[o]=u)}else a[o]=String(r).trim()}return a},de=(i,a)=>{var c,r,u,y;const s={...le(i)};s.hubOffice=a.hubOffice,s.state=a.state,s.locality=a.locality,s.siteName=a.siteName,s.cpName=a.cpName,s.siteActivity=a.siteActivity,s.monitoringBy=a.monitoringBy,s.surveyTool=a.surveyTool,s.useMarketDiversion=M(a.useMarketDiversion),s.useWarehouseMonitoring=M(a.useWarehouseMonitoring),s.visitDate=a.visitDate,s.comments=a.comments;let v,x;const j=i.enumerator_fee??((c=i.additional_data)!=null&&c.enumerator_fee?Number(i.additional_data.enumerator_fee):void 0)??((r=i.additionalData)!=null&&r["Enumerator Fee"]?Number(i.additionalData["Enumerator Fee"]):void 0),m=i.transport_fee??((u=i.additional_data)!=null&&u.transport_fee?Number(i.additional_data.transport_fee):void 0)??((y=i.additionalData)!=null&&y["Transport Fee"]?Number(i.additionalData["Transport Fee"]):void 0);if(typeof a.enumeratorFee<"u"){const p=a.enumeratorFee==="—"||a.enumeratorFee===""?void 0:Number(a.enumeratorFee);v=isNaN(p)?void 0:p,s.enumerator_fee=v,s.additional_data||(s.additional_data={}),s.additional_data.enumerator_fee=s.enumerator_fee}else v=j,v!==void 0&&(s.enumerator_fee=v,s.additional_data||(s.additional_data={}),s.additional_data.enumerator_fee=v);if(typeof a.transportFee<"u"){const p=a.transportFee==="—"||a.transportFee===""?void 0:Number(a.transportFee);x=isNaN(p)?void 0:p,s.transport_fee=x,s.additional_data||(s.additional_data={}),s.additional_data.transport_fee=s.transport_fee}else x=m,x!==void 0&&(s.transport_fee=x,s.additional_data||(s.additional_data={}),s.additional_data.transport_fee=x);if(v!==void 0&&x!==void 0)s.cost=Number(v)+Number(x);else if(typeof a.cost<"u"){const p=a.cost==="—"||a.cost===""?void 0:Number(a.cost);s.cost=isNaN(p)?a.cost:p}else s.cost===void 0&&i.cost&&(s.cost=Number(i.cost));typeof a.status<"u"&&(s.status=a.status),typeof a.verifiedBy<"u"&&(s.verified_by=a.verifiedBy),typeof a.verifiedAt<"u"&&(s.verified_at=a.verifiedAt),typeof a.verificationNotes<"u"&&(s.verification_notes=a.verificationNotes);const o={...i.additionalData||{}};return o["Hub Office"]=a.hubOffice,o.State=a.state,o.Locality=a.locality,o["Site Name"]=a.siteName,o["CP Name"]=a.cpName,o["Activity at Site"]=a.siteActivity,o["Monitoring By"]=a.monitoringBy,o["Survey Tool"]=a.surveyTool,o["Use Market Diversion Monitoring"]=M(a.useMarketDiversion)?"Yes":"No",o["Use Warehouse Monitoring"]=M(a.useWarehouseMonitoring)?"Yes":"No",o["Visit Date"]=a.visitDate,o.Comments=a.comments,typeof a.enumeratorFee<"u"?(o["Enumerator Fee"]=a.enumeratorFee,o.enumerator_fee=a.enumeratorFee):s.enumerator_fee!==void 0&&(o["Enumerator Fee"]=s.enumerator_fee,o.enumerator_fee=s.enumerator_fee),typeof a.transportFee<"u"?(o["Transport Fee"]=a.transportFee,o.transport_fee=a.transportFee):s.transport_fee!==void 0&&(o["Transport Fee"]=s.transport_fee,o.transport_fee=s.transport_fee),s.cost!==void 0&&(o.Cost=s.cost),typeof a.verifiedBy<"u"&&(o["Verified By"]=a.verifiedBy),typeof a.verifiedAt<"u"&&(o["Verified At"]=a.verifiedAt),typeof a.verificationNotes<"u"&&(o["Verification Notes"]=a.verificationNotes),s.additionalData=o,s},me=async i=>{if(!n)return;const a=(C||[]).map(t=>t===i?de(t,n):t);try{Q(i.id??i._key??"saving");const t=V==null?void 0:V(a);(typeof t=="object"&&typeof t.then=="function"?await t:!0)&&(I(null),h(null))}finally{Q(null)}};return e.jsxs(Le,{children:[e.jsx(Pe,{className:"pb-3",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx(Ie,{children:"MMP Site Entries"}),e.jsxs(We,{children:["Showing ",W.length," of ",F.length," sites",w&&` (filtered from ${C.length} total)`,!w&&` (${C.length} total)`]})]}),e.jsx("div",{className:"w-full sm:w-auto",children:e.jsxs("div",{className:"relative",children:[e.jsx(Ae,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(f,{type:"search",placeholder:"Search sites...",className:"pl-8 w-full sm:w-[300px]",value:L,onChange:i=>ie(i.target.value)})]})})]})}),e.jsxs(Ee,{children:[e.jsx("div",{className:"rounded-md border w-full overflow-x-auto",children:e.jsx("div",{className:"min-w-[2400px]",children:e.jsxs(ke,{children:[e.jsx(Oe,{children:e.jsxs(H,{className:"bg-muted/50",children:[e.jsx(d,{children:"Hub Office"}),e.jsx(d,{children:"State"}),e.jsx(d,{children:"Locality"}),e.jsx(d,{children:"MMP Name"}),e.jsx(d,{children:"Site Name"}),e.jsx(d,{children:"CP Name"}),e.jsx(d,{children:"Status"}),e.jsx(d,{children:"Activity at Site"}),e.jsx(d,{children:"Monitoring By"}),e.jsx(d,{children:"Survey Tool"}),e.jsx(d,{children:"Market Diversion"}),e.jsx(d,{children:"Warehouse Monitoring"}),e.jsx(d,{children:"Visit Date"}),e.jsx(d,{children:"Enumerator Fee"}),e.jsx(d,{children:"Transport Fee"}),e.jsx(d,{children:"Total Cost"}),e.jsx(d,{children:"Comments"}),e.jsx(d,{children:"Status"}),e.jsx(d,{children:"Verified By"}),e.jsx(d,{children:"Verified At"}),e.jsx(d,{children:"Verification Notes"}),e.jsx(d,{children:"Dispatched At"}),e.jsx(d,{children:"Dispatched By"}),e.jsx(d,{children:"Accepted At"}),e.jsx(d,{children:"Accepted By"}),e.jsx(d,{children:"Created At"}),e.jsx(d,{children:"Actions"})]})}),e.jsx(Ve,{children:W.length>0?W.map((i,a)=>{var v,x,j,m,o;const t=T(i),s=Y&&oe===(i.id??i._key??i.siteCode);return e.jsxs(H,{className:"hover:bg-muted/30",children:[e.jsx(l,{className:"font-mono text-xs",children:s?e.jsx(f,{value:(n==null?void 0:n.hubOffice)??t.hubOffice??"",onChange:c=>h(r=>({...r||{},hubOffice:c.target.value})),className:"h-8"}):t.hubOffice}),e.jsx(l,{children:s?e.jsx(f,{value:(n==null?void 0:n.state)??t.state??"",onChange:c=>h(r=>({...r||{},state:c.target.value})),className:"h-8"}):t.state}),e.jsx(l,{children:s?e.jsx(f,{value:(n==null?void 0:n.locality)??t.locality??"",onChange:c=>h(r=>({...r||{},locality:c.target.value})),className:"h-8"}):t.locality}),e.jsx(l,{children:t.mmpName}),e.jsx(l,{children:s?e.jsx(f,{value:(n==null?void 0:n.siteName)??t.siteName??"",onChange:c=>h(r=>({...r||{},siteName:c.target.value})),className:"h-8"}):t.siteName}),e.jsx(l,{children:s?e.jsx(f,{value:(n==null?void 0:n.cpName)??t.cpName??"",onChange:c=>h(r=>({...r||{},cpName:c.target.value})),className:"h-8"}):t.cpName}),e.jsx(l,{children:s?e.jsx(f,{value:(n==null?void 0:n.status)??t.status??"Pending",onChange:c=>h(r=>({...r||{},status:c.target.value})),className:"h-8"}):e.jsx(ee,{className:((v=t.status)==null?void 0:v.toLowerCase())==="verified"?"bg-green-100 text-green-700":((x=t.status)==null?void 0:x.toLowerCase())==="rejected"?"bg-red-100 text-red-700":((j=t.status)==null?void 0:j.toLowerCase())==="pending"?"bg-yellow-100 text-yellow-700":((m=t.status)==null?void 0:m.toLowerCase())==="approved"?"bg-blue-100 text-blue-700":((o=t.status)==null?void 0:o.toLowerCase())==="accepted"?"bg-purple-100 text-purple-700":"bg-gray-100 text-gray-700",children:t.status})}),e.jsx(l,{children:s?e.jsx(f,{value:(n==null?void 0:n.siteActivity)??t.siteActivity??"",onChange:c=>h(r=>({...r||{},siteActivity:c.target.value})),className:"h-8"}):t.siteActivity}),e.jsx(l,{children:s?e.jsx(f,{value:(n==null?void 0:n.monitoringBy)??t.monitoringBy??"",onChange:c=>h(r=>({...r||{},monitoringBy:c.target.value})),className:"h-8"}):t.monitoringBy}),e.jsx(l,{children:s?e.jsx(f,{value:(n==null?void 0:n.surveyTool)??t.surveyTool??"",onChange:c=>h(r=>({...r||{},surveyTool:c.target.value})),className:"h-8"}):t.surveyTool}),e.jsx(l,{children:s?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(te,{checked:M((n==null?void 0:n.useMarketDiversion)??t.useMarketDiversion),onCheckedChange:c=>h(r=>({...r||{},useMarketDiversion:!!c}))}),e.jsx("span",{className:"text-xs",children:"Yes"})]}):t.useMarketDiversion?"Yes":"No"}),e.jsx(l,{children:s?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(te,{checked:M((n==null?void 0:n.useWarehouseMonitoring)??t.useWarehouseMonitoring),onCheckedChange:c=>h(r=>({...r||{},useWarehouseMonitoring:!!c}))}),e.jsx("span",{className:"text-xs",children:"Yes"})]}):t.useWarehouseMonitoring?"Yes":"No"}),e.jsx(l,{children:s?e.jsx(f,{value:(n==null?void 0:n.visitDate)??t.visitDate??"",onChange:c=>h(r=>({...r||{},visitDate:c.target.value})),className:"h-8"}):t.visitDate}),e.jsx(l,{children:s?e.jsx(f,{type:"number",step:"0.01",value:(n==null?void 0:n.enumeratorFee)??(Number.isFinite(Number(t.enumeratorFee))?Number(t.enumeratorFee):""),onChange:c=>{const r=c.target.value;h(u=>{const y={...u||{},enumeratorFee:r},p=Number(r)||0,B=Number((u==null?void 0:u.transportFee)??t.transportFee??0);return y.cost=p+B,y})},className:"h-8",placeholder:"20"}):t.enumeratorFee!==void 0&&t.enumeratorFee!==null&&String(t.enumeratorFee)!==""?`$${Number(t.enumeratorFee).toLocaleString()}`:"—"}),e.jsx(l,{children:s?e.jsx(f,{type:"number",step:"0.01",min:"10",max:"25",value:(n==null?void 0:n.transportFee)??(Number.isFinite(Number(t.transportFee))?Number(t.transportFee):""),onChange:c=>{const r=c.target.value;h(u=>{const y={...u||{},transportFee:r},p=Number((u==null?void 0:u.enumeratorFee)??t.enumeratorFee??0),B=Number(r)||0;return y.cost=p+B,y})},className:"h-8",placeholder:"10"}):t.transportFee!==void 0&&t.transportFee!==null&&String(t.transportFee)!==""?`$${Number(t.transportFee).toLocaleString()}`:"—"}),e.jsx(l,{children:s?e.jsxs("div",{className:"font-semibold text-blue-600",children:["$",(Number((n==null?void 0:n.enumeratorFee)??t.enumeratorFee??0)+Number((n==null?void 0:n.transportFee)??t.transportFee??0)).toLocaleString()]}):t.cost!==void 0&&t.cost!==null&&String(t.cost)!==""&&String(t.cost)!=="—"?`$${Number(t.cost).toLocaleString()}`:"—"}),e.jsx(l,{children:s?e.jsx(f,{value:(n==null?void 0:n.comments)??t.comments??"",onChange:c=>h(r=>({...r||{},comments:c.target.value})),className:"h-8"}):t.comments}),e.jsx(l,{children:s?e.jsx(f,{value:(n==null?void 0:n.status)??t.status??"",onChange:c=>h(r=>({...r||{},status:c.target.value})),className:"h-8"}):e.jsx(ee,{variant:t.status==="Verified"?"default":t.status==="Dispatched"?"secondary":"outline",children:t.status})}),e.jsx(l,{children:s?e.jsx(f,{value:(n==null?void 0:n.verifiedBy)??t.verifiedBy??"",onChange:c=>h(r=>({...r||{},verifiedBy:c.target.value})),placeholder:"Coordinator name",className:"h-8"}):t.verifiedBy?e.jsx("div",{className:"font-medium",children:t.verifiedBy}):e.jsx("span",{className:"text-muted-foreground",children:"—"})}),e.jsx(l,{children:s?e.jsx(f,{type:"date",value:n!=null&&n.verifiedAt?new Date(n.verifiedAt).toISOString().split("T")[0]:t.verifiedAt?new Date(t.verifiedAt).toISOString().split("T")[0]:"",onChange:c=>{const r=c.target.value?new Date(c.target.value).toISOString():"";h(u=>({...u||{},verifiedAt:r}))},className:"h-8"}):t.verifiedAt?e.jsxs("div",{className:"text-sm",children:[new Date(t.verifiedAt).toLocaleDateString(),e.jsx("div",{className:"text-xs text-muted-foreground",children:new Date(t.verifiedAt).toLocaleTimeString()})]}):e.jsx("span",{className:"text-muted-foreground",children:"—"})}),e.jsx(l,{children:s?e.jsx(f,{value:(n==null?void 0:n.verificationNotes)??t.verificationNotes??"",onChange:c=>h(r=>({...r||{},verificationNotes:c.target.value})),placeholder:"Verification notes",className:"h-8"}):t.verificationNotes?e.jsx("div",{className:"text-sm max-w-xs",title:t.verificationNotes,children:t.verificationNotes.length>50?`${t.verificationNotes.substring(0,50)}...`:t.verificationNotes}):e.jsx("span",{className:"text-muted-foreground",children:"—"})}),e.jsx(l,{children:t.dispatchedAt?e.jsxs("div",{className:"text-sm",children:[new Date(t.dispatchedAt).toLocaleDateString(),e.jsx("div",{className:"text-xs text-muted-foreground",children:new Date(t.dispatchedAt).toLocaleTimeString()})]}):e.jsx("span",{className:"text-muted-foreground",children:"—"})}),e.jsx(l,{children:t.dispatchedBy?e.jsx("div",{className:"font-medium text-sm",children:t.dispatchedBy}):e.jsx("span",{className:"text-muted-foreground",children:"—"})}),e.jsx(l,{children:t.acceptedAt?e.jsxs("div",{className:"text-sm",children:[new Date(t.acceptedAt).toLocaleDateString(),e.jsx("div",{className:"text-xs text-muted-foreground",children:new Date(t.acceptedAt).toLocaleTimeString()})]}):e.jsx("span",{className:"text-muted-foreground",children:"—"})}),e.jsx(l,{children:t.acceptedBy?e.jsx("div",{className:"font-medium text-sm",children:t.acceptedBy}):e.jsx("span",{className:"text-muted-foreground",children:"—"})}),e.jsx(l,{children:t.createdAt?e.jsxs("div",{className:"text-sm",children:[new Date(t.createdAt).toLocaleDateString(),e.jsx("div",{className:"text-xs text-muted-foreground",children:new Date(t.createdAt).toLocaleTimeString()})]}):e.jsx("span",{className:"text-muted-foreground",children:"—"})}),e.jsx(l,{children:Y?s?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(D,{size:"sm",onClick:()=>me(i),disabled:U===(i.id??i._key??"saving"),className:"inline-flex items-center gap-1",children:[e.jsx(Fe,{className:"h-4 w-4"})," ",U===(i.id??i._key??"saving")?"Saving...":"Save"]}),e.jsxs(D,{size:"sm",variant:"outline",onClick:ce,className:"inline-flex items-center gap-1",children:[e.jsx(Me,{className:"h-4 w-4"})," Cancel"]})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(D,{variant:"outline",size:"sm",onClick:()=>re(i),className:"inline-flex items-center gap-1",children:[e.jsx(we,{className:"h-4 w-4"}),"Edit"]}),e.jsxs(D,{variant:"ghost",size:"sm",onClick:()=>R(i),className:"hover:bg-muted inline-flex items-center gap-1",children:[e.jsx(Z,{className:"h-4 w-4"}),"View"]})]}):e.jsxs(D,{variant:"ghost",size:"sm",onClick:()=>R(i),className:"hover:bg-muted inline-flex items-center gap-1",children:[e.jsx(Z,{className:"h-4 w-4"}),"View"]})})]},i.id??i.siteCode??i._key??a)}):e.jsx(H,{children:e.jsx(l,{colSpan:20,className:"h-24 text-center",children:"No results."})})})]})})}),O>1&&e.jsxs("div",{className:"flex items-center justify-between mt-4 px-2",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Page ",b," of ",O]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(D,{variant:"outline",size:"sm",onClick:()=>P(i=>Math.max(1,i-1)),disabled:b===1,children:[e.jsx(Te,{className:"h-4 w-4"}),"Previous"]}),e.jsxs("div",{className:"text-sm",children:[(b-1)*A+1," - ",Math.min(b*A,F.length)," of ",F.length]}),e.jsxs(D,{variant:"outline",size:"sm",onClick:()=>P(i=>Math.min(O,i+1)),disabled:b===O,children:["Next",e.jsx(Be,{className:"h-4 w-4"})]})]})]})]}),e.jsx(He,{open:se,onOpenChange:z,children:e.jsxs($e,{className:"max-w-2xl",children:[e.jsx(Ye,{children:e.jsx(ze,{children:k&&T(k).siteName||"Site Details"})}),k&&(()=>{const i=T(k);return e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Hub Office"}),e.jsx("p",{className:"font-medium",children:i.hubOffice})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"State"}),e.jsx("p",{className:"font-medium",children:i.state})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Locality"}),e.jsx("p",{className:"font-medium",children:i.locality})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Site Name"}),e.jsx("p",{className:"font-medium",children:i.siteName})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"CP Name"}),e.jsx("p",{className:"font-medium",children:i.cpName})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Activity at Site"}),e.jsx("p",{className:"font-medium",children:i.siteActivity})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Monitoring By"}),e.jsx("p",{className:"font-medium",children:i.monitoringBy})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Survey Tool"}),e.jsx("p",{className:"font-medium",children:i.surveyTool})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Market Diversion"}),e.jsx("p",{className:"font-medium",children:i.useMarketDiversion?"Yes":"No"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Warehouse Monitoring"}),e.jsx("p",{className:"font-medium",children:i.useWarehouseMonitoring?"Yes":"No"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Visit Date"}),e.jsx("p",{className:"font-medium",children:i.visitDate||"—"})]}),e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Comments"}),e.jsx("p",{className:"font-medium",children:i.comments||"—"})]})]})})()]})})]})};export{Je as M};
