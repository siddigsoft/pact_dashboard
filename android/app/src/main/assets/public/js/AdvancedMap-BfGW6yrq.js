const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/ReactLeafletMap-DfyM_KIk.js","js/react-core-B8kFjp2k.js","js/vendor-VlxgVHMv.js","js/docs-D2Yi4cpO.js","js/react-dom-BLwj5vIO.js","js/date-utils-YarVESQS.js","js/index-PwDgWEVM.js","js/jspdf-rld7HkB6.js","js/router-CKy9yO3R.js","js/query-CJ0Bt4ph.js","js/supabase-CwPDIVMD.js","js/xlsx-CBxwqXDA.js","js/forms-CESK2FDA.js","js/radix-ui-C2DV4xtt.js","js/radix-dialogs-CnlmQBMC.js","js/radix-menus-CPezQVZk.js","assets/index-D008cfpT.css","js/maps-BzFQ_kYT.js","assets/maps-Dgihpmma.css"])))=>i.map(i=>d[i]);
import{_ as B}from"./jspdf-rld7HkB6.js";import{r as n,j as e,ah as O,bp as P,ap as R,bH as I,ai as $,R as H,Y as U}from"./react-core-B8kFjp2k.js";import{E as Y,J,a as m,V as f,W as g,X as N,L as M,M as k,N as L,ae as S,Q as T,O as r,Y as w,ac as Q,B as E,C as V,b as D,a4 as W}from"./index-PwDgWEVM.js";import{bo as X}from"./vendor-VlxgVHMv.js";import"./docs-D2Yi4cpO.js";import"./react-dom-BLwj5vIO.js";import"./router-CKy9yO3R.js";import"./query-CJ0Bt4ph.js";import"./supabase-CwPDIVMD.js";import"./xlsx-CBxwqXDA.js";import"./date-utils-YarVESQS.js";import"./forms-CESK2FDA.js";import"./radix-ui-C2DV4xtt.js";import"./radix-dialogs-CnlmQBMC.js";import"./radix-menus-CPezQVZk.js";const q=H.lazy(()=>B(()=>import("./ReactLeafletMap-DfyM_KIk.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18]))),F=({height:t="500px"})=>e.jsx(V,{className:"w-full",children:e.jsx(D,{className:"p-6",children:e.jsxs("div",{style:{height:t},className:"flex flex-col items-center justify-center bg-red-50 rounded-lg",children:[e.jsx(U,{className:"h-12 w-12 text-red-500 mb-4"}),e.jsx("h3",{className:"text-lg font-medium",children:"Map failed to load"}),e.jsx("p",{className:"text-muted-foreground text-center mt-2",children:"There was an error loading the map. Please try refreshing the page."})]})})}),G=({height:t="500px"})=>e.jsx(V,{className:"w-full",children:e.jsx(D,{className:"p-6",children:e.jsx(W,{className:"w-full",style:{height:t}})})}),me=()=>{const t=X(),{users:u}=Y(),{siteVisits:j}=J(),[_,C]=n.useState(!1),[o,z]=n.useState(!1),[c,p]=n.useState("standard"),[i,d]=n.useState("all");n.useEffect(()=>{C(!1)},[]);const b=n.useMemo(()=>{try{const l=u.filter(s=>{var v,y;const a=((v=s.location)==null?void 0:v.latitude)&&((y=s.location)==null?void 0:y.longitude),x=i==="all"||s.availability===i;return a&&x}).map(s=>({id:s.id,name:s.name,latitude:s.location.latitude,longitude:s.location.longitude,type:"user",status:s.availability})),h=j.filter(s=>{var a,x;return((a=s.coordinates)==null?void 0:a.latitude)&&((x=s.coordinates)==null?void 0:x.longitude)}).map(s=>({id:s.id,name:s.siteName,latitude:s.coordinates.latitude,longitude:s.coordinates.longitude,type:"site",status:s.status}));return[...l,...h]}catch{return C(!0),[]}},[u,j,i]),A=l=>{try{const h=u.find(a=>a.id===l),s=j.find(a=>a.id===l);h?t(`/users/${l}`):s&&t(`/site-visits/${l}`)}catch{}};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(m,{variant:"outline",className:"gap-2",onClick:()=>t("/field-team"),children:[e.jsx(O,{className:"h-4 w-4"}),"Back to Team View"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(f,{children:e.jsxs(g,{children:[e.jsx(N,{asChild:!0,children:e.jsxs(M,{children:[e.jsx(k,{asChild:!0,children:e.jsx(m,{variant:"outline",size:"icon",children:e.jsx(P,{className:"h-4 w-4"})})}),e.jsxs(L,{children:[e.jsx(S,{children:"Map View"}),e.jsx(T,{}),e.jsx(r,{onClick:()=>p("standard"),className:c==="standard"?"bg-accent":"",children:"Standard"}),e.jsx(r,{onClick:()=>p("satellite"),className:c==="satellite"?"bg-accent":"",children:"Satellite"}),e.jsx(r,{onClick:()=>p("terrain"),className:c==="terrain"?"bg-accent":"",children:"Terrain"})]})]})}),e.jsx(w,{children:"Change Map View"})]})}),e.jsx(f,{children:e.jsxs(g,{children:[e.jsx(N,{asChild:!0,children:e.jsxs(M,{children:[e.jsx(k,{asChild:!0,children:e.jsx(m,{variant:"outline",size:"icon",children:e.jsx(R,{className:"h-4 w-4"})})}),e.jsxs(L,{children:[e.jsx(S,{children:"Filter Locations"}),e.jsx(T,{}),e.jsx(r,{onClick:()=>d("all"),className:i==="all"?"bg-accent":"",children:"All Staff"}),e.jsx(r,{onClick:()=>d("online"),className:i==="online"?"bg-accent":"",children:"Online"}),e.jsx(r,{onClick:()=>d("busy"),className:i==="busy"?"bg-accent":"",children:"Busy"}),e.jsx(r,{onClick:()=>d("offline"),className:i==="offline"?"bg-accent":"",children:"Offline"})]})]})}),e.jsx(w,{children:"Filter Locations"})]})}),e.jsx(f,{children:e.jsxs(g,{children:[e.jsx(N,{asChild:!0,children:e.jsx(m,{variant:"outline",size:"icon",onClick:()=>z(!o),children:o?e.jsx(I,{className:"h-4 w-4"}):e.jsx($,{className:"h-4 w-4"})})}),e.jsx(w,{children:o?"Exit Fullscreen":"Enter Fullscreen"})]})})]})]}),e.jsx("div",{className:`h-[calc(100vh-200px)] transition-all duration-300 ${o?"fixed inset-0 z-50 bg-white p-4":""}`,children:_?e.jsx(F,{height:"100%"}):e.jsx(n.Suspense,{fallback:e.jsx(G,{height:"100%"}),children:e.jsx(Q,{fallback:e.jsx(F,{height:"100%"}),children:e.jsx(q,{locations:b,height:"100%",onLocationClick:A,mapType:c})})})}),e.jsx("div",{className:"mt-4 flex justify-between items-center",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(E,{variant:"outline",children:["Total Locations: ",b.length]}),e.jsxs(E,{variant:"secondary",children:["View: ",c.charAt(0).toUpperCase()+c.slice(1)]})]})})]})};export{me as default};
