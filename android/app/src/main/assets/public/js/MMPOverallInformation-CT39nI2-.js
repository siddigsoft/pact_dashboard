import{r as l,j as e,aM as k,aL as N,a3 as f,ag as T,aI as O}from"./react-core-B8kFjp2k.js";import{u as G,e as H,a2 as Y,B as x,I as c,a as i,D as q,$ as z,l as J,m as K,n as Q,o as W,p as X}from"./index-PwDgWEVM.js";import{L as Z}from"./router-CKy9yO3R.js";import{T as _}from"./textarea-BpQMf5eL.js";const ae=({mmpFile:s,onUpdate:m,editable:p=!1})=>{var C,M,b,I,D,P,S,V;const{toast:o}=G(),{updateMMPVersion:B}=H(),[r,h]=l.useState(!1),[a,d]=l.useState(s),[w,E]=l.useState(!1),[$,u]=l.useState(!1),[j,y]=l.useState(""),n=s.mmpId?Y(s.mmpId):null,g=s.version?`${s.version.major}.${s.version.minor}`:n?`${n.version.major}.${n.version.minor}`:"1.0",L=()=>{m==null||m(a),h(!1),o({description:"MMP details updated successfully"})},R=()=>{E(!0),o({description:"MMP has been marked as reviewed"})},A=async()=>{if(!j.trim()){o({title:"Error",description:"Please provide a description of the changes",variant:"destructive"});return}await B(s.id,j)&&(u(!1),y(""),o({description:"MMP version updated successfully"}))};return p?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"space-y-1",children:[r?e.jsx(c,{value:a.name,onChange:t=>d({...a,name:t.target.value}),className:"font-medium text-lg"}):e.jsx("h3",{className:"font-medium text-lg",children:s.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(k,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("span",{className:"text-muted-foreground",children:["MMP ID: ",s.mmpId||"Not assigned yet"]}),s.mmpId&&e.jsxs(x,{variant:"outline",className:"ml-2 flex items-center",children:[e.jsx(N,{className:"h-3 w-3 mr-1"}),"v",g]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[!w&&e.jsxs(i,{variant:"outline",className:"flex items-center gap-2",onClick:R,children:[e.jsx(T,{className:"h-4 w-4"}),"Mark as Reviewed"]}),e.jsxs(q,{open:$,onOpenChange:u,children:[e.jsx(z,{asChild:!0,children:e.jsxs(i,{variant:"outline",className:"flex items-center gap-2",children:[e.jsx(N,{className:"h-4 w-4"}),"Create New Version"]})}),e.jsxs(J,{children:[e.jsxs(K,{children:[e.jsx(Q,{children:"Create New Version"}),e.jsx(W,{children:"This will create a new minor version of the MMP document. Please describe the changes."})]}),e.jsxs("div",{className:"py-4",children:[e.jsxs("p",{className:"text-sm mb-2",children:["Current Version: v",g]}),e.jsxs("p",{className:"text-sm mb-4",children:["New Version: v",s.version?`${s.version.major}.${s.version.minor+1}`:"1.1"]}),e.jsx(_,{placeholder:"Describe the changes in this version...",value:j,onChange:t=>y(t.target.value),className:"min-h-[120px]"})]}),e.jsxs(X,{children:[e.jsx(i,{variant:"outline",onClick:()=>u(!1),children:"Cancel"}),e.jsx(i,{onClick:A,children:"Save New Version"})]})]})]}),p&&!r&&e.jsx(i,{onClick:()=>h(!0),children:"Edit Details"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground",children:"Project Name"}),r?e.jsx(c,{value:a.name,onChange:t=>d({...a,name:t.target.value})}):e.jsx("p",{children:s.name})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground",children:"Type"}),e.jsx("p",{children:"Field Monitoring"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground",children:"Status"}),e.jsx(x,{children:s.status})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground",children:"Location"}),e.jsx("div",{className:"space-y-2",children:r?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(f,{className:"h-4 w-4 text-muted-foreground"}),e.jsx(c,{value:((I=a.location)==null?void 0:I.address)||a.region||"",onChange:t=>{const v=a.location?{...a.location,address:t.target.value}:{address:t.target.value};d({...a,location:v,region:t.target.value})},placeholder:"Enter address or region"})]}),e.jsx(c,{value:((D=a.location)==null?void 0:D.state)||"",onChange:t=>{const v=a.location?{...a.location,state:t.target.value}:{state:t.target.value};d({...a,location:v})},placeholder:"Enter state",className:"ml-6"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(f,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("p",{children:((P=s.location)==null?void 0:P.address)||((S=s.location)==null?void 0:S.region)||s.region||"Not specified"})]}),((V=s.location)==null?void 0:V.state)&&e.jsx("p",{className:"text-sm text-muted-foreground ml-6",children:s.location.state})]})})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground",children:"Team Assignment"}),e.jsx("div",{className:"space-y-1",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"Coordinator:"}),r?e.jsx(c,{value:a.uploadedBy,onChange:t=>d({...a,uploadedBy:t.target.value}),className:"w-48"}):e.jsx("span",{className:"font-medium",children:s.uploadedBy})]})})]})]})]}),r&&e.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[e.jsx(i,{variant:"outline",onClick:()=>h(!1),children:"Cancel"}),e.jsxs(i,{onClick:L,children:[e.jsx(O,{className:"h-4 w-4 mr-2"}),"Save Changes"]})]}),w&&e.jsxs("div",{className:"flex items-center gap-2 text-green-600 bg-green-50 p-3 rounded-md mt-4",children:[e.jsx(T,{className:"h-5 w-5"}),e.jsx("span",{children:"This MMP has been reviewed"})]}),s.mmpId&&n&&e.jsxs("div",{className:"bg-blue-50 p-4 rounded-md border border-blue-100 mt-4",children:[e.jsx("h4",{className:"font-medium text-blue-800 mb-2",children:"MMP ID Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-blue-700",children:"Month:"}),e.jsx("span",{className:"font-medium",children:n.month})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-blue-700",children:"Year:"}),e.jsx("span",{className:"font-medium",children:n.year})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-blue-700",children:"Version:"}),e.jsxs("span",{className:"font-medium",children:[n.version.major,".",n.version.minor]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-blue-700",children:"Region Code:"}),e.jsx("span",{className:"font-medium",children:n.region})]})]})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(Z,{to:`/mmp/${s.id}`,className:"hover:text-primary transition-colors",children:e.jsx("h3",{className:"font-medium text-lg",children:s.name})}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(k,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("span",{className:"text-muted-foreground",children:["MMP ID: ",s.mmpId||"Not assigned yet"]}),s.mmpId&&e.jsxs(x,{variant:"outline",className:"ml-2 flex items-center",children:[e.jsx(N,{className:"h-3 w-3 mr-1"}),"v",g]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground",children:"Project Name"}),e.jsx("p",{children:s.name})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground",children:"Type"}),e.jsx("p",{children:"Field Monitoring"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground",children:"Status"}),e.jsx(x,{children:s.status})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground",children:"Location"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(f,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("p",{children:((C=s.location)==null?void 0:C.address)||((M=s.location)==null?void 0:M.region)||s.region||"Not specified"})]}),((b=s.location)==null?void 0:b.state)&&e.jsx("p",{className:"text-sm text-muted-foreground ml-6 mt-1",children:s.location.state})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-muted-foreground",children:"Team Assignment"}),e.jsx("div",{className:"space-y-1",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"Coordinator:"}),e.jsx("span",{className:"font-medium",children:s.uploadedBy})]})})]})]})]})]})};export{ae as M};
