import{r as i,j as e,Y as h,N as B,l as p,bp as D,U as I}from"./react-core-B8kFjp2k.js";import{F as T,a as c,C as v,f,g as N,b as g,B as n}from"./index-PwDgWEVM.js";import{A as y,a as b,b as P}from"./alert-BXWNuJnD.js";import{bI as _,bo as L}from"./vendor-VlxgVHMv.js";import{J as E,o as F,G as $}from"./date-utils-YarVESQS.js";import"./docs-D2Yi4cpO.js";import"./react-dom-BLwj5vIO.js";import"./jspdf-rld7HkB6.js";import"./router-CKy9yO3R.js";import"./query-CJ0Bt4ph.js";import"./supabase-CwPDIVMD.js";import"./xlsx-CBxwqXDA.js";import"./forms-CESK2FDA.js";import"./radix-ui-C2DV4xtt.js";import"./radix-dialogs-CnlmQBMC.js";import"./radix-menus-CPezQVZk.js";const Z=()=>{const{id:d,activityId:o}=_(),r=L(),{projects:m,loading:x,fetchProjects:C,getProjectById:w}=T(),[A,k]=i.useState(!1);i.useEffect(()=>{(async()=>{m.length===0&&!x&&await C(),k(!0)})()},[]);const a=i.useMemo(()=>d?w(d):void 0,[d,m]),t=i.useMemo(()=>a==null?void 0:a.activities.find(s=>s.id===o),[a,o]),l=s=>{if(!s)return"—";try{const u=E(s);return $(u)?F(u,"PPP"):"Invalid date"}catch{return"Invalid date"}},j=s=>{switch(s){case"completed":return e.jsx(n,{variant:"default",className:"bg-blue-600",children:"Completed"});case"inProgress":return e.jsx(n,{variant:"secondary",children:"In Progress"});case"cancelled":return e.jsx(n,{variant:"destructive",children:"Cancelled"});case"pending":default:return e.jsx(n,{variant:"outline",children:"Pending"})}};return(x||!A)&&!a?e.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsxs("div",{className:"relative w-16 h-16 mx-auto",children:[e.jsx("div",{className:"absolute inset-0 rounded-full border-4 border-primary/20 animate-[spin_3s_linear_infinite]"}),e.jsx("div",{className:"absolute inset-[6px] rounded-full border-4 border-t-primary animate-[spin_2s_linear_infinite]"})]}),e.jsx("p",{className:"text-muted-foreground animate-pulse",children:"Loading activity…"})]})}):a?t?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(c,{variant:"ghost",size:"icon",onClick:()=>r(`/projects/${a.id}`),className:"hover:bg-muted",children:e.jsx(B,{className:"h-4 w-4"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:t.name}),e.jsxs("p",{className:"text-muted-foreground text-sm",children:["Project: ",a.name]})]})]}),e.jsxs(v,{children:[e.jsx(f,{className:"pb-2",children:e.jsx(N,{className:"text-lg",children:"Overview"})}),e.jsxs(g,{className:"space-y-4",children:[t.description&&e.jsx("p",{className:"text-muted-foreground",children:t.description}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(p,{className:"h-4 w-4 mr-1 text-muted-foreground"}),e.jsxs("span",{className:"text-muted-foreground",children:[l(t.startDate)," – ",l(t.endDate)]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(D,{className:"h-4 w-4 mr-1 text-muted-foreground"}),j(t.status)]}),t.assignedTo&&e.jsxs("div",{className:"flex items-center",children:[e.jsx(I,{className:"h-4 w-4 mr-1 text-muted-foreground"}),e.jsx("span",{className:"text-muted-foreground",children:t.assignedTo})]})]})]})]}),e.jsxs(v,{children:[e.jsx(f,{className:"pb-2",children:e.jsx(N,{className:"text-lg",children:"Sub-activities"})}),e.jsx(g,{children:t.subActivities&&t.subActivities.length>0?e.jsx("div",{className:"grid gap-2",children:t.subActivities.map(s=>e.jsxs("div",{className:"flex items-center justify-between py-2 px-3 rounded-md bg-muted/50",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{children:s.name}),j(s.status)]}),s.dueDate&&e.jsxs("div",{className:"flex items-center text-sm text-muted-foreground",children:[e.jsx(p,{className:"h-4 w-4 mr-1"}),l(s.dueDate)]})]},s.id))}):e.jsx("p",{className:"text-sm text-muted-foreground italic",children:"No sub-activities"})})]})]}):e.jsx("div",{className:"max-w-2xl mx-auto my-12",children:e.jsxs(y,{variant:"destructive",children:[e.jsx(h,{className:"h-4 w-4"}),e.jsx(b,{children:"Activity Not Found"}),e.jsxs(P,{children:["We couldn't find the requested activity in this project.",e.jsxs("div",{className:"mt-4 flex gap-2",children:[e.jsx(c,{variant:"outline",onClick:()=>r(`/projects/${a.id}`),children:"Back to Project"}),e.jsx(c,{onClick:()=>r(`/projects/${a.id}/activities/create`),children:"Create Activity"})]})]})]})}):e.jsx("div",{className:"max-w-2xl mx-auto my-12",children:e.jsxs(y,{children:[e.jsx(h,{className:"h-4 w-4"}),e.jsx(b,{children:"Project Not Found"}),e.jsxs(P,{children:["The project you are looking for does not exist or has been removed.",e.jsx("div",{className:"mt-4",children:e.jsx(c,{variant:"outline",onClick:()=>r("/projects"),children:"Back to Projects"})})]})]})})};export{Z as default};
